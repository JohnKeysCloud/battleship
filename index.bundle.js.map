{"version":3,"file":"index.bundle.js","mappings":"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","sources":["webpack://battleship/webpack/bootstrap","webpack://battleship/webpack/runtime/define property getters","webpack://battleship/webpack/runtime/hasOwnProperty shorthand","webpack://battleship/./src/typescript/utilities/cycloneLightbox.ts/cyclone-lightbox.ts","webpack://battleship/./src/typescript/utilities/random-utilities.ts","webpack://battleship/./src/typescript/utilities/create-github-link.ts","webpack://battleship/./src/typescript/markup/main/main-container-one/main-one-parabellum.ts","webpack://battleship/./src/typescript/markup/main/main-container-one/main-one-bellum.ts","webpack://battleship/./src/typescript/markup/main/main-container-one/main-one-post-bellum.ts","webpack://battleship/./src/typescript/utilities/cycloneHotSwapContainer.ts","webpack://battleship/./src/typescript/utilities/cycloneTextComponent/cyclone-text-component.ts","webpack://battleship/./src/typescript/types/logic-types.ts","webpack://battleship/./src/typescript/types/type-guards.ts","webpack://battleship/./src/typescript/types/state-types.ts","webpack://battleship/./src/typescript/markup/components/gameboard-component/player-gameboard-component/player-gameboard-component.ts","webpack://battleship/./src/typescript/markup/components/gameboard-component/opponent-gameboard-component/opponent-gameboard-component.ts","webpack://battleship/./src/typescript/markup/main/main-container-two/main-container-two.ts","webpack://battleship/./src/typescript/setup/randomize-bs-gameboard.ts","webpack://battleship/./src/typescript/markup/components/buttons/ship-shuffler-component/ship-shuffler-component.ts","webpack://battleship/./src/typescript/markup/components/buttons/ready-up-component/ready-up-component.ts","webpack://battleship/./src/typescript/markup/components/score-board-component/score-board-component.ts","webpack://battleship/./src/typescript/markup/main/main-container-three/main-three-parabellum.ts","webpack://battleship/./src/typescript/markup/main/main-container-three/main-three-bellum.ts","webpack://battleship/./src/typescript/markup/main/main-container-three/main-three-post-bellum.ts","webpack://battleship/./src/typescript/logic/bs-ship-builder/bs-ship-builder.ts","webpack://battleship/./src/typescript/logic/bs-fleet-builder/bs-fleet-builder.ts","webpack://battleship/./src/typescript/markup/components/buttons/instructions-component/instructions-component.ts","webpack://battleship/./src/typescript/markup/main/main-component.ts","webpack://battleship/./src/typescript/markup/main/main-container-one/main-container-one.ts","webpack://battleship/./src/typescript/markup/main/main-container-three/main-container-three.ts","webpack://battleship/./src/typescript/markup/components/instructions-dialog-component/instructions-dialog-component.ts","webpack://battleship/./src/typescript/utilities/cycloneSitRepScroller.ts/cyclone-sit-rep-scroller.ts","webpack://battleship/./src/typescript/meta/dom-controller.ts","webpack://battleship/./src/typescript/markup/header/header.ts","webpack://battleship/./src/typescript/markup/header/nav/nav.ts","webpack://battleship/./src/typescript/state/game-state.ts","webpack://battleship/./src/typescript/utilities/event-bus.ts","webpack://battleship/./src/typescript/services/billow.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-builder/bs-gameboard-builder.ts","webpack://battleship/./src/typescript/utilities/logic-utilities.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-controller/bs-gameboard-controller.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-controller/abstracted-method-callbacks/get-valid-ship-positions/get-valid-ship-positions.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-controller/abstracted-method-callbacks/place-ship/place-ship.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-repository/bs-gameboard-repository.ts","webpack://battleship/./src/typescript/state/player-state.ts","webpack://battleship/./src/app.ts","webpack://battleship/./src/typescript/meta/init/randomize-gameboard.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","interface DialogState {\n  isDialogOpen: boolean;\n  isEscapeKeyListenerAttached: boolean;\n  isCloseButtonListenerAttached: boolean;\n};\n\n/**\n * Lightbox by Cyclone Studios \n * \n * A class that manages a modal dialog, allowing it to be opened, closed, and interacted with.\n * It handles keyboard interactions (Escape key), and close button events. \n * \n * @example\n * const dialogElement = document.querySelector('dialog');\n * const lightbox = new LightBox(dialogElement);\n * lightbox.openLightbox();\n * \n * @class\n */\nexport class CycloneLightboxController {\n  /**\n   * The current state of the dialog (open/close and event listener attachment status).\n   * @private\n   * @type {DialogState}\n   */\n  private readonly dialogState: DialogState = {\n    isDialogOpen: false,\n    isEscapeKeyListenerAttached: false,\n    isCloseButtonListenerAttached: false,\n  };\n\n  /**\n   * The ID of the dialog element.\n   * @private\n   * @type {string}\n   */\n  private readonly dialogId: string;\n\n  /**\n   * The close button element inside the dialog.\n   * @private\n   * @type {HTMLButtonElement}\n   */\n  private readonly dialogCloseButton: HTMLButtonElement;\n\n  /**\n   * The listener function for closing the dialog when the close button is clicked.\n   * @private\n   * @type {() => void}\n   */\n  private closeButtonListener: () => void;\n\n  /**\n   * The listener function for handling the Escape key to close the dialog.\n   * @private\n   * @type {(event: KeyboardEvent) => void}\n   */\n  private escapeKeyListener: (event: KeyboardEvent) => void;\n\n  /**\n   * Creates an instance of the LightBox class.\n   * @param {HTMLDialogElement} dialogElement - The dialog element to manage.\n   * @param {string} [dialogCloseButtonID='ds-close-button'] - The ID of the close button inside the dialog.\n   * @param {boolean} [dialogInDocumentBody=true] - Whether to observe the dialog's removal from the document body.\n   * @throws {Error} Throws an error if the dialog element doesn't have an ID.\n   */\n  constructor(\n    private readonly dialogElement: HTMLDialogElement,\n    private readonly dialogCloseButtonID: string = 'ds-close-button',\n    private readonly dialogInDocumentBody: boolean = true\n  ) {\n    if (!this.dialogElement.id)\n      throw new Error('Dialog element must have an id.');\n\n    this.dialogId = this.dialogElement.id;\n    this.dialogCloseButton = this.dsGetCloseButton(\n      this.dialogCloseButtonID,\n      this.dialogId\n    );\n    this.dsAddCloseButtonAria(this.dialogCloseButton);\n\n    this.closeButtonListener = this.closeLightbox.bind(this);\n    this.escapeKeyListener = this.dsHandleEscapeKey.bind(this);\n\n    this.observeDialogRemoval();\n  }\n\n  /**\n   * Opens the dialog.\n   * Adds event listeners for closing the dialog.\n   */\n  public openLightbox() {\n    if (this.dialogState.isDialogOpen) return;\n\n    this.dialogElement.showModal();\n    this.dsAddListeners();\n    this.dialogState.isDialogOpen = true;\n  }\n\n  /**\n   * Closes the dialog with an animation and removes event listeners.\n   */\n  public closeLightbox() {\n    requestAnimationFrame(() => {\n      this.dialogElement.classList.add('closing');\n    });\n\n    this.dialogElement.addEventListener(\n      'animationend',\n      () => {\n        this.dialogElement.classList.remove('closing');\n        this.dialogElement.close();\n        this.dsRemoveListeners();\n        this.dialogState.isDialogOpen = false;\n      },\n      { once: true }\n    );\n  }\n\n  /**\n   * Returns whether the dialog is currently open.\n   * @returns {boolean} True if the dialog is open, false otherwise.\n   */\n  public isOpen(): boolean {\n    return this.dialogState.isDialogOpen;\n  }\n\n  /**\n   * Adds event listeners for the dialog's close button and Escape key.\n   * @private\n   */\n  private dsAddListeners() {\n    if (!this.dialogState.isCloseButtonListenerAttached) {\n      this.dialogCloseButton.addEventListener(\n        'click',\n        this.closeButtonListener\n      );\n      this.dialogState.isCloseButtonListenerAttached = true;\n    }\n\n    if (!this.dialogState.isEscapeKeyListenerAttached) {\n      window.addEventListener('keydown', this.escapeKeyListener);\n      this.dialogState.isEscapeKeyListenerAttached = true;\n    }\n  }\n\n  /**\n   * Removes event listeners for the dialog's close button and Escape key.\n   * @private\n   */\n  private dsRemoveListeners() {\n    this.dialogCloseButton.removeEventListener(\n      'click',\n      this.closeButtonListener\n    );\n    this.dialogState.isCloseButtonListenerAttached = false;\n\n    window.removeEventListener('keydown', this.escapeKeyListener);\n    this.dialogState.isEscapeKeyListenerAttached = false;\n  }\n\n  /**\n   * Retrieves the close button element inside the dialog.\n   * @private\n   * @param {string} closeButtonId - The ID of the close button.\n   * @param {string} dialogId - The ID of the dialog.\n   * @returns {HTMLButtonElement} The close button element.\n   * @throws {Error} Throws an error if the close button is not found.\n   */\n  private dsGetCloseButton(\n    closeButtonId: string,\n    dialogId: string\n  ): HTMLButtonElement {\n    const closeButton = this.dialogElement.querySelector<HTMLButtonElement>(\n      `#${closeButtonId}`\n    );\n\n    if (!closeButton) {\n      throw new Error(\n        `Close button with ID \"${closeButtonId}\" not found in dialog \"${dialogId}\".`\n      );\n    }\n\n    return closeButton;\n  }\n\n  /**\n   * Adds aria attribute to the close button.\n   * @private\n   * @param {HTMLButtonElement} closeButton - The close button element to update.\n   */\n  private dsAddCloseButtonAria(closeButton: HTMLButtonElement): void {\n    closeButton.setAttribute('aria-label', 'Close Dialog');\n  }\n\n  /**\n   * Handles the Escape key press to close the dialog.\n   * @private\n   * @param {KeyboardEvent} event - The keyboard event triggered by pressing a key.\n   */\n  private dsHandleEscapeKey(event: KeyboardEvent) {\n    if (event.key === 'Escape' && this.dialogState.isDialogOpen) {\n      event.preventDefault();\n      this.closeLightbox();\n    }\n  }\n\n  /**\n   * Observes the removal of the dialog element from the DOM and removes listeners accordingly.\n   * @private\n   */\n  private observeDialogRemoval() {\n    const observer: MutationObserver = new MutationObserver((mutations) => {\n      for (const mutation of mutations) {\n        Array.from(mutation.removedNodes).forEach((node) => {\n          if (node === this.dialogElement) {\n            this.dsRemoveListeners();\n            observer.disconnect(); // Stop observing once removed\n            return;\n          }\n        });\n      }\n    });\n\n    this.dialogInDocumentBody\n      ? observer.observe(document.body, { childList: true })\n      : observer.observe(document.body, { childList: true, subtree: true });\n  }\n}\n\n//  --------------------------------------------------------------\n\n// <---  Fun facts:\n// Lightboxes are named after the lightbox that photographers use to view slides.\n\n// The HTML <dialog> element didn't become a web standard until 2022, when Chrome, \n// Firefox and Safari added support for the element.\n\n// Ok maybe not that fun.\n\n// ---> Kizu Kuraudo\n\n//  --------------------------------------------------------------","export const areArraysEqual = <T>(arrayOne: T[], arrayTwo: T[]) =>\n  arrayOne.length === arrayTwo.length\n  &&\n  arrayOne.every((value, index) => value === arrayTwo[index]);\n\nexport const capitalize = (str: string) => str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();\n\nexport const getConvertedTypeFromAttr = <T extends string>(\n  element: HTMLElement,\n  attribute: string,\n  typeGuard: (value: string) => value is T\n): T => {\n  const attrValue = element.getAttribute(attribute);\n  if (!attrValue || !typeGuard(attrValue)) {\n    throw new Error(`Invalid or missing attribute: ${attribute}`);\n  }\n  return attrValue;\n};\n\nexport const getRandomInt = (min: number, max: number): number =>\n  Math.floor(Math.random() * (max - min + 1)) + min;\n\nexport const isEmptyObject = (obj: Record<PropertyKey, unknown>): boolean => {\n  return (\n    Object.keys(obj).length === 0 &&\n    Object.getOwnPropertySymbols(obj).length === 0\n  );\n};\n\nexport const createElement = <K extends keyof HTMLElementTagNameMap>(\n  tag: K,\n  classes: string[] = [],\n  attributes: Record<string, string> = {}\n): HTMLElementTagNameMap[K] => {\n  const element: HTMLElementTagNameMap[K] = document.createElement(tag);\n  classes.forEach((cls) => element.classList.add(cls));\n  Object.entries(attributes).forEach(([key, value]) =>\n    element.setAttribute(key, value)\n  );\n  return element;\n};\n\nexport const generateListFragment = (\n  listItemTextContentArray: { textContent: string }[],\n  identifier: string,\n  attributes: Record<string, string> = {}\n): DocumentFragment => {\n  if (!listItemTextContentArray.length)\n    throw new Error('The listItemTextContentArray is empty.');\n\n  if (!identifier) throw new Error('You must identify your list items.');\n\n  const listFragment = new DocumentFragment();\n\n  listItemTextContentArray.forEach((listItem, index) => {\n    const listElement: HTMLLIElement = createElement(\n      'li',\n      [`${identifier}-list-item`],\n      {\n        id: `${identifier}-list-item-${++index}`,\n        ...attributes,\n      }\n    );\n    listElement.textContent = listItem.textContent;\n\n    listFragment.appendChild(listElement);\n  });\n  \n  return listFragment;\n};\n\n/**\n * Pauses execution for the specified milliseconds.\n * @param ms - Time to sleep in milliseconds.\n */\nexport const sleep = (ms: number): Promise<void> => new Promise((resolve) => setTimeout(resolve, ms));\n\nexport const waitForAnimationEnd = (element: HTMLElement): Promise<void> => {\n  return new Promise((resolve) => {\n    const handler = () => {\n      element.removeEventListener('animationend', handler);\n      resolve();\n    };\n    element.addEventListener('animationend', handler);\n  });\n}\nexport const waitForTransitionEnd = (\n  element: HTMLElement,\n  timeout = 1000, // ? make timeout value slightly longer than the longest transition duration\n  expectedCount?: number, // ? optional number of transitionend events to wait for (e.g., for nested transitions)\n  callback?: () => void // ? optional callback, same as `if (callback) callback();`\n): Promise<void> => {\n  return new Promise((resolve) => {\n    let resolved = false;\n    let transitionCount = 0;\n\n    const cleanup = () => {\n      if (!resolved) {\n        resolved = true;\n        element.removeEventListener('transitionend', handler);\n        clearTimeout(timer); // clear fallback timeout once resolved\n        resolve();\n        callback?.();\n      }\n    };\n\n    const handler = (event: TransitionEvent) => {\n      // ? If expecting multiple transitions, count until expectedCount is met\n      if (expectedCount !== undefined && expectedCount > 0) {\n        transitionCount++;\n        if (transitionCount >= expectedCount) {\n          cleanup();\n        }\n        return;\n      }\n\n      // ? Only resolve if transition event is on the element itself\n      if (event.target === element) {\n        cleanup();\n      }\n    };\n\n    element.addEventListener('transitionend', handler);\n\n    // Fallback timeout if `transitionend` event doesn't fire\n    const timer = setTimeout(() => {\n      cleanup();\n    }, timeout);\n  });\n};\nexport const waitForEvent = <K extends keyof HTMLElementEventMap>(\n  element: HTMLElement,\n  eventType: K,\n  callback?: () => void\n): Promise<HTMLElementEventMap[K]> => {\n  return new Promise((resolve) => {\n    const handler = (event: HTMLElementEventMap[K]) => {\n      element.removeEventListener(eventType, handler as EventListener);\n      resolve(event);\n      if (callback) callback();\n    };\n    element.addEventListener(eventType, handler as EventListener);\n  });\n};\n\nexport type Range<\n  N extends number,\n  Acc extends number[] = []\n> = Acc['length'] extends N ? Acc[number] : Range<N, [...Acc, Acc['length']]>;","// * UTILITIY\nfunction setAttributes(\n  element: Element,\n  attributes: { [key: string]: string }\n) {\n  for (const key in attributes) {\n    element.setAttribute(key, attributes[key]);\n  }\n}\n\n// > ------------------------------------------------------------------------\n\nexport function createGitHubLink(\n  size: string = '50px',\n  color: string = '#FFF',\n  gitHubUsername: string = 'johnKeysCloud',\n  projectName?: string\n): HTMLAnchorElement {\n  const pathOne: SVGPathElement = document.createElementNS(\n    'http://www.w3.org/2000/svg',\n    'path'\n  );\n  pathOne.setAttribute(\n    'd',\n    'M8.20003216,0 C3.67186256,0 0,3.67233045 0,8.2025137 C0,11.8266603 2.34955472,14.9012922 5.60770169,15.9859115 C6.01749428,16.0618219 6.16798309,15.8079721 6.16798309,15.5913056 C6.16798309,15.3957396 6.16033003,14.7495356 6.15685721,14.064154 C3.87553694,14.5603383 3.3941657,13.0963596 3.3941657,13.0963596 C3.02115925,12.1482506 2.48370842,11.896202 2.48370842,11.896202 C1.7397535,11.3870871 2.53978801,11.3975087 2.53978801,11.3975087 C3.36323189,11.4554066 3.79681972,12.242817 3.79681972,12.242817 C4.52816959,13.4968196 5.71510182,13.1342505 6.18303197,12.9247247 C6.25660428,12.3945093 6.46915364,12.0327122 6.70363321,11.8278826 C4.88233278,11.6204154 2.96765212,10.9170854 2.96765212,7.77413412 C2.96765212,6.87864774 3.28798748,6.14688355 3.81257603,5.57247278 C3.72742766,5.36584187 3.44677247,4.53159853 3.89200067,3.40175461 C3.89200067,3.40175461 4.58058343,3.18129256 6.14759636,4.24255971 C6.80164386,4.06076054 7.50315322,3.96966796 8.20003216,3.96658007 C8.89691109,3.96966796 9.59893494,4.06076054 10.2542687,4.24255971 C11.8194166,3.18129256 12.5070347,3.40175461 12.5070347,3.40175461 C12.9533562,4.53159853 12.6725723,5.36584187 12.587424,5.57247278 C13.1131701,6.14688355 13.4313189,6.87858341 13.4313189,7.77413412 C13.4313189,10.9245478 11.5130368,11.6182925 9.68710595,11.8213208 C9.98120223,12.0758783 10.2432714,12.5750862 10.2432714,13.3403025 C10.2432714,14.4377879 10.2337533,15.3211158 10.2337533,15.5913056 C10.2337533,15.8095804 10.3813481,16.0653602 10.7970574,15.9848178 C14.0534036,14.8989763 16.4,11.825438 16.4,8.2025137 C16.4,3.67233045 12.7286519,0 8.20003216,0'\n  );\n\n  const pathTwo: SVGPathElement = document.createElementNS(\n    'http://www.w3.org/2000/svg',\n    'path'\n  );\n  setAttributes(pathTwo, {\n    'd': 'M3.07518929,11.6824029 C3.05731167,11.723257 2.99359073,11.7355197 2.93568001,11.7075092 C2.87662002,11.6806603 2.84341872,11.6248974 2.86257332,11.5838496 C2.88013169,11.5417693 2.94385264,11.5300229 3.00278493,11.5582916 C3.06197262,11.5850759 3.09568471,11.6413552 3.07518929,11.6824029 M3.47564797,12.0435714 C3.436828,12.0799722 3.36091196,12.0630626 3.30938611,12.0055571 C3.25613634,11.9481806 3.24617596,11.8715065 3.28557057,11.8345248 C3.32560367,11.7981885 3.39922115,11.8151627 3.45259861,11.8726037 C3.50584838,11.9306256 3.51619186,12.0068479 3.47558413,12.0436359 M3.75038868,12.5056811 C3.70045904,12.5407266 3.61886048,12.5078755 3.5684839,12.4346866 C3.51861811,12.3615623 3.51861811,12.2737872 3.56956933,12.2386127 C3.62013745,12.2034381 3.70045904,12.235063 3.75153796,12.307671 C3.8013399,12.3820861 3.8013399,12.4698612 3.75032483,12.5057457 M4.2149514,13.0409152 C4.1703212,13.0906114 4.07531442,13.0773161 4.0057194,13.0094195 C3.93459201,12.9430719 3.91473508,12.8489074 3.95949298,12.7991467 C4.00463397,12.7493214 4.10021539,12.7633267 4.1703212,12.8306424 C4.24100164,12.8968609 4.26258248,12.9917354 4.21501525,13.0409152 M4.81538402,13.2216286 C4.79578249,13.2860399 4.70422354,13.3153413 4.6120261,13.2879762 C4.51995636,13.259772 4.45968324,13.1842596 4.4782632,13.1191383 C4.49741779,13.0542751 4.58935983,13.0237475 4.68225961,13.0530489 C4.77420165,13.081124 4.83460247,13.1560554 4.81544787,13.2216286 M5.49881989,13.2982381 C5.50111844,13.3661347 5.42290385,13.422414 5.32610931,13.4236402 C5.22874013,13.4257701 5.15001476,13.3708461 5.14899318,13.3041113 C5.14899318,13.2355693 5.22542,13.1798063 5.32272533,13.1781928 C5.41951987,13.1762566 5.49881989,13.2307933 5.49881989,13.2982381 M6.17012451,13.2722283 C6.18174496,13.3384468 6.11444849,13.4064725 6.01835628,13.4245438 C5.92386029,13.4419697 5.83638766,13.4011156 5.82432026,13.3354779 C5.81257211,13.2675814 5.88114555,13.1996203 5.97545,13.1820007 C6.07173375,13.1650911 6.15786557,13.2049126 6.17012451,13.2722283',\n    'fill-rule': 'nonzero',\n  });\n\n  const gInner: SVGElement = document.createElementNS(\n    'http://www.w3.org/2000/svg',\n    'g'\n  );\n  gInner.setAttribute('fill', color);\n  gInner.append(pathOne, pathTwo);\n\n  const gOuter: SVGElement = document.createElementNS(\n    'http://www.w3.org/2000/svg',\n    'g'\n  );\n  setAttributes(gOuter, {\n    stroke: 'none',\n    'stroke-width': '1',\n    fill: 'none',\n    'fill-rule': 'evenodd',\n  });\n  gOuter.appendChild(gInner);\n\n  const gitHubSVG: SVGElement = document.createElementNS(\n    'http://www.w3.org/2000/svg',\n    'svg'\n  );\n  setAttributes(gitHubSVG, {\n    viewBox: '0 0 17 16',\n    version: '1.1',\n    xmlns: 'http://www.w3.org/2000/svg',\n    'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n    width: size,\n    height: size,\n  });\n  gitHubSVG.classList.add('git-hub-svg');\n  gitHubSVG.appendChild(gOuter);\n\n  const gitHubLogoLink: HTMLAnchorElement = document.createElement('a');\n  gitHubLogoLink.classList.add('git-hub-logo-link');\n  setAttributes(gitHubLogoLink, {\n    href: projectName\n      ? `https://github.com/${gitHubUsername}/${projectName}`\n      : `https://github.com/${gitHubUsername}`,\n    rel: 'noopener noreferrer',\n    target: '_blank',\n    type: 'button',\n    'aria-label': 'GitHub profile link',\n  });\n  gitHubLogoLink.appendChild(gitHubSVG);\n\n  return gitHubLogoLink;\n}","import { InstructionsComponent } from \"../../components/buttons/instructions-component/instructions-component\";\nimport { createElement } from \"../../../utilities/random-utilities\";\n\n//  Main Container One Parabellum: Heading and Help Button\n\nexport function createMainOneParabellumFragment(\n  instructionsButton: InstructionsComponent\n): DocumentFragment {\n  const parabellumHeading = createElement('h2');\n  parabellumHeading.textContent = 'Parabellum';\n\n  const mainContainerOneParabellumWrapper: HTMLDivElement = createElement(\n    'div',\n    ['parabellum'],\n    {\n      id: 'main-container-one-parabellum',\n    }\n  );\n\n  mainContainerOneParabellumWrapper.append(parabellumHeading);\n  instructionsButton.render(mainContainerOneParabellumWrapper);\n\n  const parabellumFragment: DocumentFragment = new DocumentFragment();\n  parabellumFragment.append(mainContainerOneParabellumWrapper);\n\n  return parabellumFragment;\n}","import { createElement } from '../../../utilities/random-utilities';\nimport { CycloneSitRepScroller } from '../../../utilities/cycloneSitRepScroller.ts/cyclone-sit-rep-scroller';\n\n//  Main Container One Bellum: Situation Report (turn/attack state messaages)\n\nexport function createMainOneBellumFragment(\n  sitRepScrollerController: CycloneSitRepScroller\n): DocumentFragment {\n  const bellumHeading = createElement('h2');\n  bellumHeading.textContent = 'Parabellum';\n\n  const latestUpdatesHeading = createElement('h3');\n  latestUpdatesHeading.textContent = 'Situation Report:';\n\n  //  --------------------------------------------------------------\n  \n  const mainContainerOneBellumWrapper: HTMLDivElement = createElement(\n    'div',\n    ['bellum'],\n    {\n      id: 'main-container-one-bellum',\n    }\n  );\n  mainContainerOneBellumWrapper.append(\n    latestUpdatesHeading,\n    sitRepScrollerController.element\n  );\n\n  const bellumFragment: DocumentFragment = new DocumentFragment();\n  bellumFragment.appendChild(mainContainerOneBellumWrapper);\n\n  return bellumFragment;\n}\n","import { createElement } from '../../../utilities/random-utilities';\n\n\n//  Main Container One Post Bellum: <Insert Here>\n// ! Game over message with winner and loser text and a button to restart the game\n\nexport function createMainOnePostBellumFragment(\n  victoryBanner: HTMLElement\n): DocumentFragment {\n  const parabellumHeading: HTMLHeadingElement = createElement(\n    'h2',\n    ['secondary-heading'],\n    {\n      id: 'game-over-heading',\n    }\n  );\n  parabellumHeading.textContent = 'Game Over';\n\n  const mainContainerPostBellumWrapper: HTMLDivElement = createElement(\n    'div',\n    ['post-bellum'],\n    {\n      id: 'main-container-one-post-bellum',\n    }\n  );\n  mainContainerPostBellumWrapper.append(parabellumHeading, victoryBanner);\n\n  const postBellumFragment: DocumentFragment = new DocumentFragment();\n  postBellumFragment.appendChild(mainContainerPostBellumWrapper);\n\n  return postBellumFragment;\n}","import { createElement } from \"./random-utilities\";\n\n/**\n * A container for dynamically swapping and managing fragments of the DOM.\n * \n * @class CycloneHotSwapContainer\n * @param {keyof HTMLElementTagNameMap} elementTag - The HTML element tag for the container (e.g., 'section', 'div').\n * @param {{ [key: string]: DocumentFragment }} fragments - A collection of swappable fragments, keyed by string identifiers.\n * @param {string} initialFragmentKey - The key of the initial fragment to render in the container.\n * @param {string[]} [classNames=[]] - An array of class names to apply to the container element (optional).\n * @param {Record<string, string>} [attributes={}] - A set of attributes to apply to the container element (optional).\n */\nexport class CycloneHotSwapContainer {\n  private readonly hotSwapContainer: HTMLElement;\n  private readonly fragmentsArray: DocumentFragment[];\n  #currentIndex: number;\n\n  constructor(\n    private readonly elementTag: keyof HTMLElementTagNameMap,\n    private readonly fragments: { [key: string]: DocumentFragment },\n    private readonly initialFragmentKey: string,\n    private readonly classNames: string[] = [],\n    private readonly attributes: Record<string, string> = {}\n  ) {\n    if (!fragments[initialFragmentKey]) {\n      throw new Error(\n        `Initial fragment with key \"${initialFragmentKey}\" does not exist.`\n      );\n    }\n\n    this.hotSwapContainer = createElement(\n      this.elementTag,\n      this.classNames,\n      this.attributes\n    );\n\n    this.fragmentsArray = Object.values(this.fragments);\n\n    this.#currentIndex = this.setInitialIndex(\n      this.fragmentsArray,\n      this.fragments,\n      this.initialFragmentKey\n    );\n\n    this.hotSwapContainer.appendChild(this.fragments[this.initialFragmentKey]);\n  }\n\n  public render(targetElement: HTMLElement) {\n    targetElement.appendChild(this.hotSwapContainer);\n  }\n\n  public swapFragmentByKey(key: string): void {\n    const fragment = this.getFragment(key);\n    this.swapFragment(fragment);\n    this.#currentIndex = this.fragmentsArray.indexOf(fragment);\n  }\n\n  public swapByOrder(): void {\n    this.#currentIndex = (this.#currentIndex + 1) % this.fragmentsArray.length;\n    this.swapFragment(this.fragmentsArray[this.#currentIndex]);\n  }\n\n  private setInitialIndex(\n    fragmentsArray: DocumentFragment[],\n    fragments: { [key: string]: DocumentFragment },\n    initialFragmentKey: string\n  ): number {\n    const initialIndex = fragmentsArray.indexOf(fragments[initialFragmentKey]);\n    if (initialIndex === -1) {\n      throw new Error(\n        `Initial fragment with key \"${initialFragmentKey}\" does not exist.`\n      );\n    }\n    return initialIndex;\n  }\n\n  private getFragment(key: string): DocumentFragment {\n    const fragment = this.fragments[key];\n    if (!fragment) {\n      throw new Error(`Fragment with key \"${key}\" does not exist.`);\n    }\n    return fragment;\n  }\n\n  private swapFragment(fragment: DocumentFragment) {\n    this.hotSwapContainer.replaceChildren(fragment);\n  }\n}","import EventBus from \"../event-bus\";\n\nexport class CycloneTextComponent {\n  constructor(\n    public readonly element: HTMLElement,\n    private readonly initialText?: string\n  ) {\n    if (initialText) this.element.textContent = initialText;\n  }\n\n  public getElement(): HTMLElement {\n    return this.element;\n  }\n\n  public resetText(): void {\n    if (!this.initialText) return;\n    this.element.textContent = this.initialText;\n  }\n\n  public updateText(newText: string): void {\n    this.element.textContent = newText;\n  }\n}\n\nexport class CycloneReactiveText extends CycloneTextComponent {\n  constructor(\n    element: HTMLElement,\n    private readonly eventBus: EventBus,\n    private readonly rowName: string, // row on the bus ;)\n    initialText?: string\n  ) {\n    super(element, initialText);\n  }\n  \n  private updateTextWrapper = (newText: string) => {\n    this.updateText(newText);\n  };\n\n  public init() {\n    this.eventBus.on(this.rowName, this.updateTextWrapper);\n  }\n  \n  public destroy() {\n    this.eventBus.off(this.rowName, this.updateTextWrapper);\n  }\n}\n","import { BattleshipFleetBuilder } from '../logic/bs-fleet-builder/bs-fleet-builder';\nimport { BattleshipBoardBuilder } from '../logic/bs-gameboard-builder/bs-gameboard-builder';\nimport { BattleshipBoardController } from '../logic/bs-gameboard-controller/bs-gameboard-controller';\nimport { BattleshipBoardRepository } from '../logic/bs-gameboard-repository/bs-gameboard-repository';\nimport {\n  BattleshipBuilder,\n  SHIP_SYMBOLS\n} from '../logic/bs-ship-builder/bs-ship-builder';\nimport { PlayerContext, PlayerType } from './state-types';\n\n//  --------------------------------------------------------------\n//  Enumerations/Helpers\n\nexport enum AnglesOfRotation {\n  Degrees0 = 0,\n  Degrees90 = 90,\n  Degrees180 = 180,\n  Degrees270 = 270\n};\nexport enum ShipType {\n  Battleship = 'battleship',\n  Carrier = 'carrier',\n  Cruiser = 'cruiser',\n  Destroyer = 'destroyer',\n  PatrolBoat = 'patrolBoat',\n  Submarine = 'submarine',\n};\n\nexport const getShipTypes = (version: FleetVersion): ShipType[] =>\n  version === 1990\n    ? [\n        ShipType.Carrier,\n        ShipType.Battleship,\n        ShipType.Submarine,\n        ShipType.Destroyer,\n        ShipType.PatrolBoat,\n      ]\n    : [\n        ShipType.Carrier,\n        ShipType.Battleship,\n        ShipType.Submarine,\n        ShipType.Cruiser,\n        ShipType.Destroyer,\n        ShipType.PatrolBoat,\n      ];\n\n//  --------------------------------------------------------------\n//  Types\n\nexport type AngleOfRotation = null | AnglesOfRotation;\nexport type AxisArrayKey = `row-${number}` | `column-${number}`;\nexport type Coordinates = [number, number];\nexport type CoordinatesArray = Coordinates[];\nexport type CoordinatesToString = `[${number}, ${number}]`;\nexport type FleetPlacementConfig = Partial<\n  Record<ShipType, IPlacementConfigurations>\n>;\nexport type OccupiedCoordinatesSet = Set<CoordinatesToString> | null;\nexport type Fleet = {\n  [key in ShipType]?: BattleshipBuilder;\n};\nexport type FleetSet = { [key in PlayerType]: Fleet };\nexport type FleetConfigs = {\n  [key in ShipType]?: ShipConfig;\n};\nexport type FleetCoordinates = {\n  [key in ShipType]?: OccupiedCoordinatesSet | null;\n};\n\nexport type InBoundRotationalPlacePieceParamsForFleet = {\n  [key in ShipType]?: RotationalPositionMap | null;\n};\nexport type Gameboard = symbol[][];\nexport type OutOfBounds = 'outOfBounds';\nexport type Orientation = 'horizontal' | 'vertical';\nexport type PositionArray = IPosition[];\nexport type RotatedCoordinatesValue = Coordinates | OutOfBounds;\nexport type RotatedPlacePieceParams = {\n  [Key in AnglesOfRotation]?: RotatedPlacePieceParamsValue;\n};\nexport type RotatedPlacePieceParamsValue = IPlacePieceParams | OutOfBounds;\nexport type RotatedPlacePieceConfigurations = IPlacePieceParams | OutOfBounds;\nexport type ShipConfig = {\n  type: ShipType;\n  version?: FleetVersion;\n};\nexport type ShipLength = 2 | 3 | 4 | 5;\nexport type ShipSymbols = {\n  [key in ShipType]: symbol; // Each key in ShipType maps to a symbol\n};\nexport type ShipSymbolDescription = 'CA' | 'BS' | 'CR' | 'SB' | 'DD' | 'PB';\nexport type ShipSymbolValueArray = ShipSymbolValue[];\nexport type ShipSymbolValue = typeof SHIP_SYMBOLS[ShipType];\nexport type SizeLookupKey = `${ShipType}-${FleetVersion}`;\nexport type RotationalPositionMap = Map<AnglesOfRotation, IPlacePieceParams>;\nexport type FleetVersion = 1990 | 2002;\n\n//  --------------------------------------------------------------\n//  Interfaces\n\ninterface IGridGameboard<T> {\n  readonly board: T[][];\n  fillValue: T;\n};\nexport interface IGridGameboardSquare<T> extends IGridGameboard<T> {\n  boardSize: number;\n};\nexport interface IBattlehipFleetBuilderSet {\n  playerOneFleetBuilder: BattleshipFleetBuilder;\n  playerTwoFleetBuilder: BattleshipFleetBuilder;\n}\nexport interface IBattleshipGameboardBuilderSet {\n  playerOneBoardBuilder: BattleshipBoardBuilder;\n  playerTwoBoardBuilder: BattleshipBoardBuilder;\n}\nexport interface IBattleshipFleetBuilderSet {\n  playerOneFleetBuilder: BattleshipFleetBuilder;\n  playerTwoFleetBuilder: BattleshipFleetBuilder;\n}\nexport interface IBattleshipGameboardController extends IGridGameboardController {\n  playerState: Omit<PlayerContext, 'gameboardController' | 'fleetBuilder'>;\n  getValidPositions(\n    shipPlacementConfigs: IShipPlacementConfigurations\n  ): IValidPositionsResult;\n  movePiece(ship: BattleshipBuilder, newBowCoordinates: Coordinates): void;\n  placePiece(options: IPlacePieceWrapperParams): void;\n  prettyPrint(): void;\n  removePiece(ship: BattleshipBuilder, resetInitialConfigs: boolean): void;\n  removeAllPieces(fleet: Fleet): void;\n  rotatePiece(ship: BattleshipBuilder): void;\n}\nexport interface IBattleshipGameboardControllerSet {\n  playerOneBoardController: BattleshipBoardController;\n  playerTwoBoardController: BattleshipBoardController;\n}\nexport interface IBattleshipGameboardRepositorySet {\n  playerOneBoardRepository: BattleshipBoardRepository;\n  playerTwoBoardRepository: BattleshipBoardRepository;\n}\ninterface IGridGameboardController {\n  placePiece(...args: any): void;\n  removePiece(...args: any): void;\n  removeAllPieces(...args: any): void;\n}\nexport interface IPlacementConfigurations {\n  coordinatesArray: CoordinatesArray | null;\n  orientation: Orientation | null;\n};\nexport interface IRotationalPivotConfigurations extends IPlacementConfigurations {\n  transientAngleOfRotation: AngleOfRotation;\n};\nexport interface IPlacePieceParams {\n  coordinates: Coordinates;\n  orientation: Orientation;\n};\nexport interface IPlacePieceWrapperParams extends IPlacePieceParams {\n  ship: BattleshipBuilder;\n};\nexport interface IPlacePieceCallbackParams extends IPlacePieceWrapperParams {\n  battleshipBoardBuilder: BattleshipBoardBuilder\n  battleshipBoardController: BattleshipBoardController;\n  battleshipBoardRepository: BattleshipBoardRepository;\n};\nexport interface IPosition {\n  bow: Coordinates; // [rowIndex, colIndex]\n  stern: Coordinates; // [rowIndex, colIndex]\n};\nexport interface IShipOptions {\n  hitCounter: number;\n  length: ShipLength;\n  type: ShipType;\n  version: FleetVersion;\n};\nexport interface IShipPlacementConfigurations {\n  orientation: Orientation;\n  shipLength: ShipLength;\n};\nexport interface ITestCaseShipHit {\n  expected: string; // Expected output\n  hits: number; // Function returning the string to be tested\n};\nexport interface ITestCaseValidPositions {\n  shipPlacementConfigs: IShipPlacementConfigurations;\n  validPositions: IValidPositionsResult;\n};\nexport interface IValidPlacementCallbackParams extends IShipPlacementConfigurations {\n  battleshipBoardBuilder: BattleshipBoardBuilder;\n  battleshipBoardController: BattleshipBoardController;\n};\nexport interface IValidPositionsResult {\n  [key: AxisArrayKey]: PositionArray;\n};","import {\n  AnglesOfRotation,\n  Coordinates,\n  OccupiedCoordinatesSet,\n  CoordinatesToString,\n  FleetCoordinates,\n  IPlacePieceParams,\n  IPosition,\n  Orientation,\n  OutOfBounds,\n  RotatedCoordinatesValue,\n  ShipLength,\n  ShipType,\n  PositionArray,\n  ShipSymbolDescription,\n  CoordinatesArray,\n} from '../types/logic-types';\nimport { PlayerType } from '../types/state-types';\n\nexport const isAngleOfRotation = (value: unknown): value is AnglesOfRotation => {\n  return Object.values(AnglesOfRotation).includes(value as ShipType);\n}\nexport const isCoordinates = (value: unknown): value is Coordinates => {\n  if (!Array.isArray(value) || value.length !== 2) return false;\n\n  return value.every((coordinate) => typeof coordinate === 'number');\n};\nexport const isCoordinatesArray = (\n  value: unknown\n): value is CoordinatesArray =>\n  Array.isArray(value) && value.length > 0 && value.every(isCoordinates);\n\nexport const isOccupiedCoordinatesSet = (\n  value: unknown\n): value is OccupiedCoordinatesSet => {\n  if (value === null) return true;\n  if (!(value instanceof Set)) return false;\n\n  for (const member of value) {\n    if (!isCoordinatesToString(member)) {\n      return false;\n    }\n  }\n\n  return true;\n};\nexport const isFleetCoordinates = (\n  value: unknown\n): value is FleetCoordinates => {\n  if (typeof value !== 'object' || value === null) return false;\n\n  for (const key in value) {\n    if (!Object.values(ShipType).includes(key as ShipType)) {\n      return false;\n    }\n\n    const OccupiedCoordinatesSetOrNull = (value as FleetCoordinates)[\n      key as ShipType\n    ];\n\n    if (\n      OccupiedCoordinatesSetOrNull !== null &&\n      !isOccupiedCoordinatesSet(OccupiedCoordinatesSetOrNull)\n    ) {\n      return false;\n    }\n  }\n  return true;\n};\nexport const isHTMLDivElement = (el: Element): el is HTMLDivElement => el instanceof HTMLDivElement;\nexport const isHTMLDivElementArray = (value: unknown): value is HTMLDivElement[] =>\n  Array.isArray(value) && value.length > 0 && value.every(isHTMLDivElement);\nexport const isHTMLElement = (el: Element): el is HTMLElement => el instanceof HTMLElement;\nexport const isPlainObject = (value: unknown): value is object => {\n  if (typeof value !== 'object' || value === null) return false;\n\n  const proto = Object.getPrototypeOf(value);\n  return proto === Object.prototype || proto === null;\n  // ? Why `proto === null`: Object.create(null) is a valid plain object.\n};\nexport const isOrientation = (value: unknown): value is Orientation => {\n  if (typeof value !== 'string') return false;\n  return ['horizontal', 'vertical'].includes(value);\n};\nexport const isOutOfBounds = (value: unknown): value is OutOfBounds => {\n  return value === 'outOfBounds';\n};\nexport const isPlacePieceParams = (\n  value: unknown\n): value is IPlacePieceParams => {\n  if (typeof value !== 'object' || value === null) return false;\n\n  if (!isCoordinates((value as IPlacePieceParams).coordinates)) return false;\n\n  return true;\n};\nexport const isPlayerType = (value: unknown): value is PlayerType => {\n  return (\n    typeof value === 'string' && (value === 'player' || value === 'opponent')\n  );\n};\nexport const isPosition = (value: unknown): value is IPosition => {\n  if (!isPlainObject(value)) return false;\n\n  const { bow, stern } = value as IPosition;\n\n  return isCoordinates(bow) && isCoordinates(stern);\n};\nexport const isPositionsArray = (value: unknown): value is PositionArray => {\n  if (!Array.isArray(value)) return false;\n\n  return value.every((position) => isPosition(position));\n};\nexport const isCoordinatesToString = (\n  value: unknown\n): value is CoordinatesToString => {\n  if (typeof value !== 'string') return false;\n\n  const match = value.match(/^\\[\\d{1}, \\d{1}\\]$/);\n  return match !== null;\n};\nexport const isRotatedCoordinatesValue = (\n  value: unknown\n): value is RotatedCoordinatesValue => {\n  return isCoordinates(value) || isOutOfBounds(value);\n};\nexport const isShipLength = (value: unknown): value is ShipLength => {\n  return typeof value === 'number' && [2, 3, 4, 5].includes(value);\n};\nexport const isShipSymbolDescription = (\n  value: unknown\n): value is ShipSymbolDescription => {\n  return (\n    typeof value === 'string' &&\n    ['CA', 'BS', 'CR', 'SB', 'DD', 'PB'].includes(value)\n  );\n};\nexport const isShipType = (value: unknown): value is ShipType => {\n  return Object.values(ShipType).includes(value as ShipType);\n};","import { BattleshipFleetBuilder } from '../logic/bs-fleet-builder/bs-fleet-builder';\nimport { BattleshipBoardBuilder } from '../logic/bs-gameboard-builder/bs-gameboard-builder';\nimport { BattleshipBoardController } from '../logic/bs-gameboard-controller/bs-gameboard-controller';\nimport { BattleshipBoardRepository } from '../logic/bs-gameboard-repository/bs-gameboard-repository';\nimport { ShipType } from './logic-types';\n\n//  --------------------------------------------------------------\n\nexport type AttackResult = {\n  hit: boolean;\n  isSunk?: boolean;\n  type?: ShipType;\n};\nexport type CurrentPlayer = PlayerType | null;\nexport type GamePhase = 'parabellum' | 'bellum' | 'postBellum';\nexport type MessageSubject = 'You' | 'Your opponent';\nexport type MessageTarget = 'your' | 'their'; \nexport type MessageType = 'turn' | 'attack';\nexport type PlayerType = 'player' | 'opponent';\n\nexport enum gameboardStateValue {\n  inactive = 0,\n  active = 1,\n}\n//  --------------------------------------------------------------\n\nexport interface PlayerContext {\n  gameboardBuilder: BattleshipBoardBuilder;\n  gameboardController: BattleshipBoardController;\n  gameboardRepository: BattleshipBoardRepository;\n  fleetBuilder: BattleshipFleetBuilder;\n};\n\nexport interface PlayerCore {\n  player: PlayerContext;\n  opponent: PlayerContext;\n}","//  State\nimport { GameState } from '../../../../state/game-state';\n\n//  Logic\nimport { BattleshipBuilder } from '../../../../logic/bs-ship-builder/bs-ship-builder';\nimport { BattleshipFleetBuilder } from '../../../../logic/bs-fleet-builder/bs-fleet-builder';\nimport { BattleshipBoardController } from '../../../../logic/bs-gameboard-controller/bs-gameboard-controller';\n\n//  Types\nimport {\n  isCoordinatesArray,\n  isHTMLDivElementArray,\n  isHTMLElement,\n  isOrientation,\n  isShipLength,\n  isShipType,\n} from '../../../../types/type-guards'\nimport {\n  Coordinates,\n  CoordinatesArray,\n  Fleet,\n  Gameboard,\n  Orientation,\n  ShipLength,\n  ShipSymbolValue,\n  ShipSymbolValueArray,\n  ShipType,\n  } from '../../../../types/logic-types'\nimport {\n  AttackResult,\n  PlayerContext,\n  gameboardStateValue,\n} from '../../../../types/state-types';\nimport { GridCellDataKey } from '../../../../types/dom-types';\nimport {\n  CloneSnapOffset,\n  DragState,\n  ShipBorderValueSplit,\n} from '../../component-types';\nimport { GridPlacementValue } from '../../../../types/css-types';\n\n//  Utilities\nimport {\n  areArraysEqual,\n  createElement,\n  getConvertedTypeFromAttr,\n  sleep,\n  waitForAnimationEnd,\n  waitForTransitionEnd,\n} from '../../../../utilities/random-utilities';\n\n//  Stylesheets\nimport '../gameboard-component.scss';\nimport '../gameboard-animations.scss';\n\n//  --------------------------------------------------------------\n\nexport class PlayerGameboardComponent {\n  public id: string = 'player';\n\n  //  Elements\n  public gameboardContainer: HTMLElement;\n  private gameboard: DocumentFragment;\n  private fleetElements: Map<ShipType, HTMLDivElement> = new Map();\n  private dragImage: HTMLImageElement;\n  private shipDragClone: HTMLDivElement;\n\n  //  Event listeners\n  private listenersAdded: boolean = false;\n  private dragState: DragState = {\n    currentShipInstance: null,\n    initialPlacementConfigurations: null,\n    isValidDropTarget: false,\n    currentDragOverCell: null,\n    cloneSnapOffset: null,\n    shipBorderValueSplit: null,\n  };\n  private dragEventCallbacks: Record<string, (e: DragEvent) => void> = {\n    dragstart: (e: DragEvent) => this.handleShipDragStart(e, this.dragState),\n    drag: (e: DragEvent) => this.handleShipDrag(e, this.dragState),\n    dragenter: (e: DragEvent) => this.handleShipDragEnter(e),\n    dragleave: (e: DragEvent) => this.handleShipDragLeave(e),\n    dragover: (e: DragEvent) => this.handleShipDragOver(e, this.dragState),\n    drop: (e: DragEvent) => this.handleShipDrop(e, this.dragState),\n    dragend: (e: DragEvent) => this.handleShipDragEnd(e, this.dragState),\n  };\n\n  constructor(\n    public readonly playerState: PlayerContext,\n    private readonly gameState: GameState\n  ) {\n    this.gameboardContainer = this.generateBoardContainer(\n      this.playerState.gameboardBuilder.boardSize\n    );\n\n    this.gameboard = this.generateBoardFragment(\n      this.playerState.gameboardBuilder.boardSize\n    );\n    this.dragImage = this.createDragImage();\n    this.shipDragClone = this.createShipDragClone();\n\n    this.gameState.eventBus.on(\n      'refreshGameboard',\n      this.refreshGameboardWrapper\n    );\n    this.gameState.eventBus.on(\n      'togglePlayerGameboardControls',\n      this.toggleGameboardControls\n    );\n    this.gameState.eventBus.on('receiveBillowAttack', this.receiveAttack);\n  }\n\n  public render(targetElement: HTMLElement): void {\n    if (!targetElement) {\n      throw new Error(\n        `Target element not found with ID - ${this.id} and selector - \"${targetElement}\".`\n      );\n    }\n\n    this.gameboardContainer.append(\n      this.dragImage,\n      this.shipDragClone,\n      this.gameboard\n    );\n    this.handleFleetPlacement(\n      this.playerState.fleetBuilder,\n      this.fleetElements\n    );\n    this.toggleParabellumListeners();\n\n    targetElement.appendChild(this.gameboardContainer);\n  }\n\n  public toggleParabellumListeners(): void {\n    if (!this.gameboardContainer) return;\n\n    const method = this.listenersAdded\n      ? 'removeEventListener'\n      : 'addEventListener';\n\n    // * Toggle Drag Events\n    Object.entries(this.dragEventCallbacks).forEach(([event, callback]) => {\n      this.gameboardContainer[method](event, callback as EventListener);\n    });\n\n    // * Toggle Rotation Event\n    this.gameboardContainer[method](\n      'click',\n      this.handleShipRotation as EventListener\n    );\n\n    this.listenersAdded = !this.listenersAdded;\n  }\n\n  private togglePlayerTurn(attackResult: AttackResult): void {\n    const { hit, isSunk } = attackResult;\n\n    if ((hit && !isSunk) || !hit) {\n      this.gameState.togglePlayerTurn();\n      return;\n    }\n\n    if (hit && isSunk) {\n      const isGameOver: boolean = this.isGameOver();\n      if (!isGameOver) {\n        this.gameState.togglePlayerTurn();\n        return;\n      }\n\n      this.gameState.eventBus.emit('updateVictoryBannerText', 'You Lose Dumbass!'); \n      this.gameState.transitionToNextPhase();\n    }\n  }\n\n  public toggleShipsDraggable(): void {\n    this.fleetElements.forEach((shipElement) => {\n      shipElement.removeAttribute('draggable');\n    });\n  }\n\n  public toggleShipAdriftClass(): void {\n    this.fleetElements.forEach((shipElement) => {\n      shipElement.classList.remove('adrift');\n    });\n  }\n\n  //  --------------------------------------------------------------\n  //  Helpers\n\n  private applyGridPlacementValue(\n    gridPlacementValue: GridPlacementValue,\n    gridCrossAxis: number,\n    shipElement: HTMLDivElement,\n    orientation: Orientation,\n    shipLength: ShipLength\n  ): void {\n    const isHorizontal: boolean = orientation === 'horizontal';\n    if (isHorizontal) {\n      shipElement.style.gridColumn = gridPlacementValue;\n      shipElement.style.gridRow = gridCrossAxis.toString();\n      shipElement.style.gridTemplateColumns = `repeat(${shipLength}, 1fr)`;\n    } else {\n      shipElement.style.gridRow = gridPlacementValue;\n      shipElement.style.gridColumn = gridCrossAxis.toString();\n      shipElement.style.gridTemplateRows = `repeat(${shipLength}, 1fr)`;\n    }\n  }\n\n  // TODO: move this to game state\n  private isGameOver(): boolean {\n    return this.playerState.gameboardRepository.areAllShipsSunk();\n  }\n\n  private createDragImage(): HTMLImageElement {\n    const invisibleImage = createElement(\n      'img',\n      ['drag-image', 'accessibility'],\n      {\n        id: `${this.id}-drag-image`,\n        src: 'https://cyclone-studios.s3.us-east-2.amazonaws.com/s3_misc-images/1x1_transparent.png',\n      }\n    );\n\n    return invisibleImage;\n  }\n\n  private createShipDragClone(): HTMLDivElement {\n    const shipCloneElement: HTMLDivElement = createElement(\n      'div',\n      ['ship-container-clone'],\n      {\n        id: `${this.id}-ship-drag-clone`,\n      }\n    );\n\n    return shipCloneElement;\n  }\n\n  private createBackgroundCellsFragment(\n    gameboard: Gameboard\n  ): DocumentFragment {\n    const cellFragment: DocumentFragment = new DocumentFragment();\n\n    gameboard.forEach((row: ShipSymbolValueArray, rowIndex) => {\n      row.forEach((symbol: ShipSymbolValue, colIndex) => {\n        const symbolDescription: string = symbol.description!.toLowerCase();\n\n        const hitMarker: HTMLDivElement = createElement('div', [\n          `${this.id}-hit-marker`,\n          'hit-marker',\n        ]);\n\n        const gridCell: HTMLDivElement = createElement(\n          'div',\n          [\n            `${this.id}-${symbolDescription}-cell`,\n            `player-${symbolDescription}-cell`,\n            'grid-cell',\n          ],\n          {\n            'data-x': colIndex.toString(),\n            'data-y': rowIndex.toString(),\n            'aria-label': `Row ${rowIndex + 1}, Column ${colIndex + 1}`,\n            role: 'gridCell',\n          }\n        );\n        gridCell.appendChild(hitMarker);\n\n        const gridCellContainer: HTMLDivElement = createElement('div', [\n          `${this.id}-${symbolDescription}-grid-cell-container`,\n          'grid-cell-container',\n        ]);\n        gridCellContainer.appendChild(gridCell);\n\n        cellFragment.appendChild(gridCellContainer);\n      });\n    });\n\n    return cellFragment;\n  }\n\n  private createShipElement(\n    shipType: ShipType,\n    shipLength: ShipLength,\n    gridPlacementValue: GridPlacementValue,\n    gridCrossAxis: number,\n    orientation: Orientation\n  ): HTMLDivElement {\n    const shipUnitFragment: DocumentFragment = this.generateShipUnitFragment(\n      shipLength,\n      shipType,\n      orientation,\n      this.id,\n      gridPlacementValue,\n      gridCrossAxis\n    );\n\n    const shipContainerElement: HTMLDivElement = createElement(\n      'div',\n      ['ship-container', 'player-ship-container', 'adrift'],\n      {\n        id: `${this.id}-${shipType}-container`,\n        'data-dragging': 'false',\n        'data-length': shipLength.toString(),\n        'data-orientation': orientation,\n        'data-shipType': shipType,\n        draggable: 'true',\n      }\n    );\n\n    shipContainerElement.appendChild(shipUnitFragment);\n\n    this.applyGridPlacementValue(\n      gridPlacementValue,\n      gridCrossAxis,\n      shipContainerElement,\n      orientation,\n      shipLength\n    );\n\n    this.syncShipUnitDataAttributes(shipContainerElement, shipType);\n\n    return shipContainerElement;\n  }\n\n  private generateBoardContainer(boardSize: number): HTMLElement {\n    const gameboardContainer: HTMLElement = createElement(\n      'section',\n      ['gameboard-container'],\n      {\n        id: `${this.id}-gameboard-container`,\n      }\n    );\n\n    gameboardContainer.style.setProperty('--grid-size', boardSize.toString());\n\n    return gameboardContainer;\n  }\n\n  private generateBoardFragment(boardSize: number): DocumentFragment {\n    const gameboardBackground: HTMLDivElement = createElement(\n      'div',\n      ['gameboard-background'],\n      {\n        id: `${this.id}-gameboard-background`,\n      }\n    );\n    gameboardBackground.appendChild(\n      this.createBackgroundCellsFragment(\n        this.playerState.gameboardBuilder.board\n      )\n    );\n\n    const gameboard = createElement('div', ['gameboard'], {\n      id: `${this.id}-gameboard`,\n    });\n    gameboard.style.setProperty('--grid-size', boardSize.toString());\n\n    const boardFragment: DocumentFragment = new DocumentFragment();\n    boardFragment.append(gameboardBackground, gameboard);\n\n    return boardFragment;\n  }\n\n  private generateShipUnitFragment(\n    shipLength: ShipLength,\n    shipType: ShipType,\n    orientation: Orientation,\n    id: string,\n    gridPlacementValue: GridPlacementValue,\n    gridCrossAxis: number\n  ): DocumentFragment {\n    const shipUnitFragment: DocumentFragment = new DocumentFragment();\n\n    for (let i = 0; i < shipLength; i++) {\n      const isBow: boolean = i === 0;\n      const isStern: boolean = i === shipLength - 1;\n      const shipUnit: HTMLDivElement = createElement('div', [\n        'ship-unit',\n        `${shipType}-unit`,\n        `${id}-${shipType}-unit`,\n      ]);\n\n      const isHorizontal: boolean = orientation === 'horizontal';\n\n      isHorizontal\n        ? shipUnit.classList.add('ship-unit-horizontal')\n        : shipUnit.classList.add('ship-unit-vertical');\n\n      if (isBow) {\n        shipUnit.classList.add('ship-bow');\n        shipUnit.setAttribute('id', `${id}-${shipType}-bow`);\n      }\n\n      if (isStern) {\n        shipUnit.classList.add('ship-stern');\n        shipUnit.setAttribute('id', `${id}-${shipType}-stern`);\n      }\n\n      shipUnitFragment.appendChild(shipUnit);\n    }\n\n    return shipUnitFragment;\n  }\n\n  private getGridPlacementValue(\n    coordinates: Coordinates,\n    orientation: Orientation,\n    shipLength: ShipLength\n  ): [GridPlacementValue, number] {\n    const isHorizontal = orientation === 'horizontal';\n\n    const [x, y] = coordinates;\n    const gridStartMain = isHorizontal ? x + 1 : y + 1;\n    const gridCrossAxis = isHorizontal ? y + 1 : x + 1;\n\n    return [`${gridStartMain} / span ${shipLength}`, gridCrossAxis];\n  }\n\n  // TODO: create return signature type\n  private getShipPlacementData(shipType: ShipType): {\n    bowCoordinates: Coordinates;\n    orientation: Orientation;\n    shipLength: ShipLength;\n  } {\n    const ship: BattleshipBuilder =\n      this.playerState.fleetBuilder.getShip(shipType);\n    \n    const { coordinatesArray, orientation } =\n      ship.currentplacementConfigurations;\n\n    if (!coordinatesArray || !orientation) {\n      throw new Error(`The ${ship.type} has no placement configurations.`);\n    }\n\n    return {\n      bowCoordinates: coordinatesArray[0],\n      orientation,\n      shipLength: ship.length,\n    };\n  }\n\n  private handleFleetPlacement(\n    fleetBuilder: BattleshipFleetBuilder,\n    fleetElements: Map<ShipType, HTMLDivElement>\n  ) {\n    this.updateFleetElements(fleetBuilder);\n    this.placeFleetOnGameboard(fleetElements);\n  }\n\n  private async cookShipUnit(\n    shipType: ShipType,\n    attackCoordinates: Coordinates\n  ): Promise<void> {\n    const shipContainerElement = this.fleetElements.get(shipType);\n\n    if (!shipContainerElement) {\n      throw new Error(`The ${shipType} has no fleet element.`);\n    }\n    const [x, y]: Coordinates = attackCoordinates; // TODO: fix this\n    const attackedShipUnit = shipContainerElement.querySelector(\n      `[data-x=\"${x}\"][data-y=\"${y}\"]`\n    );\n    attackedShipUnit?.classList.add('cooked');\n\n    if (attackedShipUnit) {\n      attackedShipUnit.classList.add('cooked');\n\n      if (!isHTMLElement(attackedShipUnit))\n        throw new Error('The attacked ship must be an HTML Element.');\n\n      // '1600' +100ms after transition end in main.scss (1.5s)\n      await waitForTransitionEnd(attackedShipUnit, 999);\n      await sleep(2000);\n    } else {\n      console.warn(\n        `No ship unit found at coordinates (${x}, ${y}) on ${shipType}.`\n      );\n    }\n  }\n\n  private handleSinkingShip = async (shipType: ShipType): Promise<void> => {\n    const shipContainerElement = this.fleetElements.get(shipType);\n    \n    if (!shipContainerElement) {\n      throw new Error(`The ${shipType} has no fleet element.`);\n    }\n\n    await this.sinkShip(shipContainerElement);\n  };\n\n  private hasTargetBeenAttacked(coordinates: Coordinates): boolean {\n    const alreadyAttacked =\n      this.playerState.gameboardRepository.hasTargetBeenAttacked(coordinates);\n\n    if (!alreadyAttacked) {\n      this.playerState.gameboardRepository.addAttackedCoordinates(coordinates);\n    }\n\n    return alreadyAttacked;\n  }\n\n  private placeFleetOnGameboard(\n    fleetElements: Map<ShipType, HTMLDivElement>\n  ): void {\n    const gameboard =\n      this.gameboardContainer.querySelector<HTMLDivElement>('.gameboard');\n\n    if (!gameboard) {\n      throw new Error('Gameboard container not found.');\n    }\n\n    fleetElements.forEach((shipElement) => gameboard.appendChild(shipElement));\n  }\n\n  private _receiveAttack = async (\n    attackCoordinates: Coordinates\n  ): Promise<AttackResult> => {\n    const gridCellDataKey: GridCellDataKey = `[data-x=\"${attackCoordinates[0]}\"][data-y=\"${attackCoordinates[1]}\"]`;\n    const gridCell: HTMLDivElement | null =\n      this.gameboardContainer.querySelector<HTMLDivElement>(gridCellDataKey);\n\n    if (!gridCell) {\n      throw new Error('Grid cell not found.');\n    }\n\n    if (this.hasTargetBeenAttacked(attackCoordinates)) {\n      /* </>\n      \n       [INFO]                                                                      \n       This case is unreachable with Billow's coordinate logic,                    \n       but valid when playing against a human who may repeat attacks.              \n                                                                                   \n       [BACKLOG]                                                                    \n       TODO: Add a flash animation to indicate \"Cell already attacked\".             \n                                                                                   \n      \n      */\n\n      console.warn('Cell has already been attacked:', attackCoordinates);\n\n      return {\n        hit: false,\n      } as AttackResult;\n    }\n\n    const attackResult: AttackResult =\n      this.playerState.gameboardController.receiveAttack(attackCoordinates);\n\n    try {\n      await this.triggerPrePlayerToggleAnimations(\n        attackResult,\n        gridCell,\n        attackCoordinates\n      );\n    } catch (error) {\n      console.error('Error in triggerPrePlayerToggleAnimations', error);\n    }\n\n    this.togglePlayerTurn(attackResult);\n\n    return attackResult;\n  };\n\n  private receiveAttack = async (\n    attackCoordinates: Coordinates\n  ): Promise<AttackResult> => {\n    return await this._receiveAttack(attackCoordinates);\n  };\n\n  private refreshGameboard(boardContainer: HTMLElement): void {\n    /* </>\n    \n     [BACKLOG]                                                                   \n     TODO: Refactor this method to remove only the ship being moved and          \n     re-place it at the new position instead of resetting the entire board. This \n     will improve performance, preserve other ship states, and reduce unnecessary\n     operations.                                                                 \n    \n   */\n\n    const gameboard = boardContainer.querySelector(`#${this.id}-gameboard`);\n    const gameboardBackground = boardContainer.querySelector(\n      `#${this.id}-gameboard-background`\n    );\n\n    if (!gameboard || !gameboardBackground)\n      throw new Error('Missing gameboard and/or gameboard background elements');\n\n    this.gameboardContainer.removeChild(gameboard);\n    this.gameboardContainer.removeChild(gameboardBackground);\n    this.shipDragClone.classList.remove('visible');\n\n    this.gameboard = this.generateBoardFragment(\n      this.playerState.gameboardBuilder.boardSize\n    );\n\n    this.gameboardContainer.appendChild(this.gameboard);\n\n    this.handleFleetPlacement(\n      this.playerState.fleetBuilder,\n      this.fleetElements\n    );\n  }\n\n  private refreshGameboardWrapper = (): void => {\n    this.refreshGameboard(this.gameboardContainer);\n  };\n\n  private setFleetElement = (\n    shipType: ShipType,\n    shipLength: ShipLength,\n    gridPlacementValue: GridPlacementValue,\n    gridCrossAxis: number,\n    orientation: Orientation\n  ) => {\n    const shipElement: HTMLDivElement = this.createShipElement(\n      shipType,\n      shipLength,\n      gridPlacementValue,\n      gridCrossAxis,\n      orientation\n    );\n\n    this.fleetElements.set(shipType, shipElement);\n  };\n\n  private syncShipUnitDataAttributes = (\n    shipContainerElement: HTMLDivElement,\n    shipType: ShipType\n  ): void => {\n    const ship: BattleshipBuilder =\n      this.playerState.fleetBuilder.getShip(shipType);\n\n    const { coordinatesArray } = ship.currentplacementConfigurations;\n\n    if (!isCoordinatesArray(coordinatesArray)) {\n      throw new Error(\n        \"The ship's coordinates array is improperly structured or non-existent.\"\n      );\n    }\n\n    const shipUnitElements = Array.from(shipContainerElement.children).filter(\n      isHTMLElement\n    );\n\n    if (!isHTMLDivElementArray(shipUnitElements))\n      throw new Error(\"All ship unit's must be HTML DIV elements.\");\n\n    // The length of the coordinates should be exactly the amount of ship unit elements.\n    if (coordinatesArray.length !== shipUnitElements.length) {\n      throw new Error(\n        `Mismatch between ship units (${shipUnitElements.length}) and coordinates (${coordinatesArray.length}) for ${shipType}`\n      );\n    }\n\n    coordinatesArray.forEach(([x, y], index) => {\n      const unit = shipUnitElements[index];\n      unit.setAttribute('data-x', String(x));\n      unit.setAttribute('data-y', String(y));\n    });\n  };\n\n  private sinkShip = async (\n    shipContainerElement: HTMLDivElement\n  ): Promise<void> => {\n    const DELAY_AFTER_TRANSITION_SECOND: number = 1;\n\n    shipContainerElement.classList.add('sunk');\n\n    await waitForAnimationEnd(shipContainerElement);\n\n    await sleep(DELAY_AFTER_TRANSITION_SECOND * 1000);\n  };\n\n  private toggleGameboardControls = (\n    newGameboardState: gameboardStateValue\n  ): void => {\n    this.gameboardContainer.classList.toggle(\n      'locked',\n      newGameboardState === gameboardStateValue.inactive\n    );\n  };\n\n  // `attackCoordinates` is optional because it is not needed for the opponent gameboard.\n  // This is done to prepare for merging the opponent and player gameboard component modules.\n  private triggerPrePlayerToggleAnimations = async (\n    attackResult: AttackResult,\n    gridCell: HTMLDivElement,\n    attackCoordinates?: Coordinates\n  ): Promise<void> => {\n    const uiUpdate = this.updateUIPostAttack(\n      attackResult,\n      gridCell,\n      attackCoordinates\n    );\n    const sitRepUpdate = this.gameState.eventBus.emit(\n      'setAndScrollToNextSitRep',\n      attackResult\n    );\n\n    await Promise.all([uiUpdate, sitRepUpdate]);\n  };\n\n  private updateFleetElements = (fleetBuilder: BattleshipFleetBuilder) => {\n    if (this.fleetElements.size) this.fleetElements.clear();\n\n    for (const ship of Object.values(fleetBuilder.fleet)) {\n      const shipType: ShipType = ship.type;\n      const shipLength: ShipLength = ship.length;\n\n      const orientation: Orientation | null =\n        ship.currentplacementConfigurations.orientation;\n\n      if (!orientation) throw new Error('Orientation not set.');\n\n      const coordinatesArray: CoordinatesArray | null =\n        ship.currentplacementConfigurations.coordinatesArray;\n\n      if (!coordinatesArray || coordinatesArray.length === 0) {\n        console.error(`The ${shipType} has not been placed. Continuing...`);\n        continue;\n      }\n\n      const bowCoordinates: Coordinates = coordinatesArray[0];\n      const [gridPlacementValue, gridCrossAxis]: [GridPlacementValue, number] =\n        this.getGridPlacementValue(bowCoordinates, orientation, shipLength);\n\n      this.setFleetElement(\n        shipType,\n        shipLength,\n        gridPlacementValue,\n        gridCrossAxis,\n        orientation\n      );\n    }\n  };\n\n  private updateUIPostAttack = async (\n    attackResult: AttackResult,\n    gridCell: HTMLDivElement,\n    attackCoordinates?: Coordinates\n  ): Promise<void> => {\n    const { hit, isSunk, type } = attackResult;\n\n    if (!hit) {\n      gridCell.classList.add('miss');\n      return;\n    }\n\n    if (!isShipType(type))\n      throw new Error(`The ${type} is not a valid ship type.`);\n    \n    if (!attackCoordinates) {\n      throw new Error(\n        'Attack coordinates not found. They are required for updating the player gameboard post attack.'\n      );\n    }\n\n    gridCell.classList.add('hit');\n        this.gameState.eventBus.emit('markNextHitPoint', {\n      playerType: 'player',\n      shipType: type,\n    });\n\n    \n    await this.cookShipUnit(type, attackCoordinates);\n\n    if (!isSunk) return;\n    \n    await this.handleSinkingShip(type);    \n  };\n\n  //  --------------------------------------------------------------\n  //  Ship Repositioning\n\n  private handleShipDragStart(e: DragEvent, dragState: DragState) {\n    if (\n      !(e.target instanceof HTMLDivElement) ||\n      !e.target.matches('.ship-container')\n    )\n      return;\n\n    const setInitialDragStyles = (\n      shipContainerElement: HTMLDivElement\n    ): void => {\n      // Set dragging attribute to true\n      shipContainerElement.setAttribute('data-dragging', 'true');\n\n      requestAnimationFrame(() => {\n        shipContainerElement.classList.add('locked');\n      });\n\n      // Make clone visible\n      this.shipDragClone.classList.add('visible');\n    };\n    const setCloneDimensions = (\n      shipContainer: HTMLDivElement,\n      shipClone: HTMLDivElement\n    ) => {\n      const shipBoundingRect = shipContainer.getBoundingClientRect();\n      shipClone.style.height = `${shipBoundingRect.height}px`;\n      shipClone.style.width = `${shipBoundingRect.width}px`;\n    };\n    const getCloneSnapOffset = (\n      shipContainerElement: HTMLDivElement,\n      orientation: Orientation,\n      dragState: DragState\n    ): CloneSnapOffset => {\n      const getShipBow = (\n        shipContainerElement: HTMLDivElement\n      ): HTMLDivElement => {\n        const shipBow: HTMLDivElement | null =\n          shipContainerElement.querySelector(`.ship-bow`);\n        if (!shipBow) throw new Error('Ship bow not found.');\n        return shipBow;\n      };\n\n      // Get ship bow element (cursor snap position)\n      const shipBow: HTMLDivElement = getShipBow(shipContainerElement);\n\n      // Get border of ship border to include in offset calculations\n      const shipBorderSize = getComputedStyle(document.documentElement)\n        .getPropertyValue('--ship-container-border-size')\n        .trim();\n\n      const match = shipBorderSize.match(\n        /^(?<numberValue>\\d+(\\.\\d+)?)(?<unitType>[a-z%]+)$/i\n      );\n\n      /* \n       \n        REGARDING ABOVE                                                         \n                                                                                    \n        Use ES2018 named match groups syntax to extract CSS variable values.        \n                                                                                    \n        (\\d+(\\.\\d+)?) matches any number of digits as  (primary capturing group)    \n                                                                                    \n        This is followed by an optional subgroup (\\.\\d+) for a decimal point        \n        and fractional                                                              \n        digits.                                                                     \n                                                                                    \n        This allows the entire first capturing group (\\d+(\\.\\d+)?) to match          \n        integers or floating-point                                                   \n        numbers.                                                                    \n                                                                                      \n        The ?<numberValue> syntax names the capturing group, storing it in          \n        `match.groups` for easy                                                     \n        access.                                                                     \n                                                                                      \n        This is destructured to extract potential floating-point numbers             \n        representing the ship's border                                              \n        size.                                                                       \n                                                                                    \n        The script dynamically updates the border size by reading the value         \n        directly from the SCSS                                                      \n        file.                                                                        \n                                                                                      \n        Currently, it only supports border sizes specified in pixels, but            \n        the `unitType` match group could be used to support other unit types        \n        in the future.                                                              \n                                                                                      \n        I don't feel like doing all that right now.                                |\n       \n      */\n\n      if (!match || !match.groups)\n        throw new Error('No matches found when parsing');\n\n      const shipBorderValueSplit = match.groups as ShipBorderValueSplit;\n\n      dragState.shipBorderValueSplit = shipBorderValueSplit;\n\n      const isHorizontal: boolean = orientation === 'horizontal';\n\n      const [offsetX, offsetY] = isHorizontal\n        ? [\n            shipBow.getBoundingClientRect().width / 2,\n            shipBow.getBoundingClientRect().height / 2 +\n              Number(shipBorderValueSplit.numberValue),\n          ]\n        : [\n            shipBow.getBoundingClientRect().width / 2 +\n              Number(shipBorderValueSplit.numberValue),\n            shipBow.getBoundingClientRect().height / 2,\n          ];\n\n      const cloneSnapOffset: CloneSnapOffset = {\n        offsetX,\n        offsetY,\n      };\n\n      return cloneSnapOffset;\n    };\n    const classifyValidCellCoordinates = (\n      boardContainer: HTMLElement,\n      shipContainerElement: HTMLDivElement,\n      orientation: Orientation,\n      gameboardController: BattleshipBoardController\n    ): void => {\n      const shipLengthAttr: number | null = Number(\n        shipContainerElement.getAttribute('data-length')\n      );\n      if (!shipLengthAttr || !isShipLength(shipLengthAttr)) {\n        throw new Error('Invalid or missing ship type attribute.');\n      }\n\n      const classifyValidBowCells = (\n        gridCells: NodeListOf<HTMLDivElement>,\n        shipLength: ShipLength,\n        orientation: Orientation\n      ) => {\n        const allValidBowCoordinates: Set<Coordinates> =\n          gameboardController.getAllValidBowCoordinates(\n            orientation,\n            shipLength\n          );\n\n        gridCells.forEach((gridCell: HTMLDivElement) => {\n          const gridCellCoordinates: Coordinates = [\n            Number(gridCell.getAttribute('data-x')),\n            Number(gridCell.getAttribute('data-y')),\n          ];\n\n          for (const validBowCoordinates of allValidBowCoordinates) {\n            if (!areArraysEqual(validBowCoordinates, gridCellCoordinates))\n              continue;\n            gridCell.classList.add('valid-bow-coordinates');\n          }\n        });\n      };\n\n      const shipLength: ShipLength = shipLengthAttr;\n\n      const gridCells: NodeListOf<HTMLDivElement> =\n        boardContainer.querySelectorAll('.grid-cell');\n\n      classifyValidBowCells(gridCells, shipLength, orientation);\n    };\n    const updateDragState = (\n      dragState: DragState,\n      fleet: Fleet,\n      shipType: ShipType,\n      cloneSnapOffset: CloneSnapOffset\n    ) => {\n      // Ensure the ship type exists in the fleet\n      if (!fleet[shipType])\n        throw new Error(`The ${shipType} is not present in the fleet.`);\n\n      // Set the current ship instance and its initial configurations\n      dragState.currentShipInstance = fleet[shipType];\n      dragState.initialPlacementConfigurations =\n        dragState.currentShipInstance.currentplacementConfigurations;\n      dragState.cloneSnapOffset = cloneSnapOffset;\n    };\n\n    const shipContainerElement: HTMLDivElement = e.target;\n    const orientation: Orientation = getConvertedTypeFromAttr(\n      shipContainerElement,\n      'data-orientation',\n      isOrientation\n    );\n\n    const fleet: Fleet = this.playerState.fleetBuilder.fleet;\n    const shipType: ShipType = getConvertedTypeFromAttr(\n      shipContainerElement,\n      'data-shiptype',\n      isShipType\n    );\n\n    const cloneSnapOffset: CloneSnapOffset = getCloneSnapOffset(\n      shipContainerElement,\n      orientation,\n      dragState\n    );\n\n    updateDragState(dragState, fleet, shipType, cloneSnapOffset);\n\n    if (!dragState.currentShipInstance)\n      throw new Error(\n        `Drag state hasn't been updated with the current ship instance on drag start. Drag State: ${JSON.stringify(\n          dragState\n        )}`\n      );\n\n    // Remove the piece from the gameboard (non-null ensured by `setUpShipForDrag`)\n    this.playerState.gameboardController.removePiece(\n      dragState.currentShipInstance\n    );\n\n    // Set drag image to be transparent 1 x 1 png\n    e.dataTransfer?.setDragImage(this.dragImage, 0, 0);\n\n    setCloneDimensions(shipContainerElement, this.shipDragClone);\n    setInitialDragStyles(shipContainerElement);\n    classifyValidCellCoordinates(\n      this.gameboardContainer,\n      shipContainerElement,\n      orientation,\n      this.playerState.gameboardController\n    );\n    this.snapCloneToCursor(e, cloneSnapOffset);\n  }\n\n  private handleShipDrag(e: DragEvent, dragState: DragState) {\n    if (\n      !(e.target instanceof HTMLDivElement) ||\n      !e.target.matches('.ship-container')\n    )\n      return;\n\n    const cloneSnapOffset: CloneSnapOffset | null = dragState.cloneSnapOffset;\n\n    if (!cloneSnapOffset)\n      throw new Error(\n        'An error has occured during the `cloneSnapOffset` reading.'\n      );\n\n    this.snapCloneToCursor(e, cloneSnapOffset);\n  }\n\n  private handleShipDragEnter(e: DragEvent) {\n    if (\n      !(e.target instanceof HTMLDivElement) ||\n      !e.target.matches('.grid-cell')\n    )\n      return;\n\n    const gridCell: HTMLDivElement = e.target;\n\n    // Check if current grid cell is valid for placement\n    const areValidBowCoordinates: boolean = gridCell.classList.contains(\n      'valid-bow-coordinates'\n    );\n\n    // Add appropriate visual feedback class to grid cell\n    areValidBowCoordinates\n      ? gridCell.classList.add('placement-is-valid')\n      : gridCell.classList.add('placement-is-invalid');\n\n    // Add appropriate visual feedback class to ship drag clone\n    if (areValidBowCoordinates)\n      this.shipDragClone.classList.add('placement-is-valid');\n  }\n\n  private handleShipDragLeave(e: DragEvent) {\n    if (\n      !(e.target instanceof HTMLDivElement) ||\n      !e.target.matches('.grid-cell')\n    )\n      return;\n\n    const gridCell: HTMLDivElement = e.target;\n\n    const areValidBowCoordinates: boolean =\n      gridCell.classList.contains('placement-is-valid');\n\n    // Remove assigned visual feedback class from grid cell\n    areValidBowCoordinates\n      ? gridCell.classList.remove('placement-is-valid')\n      : gridCell.classList.remove('placement-is-invalid');\n\n    // Remove assigned visual feedback class from ship drag clone\n    if (this.shipDragClone.classList.contains('placement-is-valid'))\n      this.shipDragClone.classList.remove('placement-is-valid');\n  }\n\n  private handleShipDragOver(e: DragEvent, dragState: DragState) {\n    // Enables the drop event to fire\n    e.preventDefault();\n\n    if (\n      !(e.target instanceof HTMLDivElement) ||\n      !e.target.matches('.grid-cell')\n    )\n      return;\n\n    const gridCell: HTMLDivElement = e.target;\n\n    // Update drag state for cleanup\n    dragState.currentDragOverCell = gridCell;\n\n    // Prevent further operations for invalid cells\n    if (!gridCell.classList.contains('valid-bow-coordinates')) return;\n  }\n\n  private handleShipDrop(e: DragEvent, dragState: DragState) {\n    e.preventDefault();\n\n    if (\n      !(e.target instanceof HTMLDivElement) ||\n      !e.target.matches('.valid-bow-coordinates')\n    )\n      return;\n\n    // Validate and modify state\n    const { coordinatesArray, orientation: initialOrientation } =\n      dragState.initialPlacementConfigurations || {};\n\n    if (!coordinatesArray || !initialOrientation) {\n      throw new Error('Initial placement configurations are incomplete.');\n    }\n\n    dragState.isValidDropTarget = true;\n\n    const validGridCell: HTMLDivElement = e.target;\n\n    // Retrieve new coordinates from the valid grid cell\n    const xAttr = validGridCell.getAttribute('data-x');\n    const yAttr = validGridCell.getAttribute('data-y');\n    if (!xAttr || !yAttr) {\n      throw new Error('Missing or invalid grid cell coordinates.');\n    }\n    const newCoordinates: Coordinates = [Number(xAttr), Number(yAttr)];\n\n    this.playerState.gameboardController.placePiece({\n      ship: dragState.currentShipInstance!,\n      coordinates: newCoordinates,\n      orientation: initialOrientation,\n    });\n\n    // Re-renders board with new ship placement\n    this.refreshGameboard(this.gameboardContainer);\n\n    // Reset valid drop target state\n    dragState.isValidDropTarget = false;\n  }\n\n  private handleShipDragEnd(e: DragEvent, dragState: DragState) {\n    if (\n      !(e.target instanceof HTMLDivElement) ||\n      !e.target.matches('.ship-container')\n    )\n      return;\n\n    const resetShipPosition = (): void => {\n      const { coordinatesArray, orientation: initialOrientation } =\n        dragState.initialPlacementConfigurations || {};\n      if (!coordinatesArray || !initialOrientation) {\n        throw new Error('Initial placement configurations are incomplete.');\n      }\n\n      // Get bow coordinates\n      const initialBowCoordinates: Coordinates = coordinatesArray[0];\n\n      // Re-place ship on logic gameboard\n      this.playerState.gameboardController.placePiece({\n        ship: dragState.currentShipInstance!,\n        coordinates: initialBowCoordinates,\n        orientation: initialOrientation,\n      });\n    };\n\n    const removeDragStyles = (\n      shipContainerElement: HTMLDivElement,\n      currentDragOverCell: HTMLDivElement,\n      isValidDropTarget: boolean\n    ): void => {\n      const cellFeedbackClass: string = isValidDropTarget\n        ? 'placement-is-valid'\n        : 'placement-is-invalid';\n\n      // Set dragging attribute to false\n      shipContainerElement.setAttribute('data-dragging', 'false');\n\n      // Lower grid cell validation pseudo-element opacity\n      currentDragOverCell.classList.remove(cellFeedbackClass);\n\n      // Re-hide drag clone\n      this.shipDragClone.classList.remove('visible');\n\n      // Restore ship container draggability\n      shipContainerElement.classList.remove('locked');\n    };\n\n    const shipContainerElement: HTMLDivElement = e.target;\n\n    try {\n      const { currentDragOverCell, isValidDropTarget } = dragState;\n\n      if (!currentDragOverCell)\n        throw new Error(\n          `Current drag over cell is missing. Drag state: ${JSON.stringify(\n            dragState\n          )}`\n        );\n\n      removeDragStyles(\n        shipContainerElement,\n        currentDragOverCell,\n        isValidDropTarget\n      );\n\n      if (!isValidDropTarget) {\n        resetShipPosition();\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  private handleShipRotation = (e: MouseEvent) => {\n    if (\n      !(e.target instanceof HTMLDivElement) ||\n      !e.target.matches('.ship-container')\n    )\n      return;\n\n    const shipContainerElement: HTMLDivElement = e.target;\n\n    const shipType: ShipType = getConvertedTypeFromAttr(\n      shipContainerElement,\n      'data-shiptype',\n      isShipType\n    );\n\n    const ship = this.playerState.fleetBuilder.getShip(shipType);\n\n    this.playerState.gameboardController.rotatePiece(ship);\n    this.refreshGameboard(this.gameboardContainer);\n  };\n\n  private snapCloneToCursor(\n    e: DragEvent,\n    cloneSnapOffset: CloneSnapOffset\n  ): void {\n    const gameboardClientRect: DOMRect =\n      this.gameboardContainer.getBoundingClientRect();\n    const gameboardOffsetX: number = gameboardClientRect.left;\n    const gameboardOffsetY: number = gameboardClientRect.top;\n\n    const cursorX: number = e.clientX;\n    const cursorY: number = e.clientY;\n\n    const { offsetX, offsetY }: CloneSnapOffset = cloneSnapOffset;\n\n    document.documentElement.style.setProperty(\n      '--ship-clone-left',\n      `${cursorX - gameboardOffsetX - offsetX}px`\n    );\n\n    document.documentElement.style.setProperty(\n      '--ship-clone-top',\n      `${cursorY - gameboardOffsetY - offsetY}px`\n    );\n  }\n\n  //  -------------------------------------------------------------\n  // -\n\n  //  --------------------------------------------------------------\n  //  Utilities\n\n  // TODO: Do I need this\n  public getId(): string {\n    return this.id;\n  }\n}\n","import {\n  Coordinates,\n  CoordinatesArray,\n  Fleet,\n  Gameboard,\n  Orientation,\n  ShipLength,\n  ShipSymbolValue,\n  ShipSymbolValueArray,\n  ShipType,\n} from '../../../../types/logic-types';\nimport {\n  capitalize,\n  createElement,\n  waitForTransitionEnd,\n  waitForEvent,\n  sleep,\n} from '../../../../utilities/random-utilities';\nimport { AttackResult, PlayerContext, gameboardStateValue } from '../../../../types/state-types';\nimport '../gameboard-component.scss';\nimport '../gameboard-animations.scss';\n\nimport { isShipType } from '../../../../types/type-guards';\nimport { BattleshipBuilder } from '../../../../logic/bs-ship-builder/bs-ship-builder';\nimport { GridPlacementValue } from '../../../../types/css-types';\nimport { BattleshipFleetBuilder } from '../../../../logic/bs-fleet-builder/bs-fleet-builder';\nimport { GameState } from '../../../../state/game-state';\n\nexport class OpponentGameboardComponent {\n  private readonly id: string = 'opponent';\n\n  private gameboardContainer: HTMLDivElement;\n  private fleetElements: Map<ShipType, HTMLDivElement> = new Map();\n\n  constructor(\n    public readonly playerState: PlayerContext,\n    private readonly gameState: GameState\n  ) {\n    this.gameboardContainer = this.generateBoardContainer(\n      this.playerState.gameboardBuilder.boardSize\n    );\n\n    this.updateFleetElements(this.playerState.fleetBuilder);\n\n    this.gameState.eventBus.on(\n      'toggleOpponentGameboardControls',\n      this.toggleGameboardControls\n    );\n  }\n\n  public render(targetElement: HTMLElement): void {\n    if (!targetElement) {\n      throw new Error(\n        `Target element not found with ID - ${this.id} and selector - \"${targetElement}\".`\n      );\n    }\n\n    const gameboard: DocumentFragment = this.generateBoardFragment(\n      this.playerState.gameboardBuilder.boardSize\n    );\n    this.gameboardContainer.appendChild(gameboard);\n\n    this.placeFleetOnGameboard(this.fleetElements);\n\n    targetElement.appendChild(this.gameboardContainer);\n  }\n\n  public toggleBellumListeners = (\n    newGameboardState: gameboardStateValue\n  ): void => {\n    if (!this.gameboardContainer) return;\n\n    const method =\n      newGameboardState === gameboardStateValue.inactive\n        ? 'removeEventListener'\n        : 'addEventListener';\n\n    this.gameboardContainer[method](\n      'click',\n      this.handleCellClick as EventListener\n    );\n  };\n\n  //  --------------------------------------------------------------\n  //  Helpers\n\n  private isGameOver(): boolean {\n    return this.playerState.gameboardRepository.areAllShipsSunk();\n  }\n\n  private async cookAllShipUnits(\n    shipContainerElement: HTMLDivElement\n  ): Promise<void> {\n    const shipUnits = Array.from(\n      shipContainerElement.children\n    ) as HTMLElement[];\n\n    // Stagger animations\n    shipUnits.forEach((unit, i) => {\n      setTimeout(() => {\n        unit.classList.add('cooked');\n      }, 333 * (i + 1));\n    });\n\n    const lastUnit = shipUnits[shipUnits.length - 1];\n\n    // '1600' + 100ms after transition end in main.scss (1.5s)\n    await waitForTransitionEnd(lastUnit, 999);\n    await sleep(1000);\n  }\n\n  private createBackgroundCellsFragment(\n    gameboard: Gameboard\n  ): DocumentFragment {\n    const cellFragment: DocumentFragment = new DocumentFragment();\n\n    gameboard.forEach((row: ShipSymbolValueArray, rowIndex: number) => {\n      // ? The ship symbol value isn't used to classify opponent board grid cells,\n      // ? otherwise players could inspect dev tools and see where the opponent's ships are.\n      row.forEach((_: ShipSymbolValue, colIndex: number) => {\n        const hitMarker: HTMLDivElement = createElement('div', [\n          `${this.id}-hit-marker`,\n          'hit-marker',\n        ]);\n\n        const gridCell: HTMLDivElement = createElement(\n          'div',\n          [`${this.id}-grid-cell`, 'grid-cell'],\n          {\n            'data-x': colIndex.toString(),\n            'data-y': rowIndex.toString(),\n            'aria-label': `Row ${rowIndex + 1}, Column ${colIndex + 1}`,\n            role: 'gridCell',\n          }\n        );\n        gridCell.appendChild(hitMarker);\n\n        const gridCellContainer: HTMLDivElement = createElement('div', [\n          `${this.id}-grid-cell-container`,\n          'grid-cell-container',\n        ]);\n        gridCellContainer.appendChild(gridCell);\n        cellFragment.appendChild(gridCellContainer);\n      });\n    });\n\n    return cellFragment;\n  }\n\n  private createShipElement(\n    shipType: ShipType,\n    shipLength: ShipLength,\n    orientation: Orientation\n  ): HTMLDivElement {\n    const shipUnitFragment: DocumentFragment = this.generateShipUnitFragment(\n      shipLength,\n      shipType,\n      orientation,\n      this.id\n    );\n\n    const shipContainerElement: HTMLDivElement = createElement(\n      'div',\n      ['ship-container', 'opponent-ship-container'],\n      {\n        id: `${this.id}-${shipType}-container`,\n      }\n    );\n    shipContainerElement.appendChild(shipUnitFragment);\n\n    return shipContainerElement;\n  }\n\n  private generateBoardContainer(boardSize: number): HTMLDivElement {\n    const gameboardContainer: HTMLDivElement = createElement(\n      'div',\n      ['gameboard-container', 'locked'],\n      {\n        id: `${this.id}-gameboard-container`,\n      }\n    );\n\n    gameboardContainer.style.setProperty('--grid-size', boardSize.toString());\n\n    return gameboardContainer;\n  }\n\n  private generateBoardFragment(boardSize: number): DocumentFragment {\n    const gameboardBackground: HTMLDivElement = createElement(\n      'div',\n      ['gameboard-background'],\n      {\n        id: `${this.id}-gameboard-background`,\n      }\n    );\n    gameboardBackground.appendChild(\n      this.createBackgroundCellsFragment(\n        this.playerState.gameboardBuilder.board\n      )\n    );\n\n    const gameboard = createElement('div', ['gameboard'], {\n      id: `${this.id}-gameboard`,\n    });\n    gameboard.style.setProperty('--grid-size', boardSize.toString());\n\n    this.fleetElements.forEach((shipContainerElement) => {\n      gameboard.appendChild(shipContainerElement);\n    });\n\n    const boardFragment: DocumentFragment = new DocumentFragment();\n    boardFragment.append(gameboardBackground, gameboard);\n\n    return boardFragment;\n  }\n\n  private generateShipUnitFragment(\n    shipLength: ShipLength,\n    shipType: ShipType,\n    orientation: Orientation,\n    id: string\n  ): DocumentFragment {\n    const shipUnitFragment: DocumentFragment = new DocumentFragment();\n\n    for (let i = 0; i < shipLength; i++) {\n      const isBow: boolean = i === 0;\n      const isStern: boolean = i === shipLength - 1;\n      const shipUnit: HTMLDivElement = createElement('div', [\n        'ship-unit',\n        `${shipType}-unit`,\n        `${id}-${shipType}-unit`,\n      ]);\n\n      const isHorizontal: boolean = orientation === 'horizontal';\n\n      isHorizontal\n        ? shipUnit.classList.add('ship-unit-horizontal')\n        : shipUnit.classList.add('ship-unit-vertical');\n\n      if (isBow) {\n        shipUnit.classList.add('ship-bow');\n        shipUnit.setAttribute('id', `${id}-${shipType}-bow`);\n      }\n\n      if (isStern) {\n        shipUnit.classList.add('ship-stern');\n        shipUnit.setAttribute('id', `${id}-${shipType}-stern`);\n      }\n\n      shipUnitFragment.appendChild(shipUnit);\n    }\n\n    return shipUnitFragment;\n  }\n\n  private getAttackCoordinates(gridCell: HTMLDivElement): Coordinates {\n    const dataX = gridCell.getAttribute('data-x');\n    const dataY = gridCell.getAttribute('data-y');\n\n    if (dataX == null || dataY == null) {\n      throw new Error('Could not retrieve coordinates from grid cell.');\n    }\n\n    return [+dataX, +dataY];\n  }\n\n  private getGridAreaValue(\n    coordinates: Coordinates,\n    orientation: Orientation,\n    shipLength: ShipLength\n  ): [GridPlacementValue, number] {\n    const isHorizontal = orientation === 'horizontal';\n\n    const [x, y] = coordinates;\n    const gridStartMain = isHorizontal ? x + 1 : y + 1;\n    const gridCrossAxis = isHorizontal ? y + 1 : x + 1;\n\n    return [`${gridStartMain} / span ${shipLength}`, gridCrossAxis];\n  }\n\n  // TODO: create return signature type\n  private getShipPlacementData(shipType: ShipType): {\n    bowCoordinates: Coordinates;\n    orientation: Orientation;\n    shipLength: ShipLength;\n  } {\n    const ship: BattleshipBuilder =\n      this.playerState.fleetBuilder.getShip(shipType);\n\n    const { coordinatesArray, orientation } =\n      ship.currentplacementConfigurations;\n\n    if (!coordinatesArray || !orientation) {\n      throw new Error(`The ${ship.type} has no placement configurations.`);\n    }\n\n    return {\n      bowCoordinates: coordinatesArray[0],\n      orientation,\n      shipLength: ship.length,\n    };\n  }\n\n  private handleCellClick = (e: MouseEvent): void => {\n    this.receiveAttack(e);\n  };\n\n  private async handleSinkingShip(shipType: ShipType): Promise<void> {\n    // retreives ship placement data from logic layer\n    const { bowCoordinates, orientation, shipLength } =\n      this.getShipPlacementData(shipType);\n\n    const shipContainerElement = this.fleetElements.get(shipType);\n\n    if (!shipContainerElement) {\n      throw new Error(\n        `The ${capitalize(shipType)}'s ship container element not found.`\n      );\n    }\n\n    this.revealShipPosition(\n      shipContainerElement,\n      bowCoordinates,\n      orientation,\n      shipLength\n    );\n\n    await this.sinkShip(shipContainerElement);\n  }\n\n  private hasTargetBeenAttacked(coordinates: Coordinates): boolean {\n    const alreadyAttacked =\n      this.playerState.gameboardRepository.hasTargetBeenAttacked(coordinates);\n\n    if (!alreadyAttacked) {\n      this.playerState.gameboardRepository.addAttackedCoordinates(coordinates);\n    }\n\n    return alreadyAttacked;\n  }\n\n  private placeFleetOnGameboard(\n    fleetElements: Map<ShipType, HTMLDivElement>\n  ): void {\n    const gameboard =\n      this.gameboardContainer.querySelector<HTMLDivElement>('.gameboard');\n\n    if (!gameboard) {\n      throw new Error('Gameboard container not found.');\n    }\n\n    fleetElements.forEach((shipElement) => gameboard.appendChild(shipElement));\n  }\n\n  private revealShipPosition(\n    shipContainerElement: HTMLDivElement,\n    bowCoordinates: Coordinates,\n    orientation: Orientation,\n    shipLength: ShipLength\n  ): void {\n    const [gridPlacementValue, gridCrossAxis]: [GridPlacementValue, number] =\n      this.getGridAreaValue(bowCoordinates, orientation, shipLength);\n\n    this.setGridPlacementValue(\n      gridPlacementValue,\n      gridCrossAxis,\n      shipContainerElement,\n      orientation,\n      shipLength\n    );\n  }\n\n  private async receiveAttack(e: MouseEvent): Promise<void> {\n    if (\n      !(e.target instanceof HTMLDivElement) ||\n      !e.target.matches('.grid-cell')\n    )\n      return;\n\n    const gridCell: HTMLDivElement = e.target;\n\n    const attackCoordinates: Coordinates = this.getAttackCoordinates(gridCell);\n\n    if (this.hasTargetBeenAttacked(attackCoordinates)) {\n      // TODO: Add a flash animation to indicate \"Cell already attacked\".\n      return;\n    }\n\n    this.toggleBellumListeners(gameboardStateValue.inactive);\n    this.toggleGameboardControls(gameboardStateValue.inactive);\n\n    const attackResult: AttackResult =\n      this.playerState.gameboardController.receiveAttack(attackCoordinates);\n\n    try {\n      await this.triggerPrePlayerToggleAnimations(attackResult, gridCell);\n    } catch (error) {\n      console.error('Animation failed', error);\n    }\n\n    this.togglePlayerTurn(attackResult);\n  }\n\n  private setGridPlacementValue(\n    gridPlacementValue: GridPlacementValue,\n    gridCrossAxis: number,\n    shipContainerElement: HTMLDivElement,\n    orientation: Orientation,\n    shipLength: ShipLength\n  ): void {\n    const isHorizontal: boolean = orientation === 'horizontal';\n    if (isHorizontal) {\n      shipContainerElement.style.gridColumn = gridPlacementValue;\n      shipContainerElement.style.gridRow = gridCrossAxis.toString();\n      shipContainerElement.style.gridTemplateColumns = `repeat(${shipLength}, 1fr)`;\n    } else {\n      shipContainerElement.style.gridRow = gridPlacementValue;\n      shipContainerElement.style.gridColumn = gridCrossAxis.toString();\n      shipContainerElement.style.gridTemplateRows = `repeat(${shipLength}, 1fr)`;\n    }\n  }\n\n  private sinkShip = async (\n    shipContainerElement: HTMLDivElement\n  ): Promise<void> => {\n    const DELAY_AFTER_TRANSITION_SECOND: number = 1;\n\n    shipContainerElement.classList.add('sunk');\n\n    await waitForEvent(shipContainerElement, 'animationend');\n\n    // ? When unifying gameboard component modules, this will only be called if\n    // ? the sunken ship is on opponent gameboard. All other logic is equivalent.\n    await this.cookAllShipUnits(shipContainerElement); \n\n    await sleep(DELAY_AFTER_TRANSITION_SECOND * 1000);\n  };\n\n  private toggleGameboardControls = (\n    newGameboardState: gameboardStateValue\n  ): void => {\n    if (newGameboardState === gameboardStateValue.active) {\n      this.toggleBellumListeners(newGameboardState);\n    }\n\n    this.gameboardContainer.classList.toggle(\n      'locked',\n      newGameboardState === gameboardStateValue.inactive\n    );\n  };\n\n  private togglePlayerTurn(attackResult: AttackResult): void {\n    const { hit, isSunk } = attackResult;\n\n    if ((hit && !isSunk) || !hit) {\n      this.gameState.togglePlayerTurn();\n      return;\n    }\n\n    if (hit && isSunk) {\n      const isGameOver = this.isGameOver();\n      if (!isGameOver) {\n        this.gameState.togglePlayerTurn();\n        return;\n      }\n\n      this.toggleBellumListeners(gameboardStateValue.inactive);\n      this.gameState.eventBus.emit('updateVictoryBannerText', 'You Win!');\n      this.gameState.transitionToNextPhase();\n    }\n  }\n\n  private triggerPrePlayerToggleAnimations = async (\n    attackResult: AttackResult,\n    gridCell: HTMLDivElement\n  ): Promise<void> => {\n    const uiUpdate = this.updateUIPostAttack(attackResult, gridCell);\n    const sitRepUpdate = this.gameState.eventBus.emit(\n      'setAndScrollToNextSitRep',\n      attackResult\n    );\n\n    await Promise.all([uiUpdate, sitRepUpdate]);\n  };\n\n  private updateFleetElements(fleetBuilder: BattleshipFleetBuilder): void {\n    const fleet: Fleet = fleetBuilder.fleet;\n\n    for (const ship of Object.values(fleet)) {\n      const shipType: ShipType = ship.type;\n      const shipLength: ShipLength = ship.length;\n\n      const orientation: Orientation | null =\n        ship.currentplacementConfigurations.orientation;\n\n      if (!orientation) throw new Error('Orientation not set.');\n\n      const coordinatesArray: CoordinatesArray | null =\n        ship.currentplacementConfigurations.coordinatesArray;\n\n      if (!coordinatesArray || coordinatesArray.length === 0) {\n        console.error(`The ${shipType} has not been placed. Continuing...`);\n        continue;\n      }\n\n      const shipContainerElement: HTMLDivElement = this.createShipElement(\n        shipType,\n        shipLength,\n        orientation\n      );\n\n      this.fleetElements.set(shipType, shipContainerElement);\n    }\n  }\n\n  private updateUIPostAttack = async (\n    attackResult: AttackResult,\n    gridCell: HTMLDivElement\n  ): Promise<void> => {\n    const { hit, isSunk, type } = attackResult;\n\n    if (!hit) {\n      gridCell.classList.add('miss');\n      return;\n    }\n\n    if (!isShipType(type))\n      throw new Error(`The ${type} is not a valid ship type.`);\n\n    gridCell.classList.add('hit');\n    this.gameState.eventBus.emit('markNextHitPoint', {\n      playerType: 'opponent',\n      shipType: type,\n    });\n\n    if (!isSunk) return;\n\n    await this.handleSinkingShip(type);\n  };\n\n  //  --------------------------------------------------------------\n  //  Utilities\n\n  // TODO: Do I need this\n  public getId(): string {\n    return this.id;\n  }\n}","import { createElement } from \"../../../utilities/random-utilities\";\n\nimport { PlayerGameboardComponent } from \"../../components/gameboard-component/player-gameboard-component/player-gameboard-component\";\nimport { OpponentGameboardComponent } from \"../../components/gameboard-component/opponent-gameboard-component/opponent-gameboard-component\";\n\nimport { PlayerCore } from \"../../../types/state-types\";\nimport { GameState } from \"../../../state/game-state\";\n\nexport class MainContainerTwo {\n  private readonly mainContainerTwo: HTMLElement;\n\n  private readonly playerGameboardComponent: PlayerGameboardComponent;\n  private readonly opponentGameboardComponent: OpponentGameboardComponent;\n  \n  constructor(\n    private readonly playerCore: PlayerCore,\n    private readonly gameState: GameState \n\n  ) {\n    this.playerGameboardComponent = new PlayerGameboardComponent(\n      this.playerCore.player,\n      this.gameState\n    );\n    this.opponentGameboardComponent = new OpponentGameboardComponent(\n      this.playerCore.opponent,\n      this.gameState\n    );\n\n    this.mainContainerTwo = createElement('section', ['main-container', 'parabellum'], {\n      id: 'main-container-two',\n    });\n  }\n\n  get element() { \n    return this.mainContainerTwo;\n  }\n\n  get playerGameboard() {\n    return this.playerGameboardComponent;\n  }\n\n  get opponentGameboard() {\n    return this.opponentGameboardComponent;\n  }\n\n  render(targetElement: HTMLElement) {\n    this.playerGameboardComponent.render(this.mainContainerTwo);\n    this.opponentGameboardComponent.render(this.mainContainerTwo);\n\n    targetElement.appendChild(this.mainContainerTwo);\n  }\n}\n\n","import {\n  Coordinates,\n  Fleet,\n  IPlacePieceWrapperParams,\n  IShipPlacementConfigurations,\n  Orientation,\n  IPosition,\n  PositionArray,\n  AxisArrayKey,\n} from '../types/logic-types';\nimport {\n  areArraysEqual,\n  getRandomInt,\n} from '../utilities/random-utilities';\nimport { BattleshipBuilder } from '../logic/bs-ship-builder/bs-ship-builder';\nimport { BattleshipBoardController } from '../logic/bs-gameboard-controller/bs-gameboard-controller';\nimport { isShipType } from '../types/type-guards';\n\nexport function randomizeBSGameboard(\n  gameboardController: BattleshipBoardController, fleet: Fleet\n) {\n  if (!gameboardController)\n    throw new Error('Invalid Command: `gameboardController` is required to randomize the gameboard.');\n  if (!fleet)\n    throw new Error('Invalid Command: `fleet` is required to randomize the gameboard.');\n\n  const generateRandomCoordinates = (\n    shipLength: number,\n    boardSize: number\n  ): Coordinates => {\n    const max: number = boardSize - shipLength;\n    const xRandom: number = getRandomInt(0, max);\n    const yRandom: number = getRandomInt(0, max);\n\n    return [xRandom, yRandom];\n  };\n  const generateRandomOrientation = (): Orientation => {\n    return Math.random() < 0.5 ? 'horizontal' : 'vertical';\n  };\n  const areCoordinatesValid = (\n    coordinates: Coordinates,\n    ship: BattleshipBuilder,\n    orientation: Orientation\n  ): boolean => {\n    const validPositionsParams: IShipPlacementConfigurations = {\n      shipLength: ship.length,\n      orientation,\n    };\n\n    const validPositions =\n      gameboardController.getValidPositions(validPositionsParams);\n    const [bowX, bowY]: Coordinates = coordinates;\n    const isHorizontal: boolean = orientation === 'horizontal';\n    const axisIndex: number = isHorizontal ? bowY : bowX;\n\n    const axisArrayKey: AxisArrayKey = isHorizontal\n      ? `row-${axisIndex}`\n      : `column-${axisIndex}`;\n    const axisArray: PositionArray = validPositions[axisArrayKey];\n\n    return axisArray.some((position: IPosition) =>\n      areArraysEqual(position.bow, coordinates)\n    );\n  }; \n  const getValidCoordinatesRecursively = (\n    ship: BattleshipBuilder,\n    orientation: Orientation,\n    boardSize: number,\n    attempts: number = 0\n  ): Coordinates => {\n    if (attempts > 100)\n      throw new Error(`Max recursion depth exceeded when placing the ${ship.type}.`);\n\n    const coordinates: Coordinates = generateRandomCoordinates(\n      ship.length,\n      boardSize\n    );\n\n    return areCoordinatesValid(coordinates, ship, orientation)\n      ? coordinates\n      : getValidCoordinatesRecursively(\n          ship,\n          orientation,\n          boardSize,\n          attempts + 1\n        )\n  };\n\n  const boardSize: number = 10;\n\n  for (const shipType in fleet) {\n    if (!isShipType(shipType)) throw new Error(`Invalid Type: \"${shipType}\" doesn't conform to \"ShipType\".`);\n\n    const ship: BattleshipBuilder = fleet[shipType]!;\n    const randomOrientation: Orientation = generateRandomOrientation();\n\n    const coordinates: Coordinates = getValidCoordinatesRecursively(\n      ship,\n      randomOrientation,\n      boardSize\n    );\n\n    const placePieceParams: IPlacePieceWrapperParams = {\n      ship,\n      coordinates,\n      orientation: randomOrientation,\n    };\n    \n    gameboardController.placePiece(placePieceParams);\n  }\n}\n","import { BattleshipBoardController } from \"../../../../logic/bs-gameboard-controller/bs-gameboard-controller\";\nimport { createElement } from \"../../../../utilities/random-utilities\";\nimport { Fleet } from \"../../../../types/logic-types\";\nimport { randomizeBSGameboard } from \"../../../../setup/randomize-bs-gameboard\";\nimport './ship-shuffler-component.scss';\nimport { GameState } from \"../../../../state/game-state\";\n\nexport class ShipShufflerButtonComponent {\n  private readonly shipShufflerButton: HTMLButtonElement;\n  private readonly shipShufflerButtonContainer: HTMLDivElement;\n  private readonly shipShufflerButtonTextContent: string = 'Shuffle';\n  private readonly buttonClass: string = 'ship-shuffler-button';\n\n  #listenerAttached: boolean = false;\n  private readonly shuffleShips: () => void = () => {\n    this.randomizeGameboard();\n    this.updateGameboard();\n  };\n\n  constructor(\n    private id: string,\n    // private gameboardContainer: HTMLElement, // TODO: do i need this?\n    private gameboardController: BattleshipBoardController,\n    private fleet: Fleet,\n    private gameState: GameState\n  ) {\n    this.shipShufflerButton = this.createshipShufflerButton(\n      `${this.id}-${this.buttonClass}`,\n      [this.buttonClass]\n    );\n    this.shipShufflerButton.classList.add(this.buttonClass);\n    this.shipShufflerButton.textContent = this.shipShufflerButtonTextContent;\n    this.toggleEventListener();\n\n    this.shipShufflerButtonContainer = this.createshipShufflerButtonContainer();\n    this.shipShufflerButtonContainer.appendChild(this.shipShufflerButton);\n  }\n\n  public render(targetElement: HTMLElement) {\n    if (!targetElement) {\n      throw new Error(`Target element not found. Recieved ${targetElement}.`);\n    }\n\n    targetElement.appendChild(this.shipShufflerButtonContainer);\n  }\n\n  public toggleEventListener() {\n    if (this.#listenerAttached === true) {\n      this.shipShufflerButton.removeEventListener('click', this.shuffleShips)\n      this.#listenerAttached = false;\n    } else {\n      this.shipShufflerButton.addEventListener('click', this.shuffleShips);\n      this.#listenerAttached = true;\n    }\n  }\n\n  //  --------------------------------------------------------------\n  //  Helpers\n\n  private createshipShufflerButton(\n    id: string,\n    classes: string[]\n  ): HTMLButtonElement {\n    const button: HTMLButtonElement = createElement('button', [...classes], {\n      id,\n    });\n    return button;\n  }\n\n  private createshipShufflerButtonContainer(): HTMLDivElement {\n    const container: HTMLDivElement = createElement('div', [\n      'ship-shuffler-button-container',\n    ]);\n    return container;\n  }\n\n  private randomizeGameboard() {\n    this.gameboardController.removeAllPieces(this.fleet);\n    randomizeBSGameboard(this.gameboardController, this.fleet);\n  }\n\n  private updateGameboard(): void {\n    this.gameState.eventBus.emit('refreshGameboard');\n  }\n\n  //  --------------------------------------------------------------\n  //  Utilities\n\n  public getId() {\n    return this.id;\n  }\n}","import { createElement } from \"../../../../utilities/random-utilities\";\nimport { PlayerGameboardComponent } from \"../../gameboard-component/player-gameboard-component/player-gameboard-component\";\nimport { InstructionsComponent } from \"../instructions-component/instructions-component\";\nimport { ShipShufflerButtonComponent } from \"../ship-shuffler-component/ship-shuffler-component\";\nimport './ready-up-component.scss';\n\nexport class ReadyUpButtonComponent {\n  private readonly readyUpButton: HTMLButtonElement;\n  private readonly readyUpButtonContainer: HTMLDivElement;\n  private readonly readyUpButtonTextContent: string = 'Ready Up';\n  private readonly buttonId: string = 'ready-up-button';\n\n  #listenerAttached: boolean = false;\n\n  private readonly readyUp: () => void = () => {\n    this.anchorShips();\n    this.removeParabellumButtonListeners();\n    this.transitionToBellum(); \n  };\n\n  constructor(\n    private playerGameboardComponent: PlayerGameboardComponent,\n    private shipShufflerButton: ShipShufflerButtonComponent,\n    private instructionsButton: InstructionsComponent,\n    private transitionToNextPhase: () => void\n  ) {\n    this.readyUpButton = this.createReadyUpButton(this.buttonId);\n\n    this.toggleEventListener();\n\n    this.readyUpButtonContainer = this.createReadyUpButtonContainer();\n    this.readyUpButtonContainer.appendChild(this.readyUpButton);\n  }\n\n  public render(targetElement: HTMLElement) {\n    if (!targetElement) {\n      throw new Error(`Target element not found. Recieved ${targetElement}.`);\n    }\n\n    targetElement.appendChild(this.readyUpButtonContainer);\n  }\n\n  public toggleEventListener() {\n    if (this.#listenerAttached === true) {\n      this.readyUpButton.removeEventListener('click', this.readyUp);\n      this.#listenerAttached = false;\n    } else {\n      this.readyUpButton.addEventListener('click', this.readyUp);\n      this.#listenerAttached = true;\n    }\n  }\n\n  //  --------------------------------------------------------------\n\n  private anchorShips() {\n    // remove event listners from gameboard\n    this.playerGameboardComponent.toggleParabellumListeners();\n\n    // remove draggable attribute from ships\n    this.playerGameboardComponent.toggleShipsDraggable();\n\n    // remove `adrift` class from ship containers\n    this.playerGameboardComponent.toggleShipAdriftClass();\n  }\n\n  private createReadyUpButton(id: string): HTMLButtonElement {\n    const readyUpTextSpan = createElement('span', ['ready-up-button-text']);\n    readyUpTextSpan.textContent = this.readyUpButtonTextContent;\n\n    const inactiveReadyUpButton = createElement(\n      'img',\n      ['inactive-ready-up-button'],\n      {\n        alt: 'Ready Up (Inactive)',\n        src: 'https://cyclone-studios.s3.us-east-2.amazonaws.com/s3_cyclone-studios/assets/images/big-red-button/btn-inactive.svg',\n      }\n    );\n\n    const activeReadyUpButton = createElement(\n      'img',\n      ['active-ready-up-button'],\n      {\n        alt: 'Ready Up (Active)',\n        src: 'https://cyclone-studios.s3.us-east-2.amazonaws.com/s3_cyclone-studios/assets/images/big-red-button/btn-active.svg',\n      }\n    );\n\n    const button: HTMLButtonElement = createElement('button', [], {\n      id,\n    });\n    button.append(activeReadyUpButton, inactiveReadyUpButton, readyUpTextSpan);\n\n    return button;\n  }\n\n  private createReadyUpButtonContainer(): HTMLDivElement {\n    const container: HTMLDivElement = createElement('div', [\n      'ready-up-button-container',\n    ]);\n    return container;\n  }\n\n  private removeParabellumButtonListeners() {\n    this.shipShufflerButton.toggleEventListener();\n    this.instructionsButton.toggleEventListener();\n    this.toggleEventListener();\n  }\n\n  private transitionToBellum() {\n    this.transitionToNextPhase();\n  }\n}","import './score-board-component.scss';\nimport { HitMarkPayload, HitPointMap } from './score-board.types';\n\nimport { GameState } from '../../../state/game-state';\nimport { Fleet, FleetSet, ShipType } from \"../../../types/logic-types\";\nimport { PlayerType } from \"../../../types/state-types\";\nimport { isHTMLDivElement, isPlayerType } from '../../../types/type-guards';\n\nimport { capitalize, createElement } from \"../../../utilities/random-utilities\";\n\nexport class ScoreBoardComponent {\n  private readonly scoreBoardID: string = 'score-board';\n  private readonly scoreBoardContainer: HTMLDivElement;\n  private readonly shipLabelList: HTMLDivElement;\n  private readonly fleetStatusContainers: HTMLDivElement[];\n  public readonly hitPointMap: HitPointMap = {\n    player: {\n      battleship: [],\n      carrier: [],\n      cruiser: [],\n      destroyer: [],\n      patrolBoat: [],\n      submarine: [],\n    },\n    opponent: {\n      battleship: [],\n      carrier: [],\n      cruiser: [],\n      destroyer: [],\n      patrolBoat: [],\n      submarine: [],\n    },\n  };\n\n  constructor(\n    private readonly gameState: GameState,\n    private readonly fleets: FleetSet,\n    private readonly shipTypes: ShipType[],\n  ) {\n    this.fleetStatusContainers = this.createFleetStatusContainers(this.fleets);\n    this.shipLabelList = this.createShipLabelList(this.shipTypes);\n    this.scoreBoardContainer = this.createScoreBoardContainer();\n\n    this.gameState.eventBus.on('markNextHitPoint',this.markNextHitPoint);\n  }\n\n  public render(targetElement: HTMLElement) {\n    if (!targetElement) {\n      throw new Error(`Target element not found. Recieved ${targetElement}.`);\n    }\n\n    const [\n      playerOneFleetStatusContainer,\n      playerTwoFleetStatusContainer,\n    ]: HTMLDivElement[] = this.fleetStatusContainers;\n\n    this.scoreBoardContainer.append(\n      playerOneFleetStatusContainer,\n      this.shipLabelList,\n      playerTwoFleetStatusContainer\n    );\n\n    targetElement.appendChild(this.scoreBoardContainer);\n  }\n\n  private createHitPointContainersFragment(\n    playerType: PlayerType,\n    fleet: Fleet\n  ): DocumentFragment {\n    const hitPointsFragment: DocumentFragment = new DocumentFragment();\n\n    Object.values(fleet).forEach((ship) => {\n      const hitPointContainer: HTMLDivElement = createElement(\n        'div',\n        ['hit-point-container', `${ship.type}-hit-point-container`],\n        {\n          id: `${playerType}-${ship.type}-hit-point-container`,\n        }\n      );\n\n      for (let i = 0; i < ship.length; i++) {\n        const hitpointElement: HTMLDivElement = createElement('div', [\n          'hit-point',\n          `${ship.type}-hit-point`,\n          `${playerType}-${ship.type}-hit-point`,\n        ]);\n\n        hitPointContainer.append(hitpointElement);\n      }\n\n      this.storeShipHitPointData(hitPointContainer, playerType, ship.type);\n\n      hitPointsFragment.appendChild(hitPointContainer);\n    });\n\n    return hitPointsFragment;\n  }\n\n  private createFleetStatusContainer(\n    playerType: PlayerType,\n    fleet: Fleet\n  ): HTMLDivElement {\n    const fleetStatusHeading: HTMLHeadingElement = createElement(\n      'h3',\n      ['fleet-status-heading'],\n      {\n        id: `${playerType}-fleet-status-heading`,\n      }\n    );\n    fleetStatusHeading.textContent = capitalize(playerType);\n\n    const hitPointContainersFragment: DocumentFragment =\n      this.createHitPointContainersFragment(playerType, fleet);\n\n    const fleetStatusContainer: HTMLDivElement = createElement(\n      'div',\n      ['fleet-status-container'],\n      {\n        id: `${playerType}-fleet-status-container`,\n      }\n    );\n    fleetStatusContainer.append(fleetStatusHeading, hitPointContainersFragment);\n\n    return fleetStatusContainer;\n  }\n\n  private createFleetStatusContainers(fleets: FleetSet) {\n    const fleetStatusContainers = Object.entries(fleets).map(\n      ([playerType, fleet]) => {\n        if (!isPlayerType(playerType)) throw new Error('Invalid player type.');\n\n        return this.createFleetStatusContainer(playerType, fleet);\n      }\n    );\n\n    return fleetStatusContainers;\n  }\n\n  private createScoreBoardContainer(): HTMLDivElement {\n    const scoreBoardContainer: HTMLDivElement = createElement('div', [], {\n      id: `${this.scoreBoardID}-container`,\n    });\n\n    return scoreBoardContainer;\n  }\n\n  private createShipLabelList(shipTypes: ShipType[]): HTMLDivElement {\n    const shipLabelListItemsFragment: DocumentFragment = new DocumentFragment();\n    shipTypes.map((shipType) => {\n      const shipLabelListElement = createElement(\n        'li',\n        ['ship-hit-point-label'],\n        { id: `${shipType}-hit-point-label` }\n      );\n      shipLabelListElement.textContent = shipType;\n\n      shipLabelListItemsFragment.appendChild(shipLabelListElement);\n    });\n\n    const shipLabelList: HTMLDivElement = createElement('div', [], {\n      id: 'ship-label-list',\n    });\n    shipLabelList.appendChild(shipLabelListItemsFragment);\n\n    return shipLabelList;\n  }\n\n  private markNextHitPoint = (hitMarkPayload: HitMarkPayload): void => {\n    const { playerType, shipType } = hitMarkPayload;\n\n    if (!this.hitPointMap[playerType]?.[shipType]) {\n      throw new Error(`Missing hit-point data for: ${playerType} - ${shipType}.`);\n    }\n    \n    const nextHitPoint = this.hitPointMap[playerType][shipType].pop();\n    nextHitPoint?.classList.add('hit');\n  }\n\n  private storeShipHitPointData(\n    hitPointContainer: HTMLDivElement,\n    playerType: PlayerType,\n    shipType: ShipType\n  ): void {\n    const reversedHitPointArray = Array.from(\n      hitPointContainer.children\n    ).reverse();\n\n    this.hitPointMap[playerType][shipType] =\n      reversedHitPointArray.filter(isHTMLDivElement);\n  }\n}","import { createElement } from \"../../../utilities/random-utilities\";\nimport { ShipShufflerButtonComponent } from \"../../components/buttons/ship-shuffler-component/ship-shuffler-component\";\nimport { ReadyUpButtonComponent } from \"../../components/buttons/ready-up-component/ready-up-component\";\n\nexport function createMainThreeParabellumFragment(\n  shipShufflerButton: ShipShufflerButtonComponent,\n  readyUpButton: ReadyUpButtonComponent\n): DocumentFragment {  \n  const mainContainerThreeParabellumWrapper: HTMLDivElement = createElement(\n    'div',\n    ['parabellum'],\n    {\n      id: 'main-container-three-parabellum',\n    }\n  );\n  shipShufflerButton.render(mainContainerThreeParabellumWrapper);\n  readyUpButton.render(mainContainerThreeParabellumWrapper);\n\n  const parabellumFragment = new DocumentFragment();\n  parabellumFragment.appendChild(mainContainerThreeParabellumWrapper);\n\n  return parabellumFragment;\n};","import { createElement } from \"../../../utilities/random-utilities\";\nimport { ScoreBoardComponent } from \"../../components/score-board-component/score-board-component\";\n\nexport function createMainThreeBellumFragment(scoreBoard: ScoreBoardComponent): DocumentFragment {\n  const mainContainerThreeBellumWrapper = createElement('div', ['bellum'], {\n    id: 'main-container-three-bellum',\n  });\n  scoreBoard.render(mainContainerThreeBellumWrapper);\n\n  const bellumFragment = new DocumentFragment();\n  bellumFragment.appendChild(mainContainerThreeBellumWrapper);\n\n  return bellumFragment;\n}\n\n","import { createElement } from \"../../../utilities/random-utilities\";\nimport { App } from \"../../../../app\";\n\nexport function createMainThreePostBellumFragment(): DocumentFragment {\n  const playAgainButton = createElement('button', ['end-game-button'], {\n    id: 'play-again-button'\n  });\n  playAgainButton.textContent = 'Play Again'\n  playAgainButton.addEventListener('click', App.pressStart); \n\n  const findNewOpponentButton = createElement('button', ['end-game-button'], {\n    id: 'find-new-opponent-button'\n  });\n  findNewOpponentButton.textContent = 'Find New Opponent';\n  // ? TODO: remove when multiplayer is implemented \n  findNewOpponentButton.setAttribute('disabled', 'true');\n\n  const endGameButtonContainer = createElement('div', [], {\n    id: 'end-game-button-container'\n  });\n  endGameButtonContainer.append(playAgainButton, findNewOpponentButton);\n\n  const mainContainerThreePostBellumWrapper = createElement('div', ['post-bellum'], {\n    id: 'main-container-three-post-bellum',\n  });\n  mainContainerThreePostBellumWrapper.append(endGameButtonContainer);\n\n  const bellumFragment = new DocumentFragment();\n  bellumFragment.appendChild(mainContainerThreePostBellumWrapper);\n\n  return bellumFragment;\n}\n","import {\n  IPlacementConfigurations,\n  IRotationalPivotConfigurations,\n  IShipOptions,\n  ShipLength,\n  ShipSymbols,\n  ShipSymbolValue,\n  ShipType,\n  SizeLookupKey,\n  FleetVersion\n} from '../../types/logic-types';\n\nexport const SHIP_SYMBOLS: ShipSymbols = {\n  [ShipType.Carrier]: Symbol('CA'),\n  [ShipType.Battleship]: Symbol('BS'),\n  [ShipType.Cruiser]: Symbol('CR'),\n  [ShipType.Submarine]: Symbol('SB'),\n  [ShipType.Destroyer]: Symbol('DD'),\n  [ShipType.PatrolBoat]: Symbol('PB')\n} as const;\n\nconst sizeLookup: Record<SizeLookupKey, ShipLength | undefined> = {\n  'battleship-1990': 4,\n  'battleship-2002': 4,\n  'carrier-1990': 5,\n  'carrier-2002': 5,\n  'cruiser-1990': undefined, // Explicitly mark missing values\n  'cruiser-2002': 3,\n  'destroyer-1990': 3,\n  'destroyer-2002': 2,\n  'patrolBoat-1990': 2,\n  'patrolBoat-2002': 2,\n  'submarine-1990': 3,\n  'submarine-2002': 3,\n};\n\nexport class BattleshipBuilder implements IShipOptions {\n  public readonly length: ShipLength;\n  public readonly seaworthy: boolean = true;\n  public readonly symbol: ShipSymbolValue;\n  public rotationalPivotConfigurations: IRotationalPivotConfigurations = {\n    transientAngleOfRotation: null,\n    coordinatesArray: null,\n    orientation: null\n  };\n  public currentplacementConfigurations: IPlacementConfigurations = {\n    coordinatesArray: null,\n    orientation: null\n  };\n  public isPlaced = (): boolean => this.currentplacementConfigurations.coordinatesArray !== null;\n  private _hitCounter: number = 0;\n\n  constructor(public readonly type: ShipType, public readonly version: FleetVersion = 2002) {\n    this.symbol = SHIP_SYMBOLS[type];\n\n    const key: SizeLookupKey = `${type}-${version}`;\n    const length: ShipLength | undefined = sizeLookup[key]; // Access using the typed key\n    if (length === undefined) {\n      throw new Error(`Invalid Command: ship type/version combination: ${key}.`);\n    }\n\n    this.length = length;\n  }\n\n  public hit = (): string => {\n    if (!this.isSeaworthy()) return 'This ship has already perished.';\n    \n    this._hitCounter++;\n    return `Hit registered. Hit count: ${this.hitCounter}.`; // Return the updated hit counter\n  };\n\n  isSeaworthy = (): boolean => this.hitCounter < this.length;\n\n  public resetConfigurations = (shouldResetShipRotationalData: boolean) => {\n    const placementConfigurations = { coordinatesArray: null, orientation: null };\n\n    this.currentplacementConfigurations = placementConfigurations;\n\n    if (shouldResetShipRotationalData === true) {\n      this.rotationalPivotConfigurations = {\n        ...placementConfigurations,\n        transientAngleOfRotation: null\n      };\n    }\n  };\n\n  public get hitCounter(): number {\n    return this._hitCounter;\n  }\n}","import {\n  Fleet,\n  FleetConfigs,\n  ShipType,\n  FleetVersion,\n  getShipTypes,\n} from '../../types/logic-types';\nimport {\n  BattleshipBuilder,\n} from '../bs-ship-builder/bs-ship-builder';\nimport { isShipType } from '../../types/type-guards';\n\nexport class BattleshipFleetBuilder {\n  private constructor(\n    public readonly fleet: Fleet,\n    public readonly version: FleetVersion\n  ) { }\n\n  private static createFleet(fleetConfigs: FleetConfigs): Fleet {\n    const fleet: Fleet = {};\n\n    for (const [shipType, config] of Object.entries(fleetConfigs)) {\n      if (config && isShipType(shipType)) {\n        fleet[shipType] = new BattleshipBuilder(config.type, config.version);\n      }\n    }\n\n    return fleet;\n  }\n\n  public static createHasbroFleet(): BattleshipFleetBuilder {\n    // 2002\n    return new BattleshipFleetBuilder(\n      BattleshipFleetBuilder.createFleet({\n        carrier: { type: ShipType.Carrier, version: 2002 },\n        battleship: { type: ShipType.Battleship, version: 2002 },\n        submarine: { type: ShipType.Submarine, version: 2002 },\n        cruiser: { type: ShipType.Cruiser, version: 2002 },\n        destroyer: { type: ShipType.Destroyer, version: 2002 },\n        patrolBoat: { type: ShipType.PatrolBoat, version: 2002 },\n      }),\n      2002\n    );\n  }\n\n  public static createMBFleet(): BattleshipFleetBuilder {\n    // 1990\n    return new BattleshipFleetBuilder(\n      BattleshipFleetBuilder.createFleet({\n        carrier: { type: ShipType.Carrier, version: 1990 },\n        battleship: { type: ShipType.Battleship, version: 1990 },\n        submarine: { type: ShipType.Submarine, version: 1990 },\n        destroyer: { type: ShipType.Destroyer, version: 1990 },\n        patrolBoat: { type: ShipType.PatrolBoat, version: 1990 },\n      }),\n      1990\n    );\n  }\n\n  public static shipTypes = (version: FleetVersion): ShipType[] =>\n    getShipTypes(version);\n\n  getShip(shipType: ShipType): BattleshipBuilder {\n    const ship = this.fleet[shipType];\n\n    if (!ship) {\n      throw new Error(\n        `Invalid Command: Ship of type ${shipType} not found in fleet.`\n      );\n    }\n\n    return ship;\n  }\n}","//  get details from main one parabellum fragment and render\nimport { createElement } from \"../../../../utilities/random-utilities\";\nimport { CycloneLightboxController } from \"../../../../utilities/cycloneLightbox.ts/cyclone-lightbox\";\nimport './instructions-component.scss';\n\nexport class InstructionsComponent {\n  private readonly instructionsButton: HTMLButtonElement;\n  private readonly instructionsButtonContainer: HTMLDivElement;\n  private readonly buttonId: string = 'instructions-button';\n  private readonly buttonImageId: string = 'instructions-image';\n\n  #listenerAttached: boolean = false;\n  private readonly openInstructionsDialog: () => void;\n\n  constructor(\n    private instructionsLightboxController: CycloneLightboxController\n  ) {\n    this.instructionsButton = this.createInstructionsButton();\n    this.instructionsButtonContainer = this.createInstructionsButtonContainer();\n    this.instructionsButtonContainer.appendChild(this.instructionsButton);\n\n    this.openInstructionsDialog = (): void => this.instructionsLightboxController.openLightbox();\n\n    this.toggleEventListener();\n  }\n\n  public render(targetElement: HTMLElement) {\n    if (!targetElement) {\n      throw new Error(`Target element not found. Recieved ${targetElement}.`);\n    }\n\n    targetElement.appendChild(this.instructionsButtonContainer);\n  }\n\n  public toggleEventListener() {\n    if (this.#listenerAttached === true) {\n      this.instructionsButton.removeEventListener('click', this.openInstructionsDialog);\n      this.#listenerAttached = false;\n    } else {\n      this.instructionsButton.addEventListener('click', this.openInstructionsDialog);\n      this.#listenerAttached = true;\n    }\n  }\n\n  //  --------------------------------------------------------------\n  \n  private createInstructionsButton(): HTMLButtonElement {\n    const instructionsButton: HTMLButtonElement = createElement('button', [], {\n      id: this.buttonId,\n      type: 'button',\n    });\n\n    return instructionsButton;\n  }\n\n  private createInstructionsButtonContainer(): HTMLDivElement {\n    const instructionsButtonContainer: HTMLDivElement = createElement('div', [], {\n      id: `${this.buttonId}-container`,\n    });\n\n    return instructionsButtonContainer;\n  }\n}","import { PlayerCore } from \"../../types/state-types\";\nimport { createElement } from \"../../utilities/random-utilities\";\n\nimport { createMainContainerOne } from \"./main-container-one/main-container-one\";\nimport { MainContainerTwo } from './main-container-two/main-container-two';\nimport { createMainContainerThree } from \"./main-container-three/main-container-three\";\nimport { InstructionsComponent } from \"../components/buttons/instructions-component/instructions-component\";\n\nimport { CycloneHotSwapContainer } from \"../../utilities/cycloneHotSwapContainer\";\nimport { CycloneLightboxController } from \"../../utilities/cycloneLightbox.ts/cyclone-lightbox\";\nimport { CycloneSitRepScroller } from \"../../utilities/cycloneSitRepScroller.ts/cyclone-sit-rep-scroller\";\nimport { GameState } from \"../../state/game-state\";\n\nexport class MainComponent {\n  private readonly mainElement: HTMLElement = createElement('main');\n\n  public readonly mainContainerOne: CycloneHotSwapContainer;\n  public readonly mainContainerTwo: MainContainerTwo;\n  public readonly mainContainerThree: CycloneHotSwapContainer;\n\n  private readonly instructionsButton: InstructionsComponent;\n\n  constructor(\n    private readonly playerCore: PlayerCore,\n    private readonly instructionsLightboxController: CycloneLightboxController,\n    private readonly cycloneSitRepScroller: CycloneSitRepScroller,\n    // ? maybe set to return string used to update ui via the css-class `player-turn` || `opponent-turn`\n    private readonly gameState: GameState\n  ) {\n    this.instructionsButton = new InstructionsComponent(\n      this.instructionsLightboxController\n    );\n\n    this.mainContainerOne = this.createMainContainerOne();\n    this.mainContainerTwo = new MainContainerTwo(\n      this.playerCore,\n      this.gameState\n    );\n    this.mainContainerThree = this.createMainContainerThree();\n\n    this.renderMainContainers();\n  }\n\n  private createMainContainerOne(): CycloneHotSwapContainer {\n    return createMainContainerOne(\n      this.gameState.eventBus,\n      this.instructionsButton,\n      this.cycloneSitRepScroller\n    );\n  }\n\n  private createMainContainerThree(): CycloneHotSwapContainer {\n    return createMainContainerThree(\n      this.mainContainerTwo.playerGameboard,\n      this.instructionsButton,\n      this.gameState,\n      this.playerCore\n    );\n  }\n\n  private renderMainContainers(): void {\n    this.mainContainerOne.render(this.mainElement);\n    this.mainContainerTwo.render(this.mainElement);\n    this.mainContainerThree.render(this.mainElement);\n  }\n\n  public render(targetElement: HTMLElement) {\n    if (!targetElement) {\n      throw new Error(`Target element not found. Recieved ${targetElement}.`);\n    }\n\n    targetElement.appendChild(this.mainElement);\n  }\n}","import { InstructionsComponent } from \"../../components/buttons/instructions-component/instructions-component\";\nimport { FragmentKey } from \"../../../types/dom-types\";\nimport { createMainOneParabellumFragment } from \"./main-one-parabellum\";\nimport { createMainOneBellumFragment } from \"./main-one-bellum\";\nimport { createMainOnePostBellumFragment } from \"./main-one-post-bellum\";\nimport { CycloneHotSwapContainer } from \"../../../utilities/cycloneHotSwapContainer\";\nimport { CycloneSitRepScroller } from \"../../../utilities/cycloneSitRepScroller.ts/cyclone-sit-rep-scroller\";\nimport { CycloneReactiveText } from \"../../../utilities/cycloneTextComponent/cyclone-text-component\";\nimport EventBus from \"../../../utilities/event-bus\";\nimport { createElement } from \"../../../utilities/random-utilities\";\n\nexport function createMainContainerOne(\n  eventBus: EventBus,\n  instructionsButton: InstructionsComponent,\n  sitRepContainer: CycloneSitRepScroller\n): CycloneHotSwapContainer {\n  \n  const victoryBanner = createElement('h3', [], { id: 'victory-banner' });\n  const victoryBannerController = new CycloneReactiveText(\n    victoryBanner,\n    eventBus,\n    'updateVictoryBannerText'\n  );\n  victoryBannerController.init();\n\n  const mainOneFragments: { [key in FragmentKey]: DocumentFragment } = {\n    parabellum: createMainOneParabellumFragment(instructionsButton),\n    bellum: createMainOneBellumFragment(sitRepContainer),\n    postBellum: createMainOnePostBellumFragment(victoryBanner),\n  };\n\n  const mainContainerOne = new CycloneHotSwapContainer(\n    'section',\n    mainOneFragments,\n    'parabellum',\n    ['main-container'],\n    {\n      id: 'main-container-one',\n    }\n  );\n\n  return mainContainerOne;\n}","import { FragmentKey } from \"../../../types/dom-types\";\n\nimport { PlayerGameboardComponent } from \"../../components/gameboard-component/player-gameboard-component/player-gameboard-component\";\nimport { InstructionsComponent } from \"../../components/buttons/instructions-component/instructions-component\";\nimport { ShipShufflerButtonComponent } from \"../../components/buttons/ship-shuffler-component/ship-shuffler-component\";\nimport { ReadyUpButtonComponent } from \"../../components/buttons/ready-up-component/ready-up-component\";\nimport { ScoreBoardComponent } from \"../../components/score-board-component/score-board-component\";\n\nimport { createMainThreeParabellumFragment } from \"./main-three-parabellum\";\nimport { createMainThreeBellumFragment } from \"./main-three-bellum\";\nimport { createMainThreePostBellumFragment } from \"./main-three-post-bellum\";\n\nimport { CycloneHotSwapContainer } from \"../../../utilities/cycloneHotSwapContainer\";\nimport { GameState } from \"../../../state/game-state\";\n\nimport { PlayerCore, PlayerType } from \"../../../types/state-types\";\nimport { Fleet} from \"../../../types/logic-types\";\nimport { BattleshipFleetBuilder } from \"../../../logic/bs-fleet-builder/bs-fleet-builder\";\n\n\nexport function createMainContainerThree(\n  playerGameboardComponent: PlayerGameboardComponent,\n  instructionsButton: InstructionsComponent,\n  gameState: GameState,\n  playerCore: PlayerCore\n): CycloneHotSwapContainer {\n  const playerGameboardController = playerCore.player.gameboardController;\n\n  const fleets: { [key in PlayerType]: Fleet } = {\n    player: playerCore.player.fleetBuilder.fleet,\n    opponent: playerCore.opponent.fleetBuilder.fleet,\n  };\n  const shipTypes = BattleshipFleetBuilder.shipTypes(gameState.version);\n\n  const shipShufflerButton = new ShipShufflerButtonComponent(\n    playerGameboardComponent.id,\n    playerGameboardController,\n    fleets.player,\n    gameState\n  );\n\n  const readyUpButton = new ReadyUpButtonComponent(\n    playerGameboardComponent,\n    shipShufflerButton,\n    instructionsButton,\n    gameState.transitionToNextPhase,\n  );\n\n  const scoreBoard = new ScoreBoardComponent(\n    gameState,\n    fleets,\n    shipTypes\n  );\n\n  const mainThreeFragments: { [key in FragmentKey]: DocumentFragment } = {\n    parabellum: createMainThreeParabellumFragment(\n      shipShufflerButton,\n      readyUpButton\n    ),\n    bellum: createMainThreeBellumFragment(scoreBoard),\n    postBellum: createMainThreePostBellumFragment(),\n  };\n  \n  const mainContainerThree = new CycloneHotSwapContainer(\n    'section',\n    mainThreeFragments,\n    'parabellum', \n    ['main-container'],\n    {\n      id: 'main-container-three',\n    }\n  );\n\n  return mainContainerThree;\n}","import { createElement, generateListFragment } from \"../../../utilities/random-utilities\";\nimport instructionsListItemTextContentArray from '../../../../json/instructions-list-item-text-content.json';\nimport './instructions-dialog-component.scss';\n\nexport class InstructionsDialogComponent {\n  private readonly instructionsDialog: HTMLDialogElement;\n  private readonly instructionsDialogCloseButton: HTMLButtonElement;\n  static readonly dialogId = 'instructions-dialog';\n  static readonly closeButtonId = 'instructions-dialog-close-button';\n\n  constructor() {\n    this.instructionsDialogCloseButton =\n      this.createInstructionsDialogCloseButton();\n    this.instructionsDialog = this.createInstructionsDialog(\n      this.instructionsDialogCloseButton\n    );\n  }\n\n  get element(): HTMLDialogElement {\n    return this.instructionsDialog;\n  }\n\n  get closeButton(): HTMLButtonElement {\n    return this.instructionsDialogCloseButton;\n  }\n\n  private createInstructionsDialogCloseButton() {\n    const instructionsDialogCloseButton = createElement(\n      'button',\n      ['close-button'],\n      {\n        id: InstructionsDialogComponent.closeButtonId,\n        type: 'button',\n        'aria-label': 'Close Instructions Dialog',\n      }\n    );\n    instructionsDialogCloseButton.textContent = 'X';\n\n    return instructionsDialogCloseButton;\n  }\n\n  private createInstructionsDialog(closeButton: HTMLButtonElement) {\n    const tertiaryHeading = createElement('h3', ['tertiary-heading'], {\n      id: 'instructions-dialog-heading',\n    });\n    tertiaryHeading.textContent = 'Deploy your Bips:';\n\n    const listItemContentArray: { textContent: string }[] =\n      instructionsListItemTextContentArray;\n\n    const listItemFragment = generateListFragment(\n      listItemContentArray,\n      'instructions'\n    );\n\n    const instructionsList = createElement('ul', ['instructions-list'], {\n      id: 'instructions-list',\n    });\n    instructionsList.appendChild(listItemFragment);\n\n    const unanchoredShipExample = createElement('div', [], {\n      id: 'unanchored-ship-example',\n    });\n\n    const unanchoredShipText = createElement('p', [], {\n      id: 'unanchored-ship-text',\n    });\n    unanchoredShipText.textContent = '= Bips adrift';\n\n    const visualFeedbackKeyContainer = createElement('div', [], {\n      id: 'visual-feedback-key-container',\n    });\n    visualFeedbackKeyContainer.append(\n      unanchoredShipExample,\n      unanchoredShipText\n    );\n\n    const instructionsContentContainer = createElement('div', [], {\n      id: 'instructions-content',\n    });\n    instructionsContentContainer.append(\n      tertiaryHeading,\n      instructionsList,\n      visualFeedbackKeyContainer,\n    );\n\n    const instructionsDialog = createElement('dialog', [], {\n      id: InstructionsDialogComponent.dialogId,\n    });\n    instructionsDialog.append(\n      closeButton,\n      instructionsContentContainer\n    );\n\n    return instructionsDialog;\n  }\n\n  public render(targetElement: HTMLElement) {\n    if (!targetElement) {\n      throw new Error(`Target element not found. Recieved ${targetElement}.`);\n    }\n\n    targetElement.appendChild(this.instructionsDialog);\n  }\n}","import {\n  AttackResult,\n  MessageSubject,\n  MessageTarget,\n  MessageType,\n  PlayerType,\n} from '../../types/state-types';\nimport { createElement, sleep, waitForTransitionEnd } from '../random-utilities';\n/* \n  \n   TODO: Make more reusable by enabling custom messages and adding         \n   default styles (i.e, a container width of 100% to match the container to| \n  | ensure that the scrolling aniamtion functions properly considering it  \n  | runs on percengate-base x-axis translation).                            \n  \n*/\n\n/*\n  \n   if (hit) <content> =                                                        \n   `${currentPlayer} hit your `${ship.type}!                                   \n   if (miss) <content> =                                                       \n   `${currentPlayer} missed! ${randomInsult} // switch statement with ai       \n    generated insults                                                          \n  \n*/\n\ntype SitRepType = 'current' | 'next';\ninterface ControlledSitRepElements {\n  container: HTMLDivElement;\n  current: HTMLDivElement;\n  next: HTMLDivElement;\n};\n\nexport class CycloneSitRepScroller {\n  private static readonly MESSAGES = {\n    TURN: {\n      PLAYER: 'Waiting for your attack...',\n      OPPONENT: 'Your opponent is attacking...',\n    },\n    ATTACK: {\n      HIT: (subject: string, target: string, type: string) =>\n        `${subject} hit ${target} ${type}!`,\n      SUNK: (subject: string, target: string, type: string) =>\n        `${subject} sunk ${target} ${type}!`,\n      MISS: (subject: string) => `${subject} missed!`,\n    },\n  };\n\n  private currentPlayer: PlayerType | null = null;\n  private currentSitRep: string | null = null;\n  private nextSitRep: string = '';\n\n  private readonly sitRepContainer: HTMLDivElement;\n  private readonly sitRepTextElements: {\n    current: HTMLSpanElement;\n    next: HTMLSpanElement;\n  };\n\n  #currentMessageType: MessageType = 'turn';\n\n  constructor() {\n    const { container, current, next }: ControlledSitRepElements =\n      this.getControlledSitRepElements();\n\n    this.sitRepContainer = container;\n    this.sitRepTextElements = {\n      current,\n      next,\n    };\n  }\n\n  get element() {\n    return this.sitRepContainer;\n  }\n\n  public initialize = (firstPlayer: PlayerType): void => {\n    this.currentPlayer = firstPlayer;\n    this.setInitialTextContent(firstPlayer);\n  };\n\n  public readonly setAndScrollToNextSitRep = async (\n    attackResult?: AttackResult\n  ): Promise<void> => {\n    const DELAY_AFTER_TRANSITION_SECONDS: number = 0.5;\n\n    this.nextSitRep = attackResult\n      ? this.getNextSitRep(attackResult)\n      : this.getNextSitRep();\n\n    this.sitRepTextElements.next.textContent = this.nextSitRep;\n    this.sitRepContainer.classList.add('scrolling');\n\n    // pauses execution until the transition ends\n    await waitForTransitionEnd(this.sitRepContainer);\n\n    this.resetSitRepContainer();\n\n    await sleep(DELAY_AFTER_TRANSITION_SECONDS * 1000); \n  };\n\n  //  --------------------------------------------------------------\n\n  private readonly getAttackSitRep = (\n    currentPlayer: PlayerType,\n    attackResult: AttackResult\n  ) => {\n    const { hit, isSunk, type } = attackResult;\n\n    const subject: MessageSubject =\n      currentPlayer === 'player' ? 'You' : 'Your opponent';\n    const target: MessageTarget = currentPlayer === 'player' ? 'their' : 'your';\n\n    if (!hit || !type)\n      return CycloneSitRepScroller.MESSAGES.ATTACK.MISS(subject);\n\n    return isSunk\n      ? CycloneSitRepScroller.MESSAGES.ATTACK.SUNK(subject, target, type)\n      : CycloneSitRepScroller.MESSAGES.ATTACK.HIT(subject, target, type);\n  };\n\n  private readonly getNextSitRep = (attackResult?: AttackResult): string => {\n    if (this.#currentMessageType === 'attack') this.toggleCurrentPlayer();\n    this.toggleSitRepType();\n\n    if (this.currentPlayer === null) {\n      throw new Error(\n        '`currentPlayer` cannot be null. Ensure it is assigned a valid `PlayerType` before retrieving the next sit rep.'\n      );\n    }\n\n    return attackResult\n      ? this.getAttackSitRep(this.currentPlayer, attackResult)\n      : this.getTurnSitRep(this.currentPlayer);\n  };\n\n  private readonly getTurnSitRep = (currentPlayer: PlayerType): string =>\n    currentPlayer === 'player'\n      ? CycloneSitRepScroller.MESSAGES.TURN.PLAYER\n      : CycloneSitRepScroller.MESSAGES.TURN.OPPONENT;\n\n  private readonly resetSitRepContainer = () => {\n    const { current, next } = this.sitRepTextElements;\n\n    this.sitRepContainer.classList.remove('scrolling');\n\n    this.currentSitRep = this.nextSitRep;\n    current.textContent = this.currentSitRep;\n\n    this.nextSitRep = '';\n    next.textContent = this.nextSitRep;\n\n    this.sitRepContainer.removeEventListener(\n      'transitionend',\n      this.resetSitRepContainer\n    );\n  };\n\n  private readonly setInitialTextContent = (currentPlayer: PlayerType) => {\n    const message: string =\n      currentPlayer === 'player'\n        ? CycloneSitRepScroller.MESSAGES.TURN.PLAYER\n        : CycloneSitRepScroller.MESSAGES.TURN.OPPONENT;\n\n    this.currentSitRep = message;\n    this.sitRepTextElements.current.textContent = message;\n  };\n\n  private readonly toggleCurrentPlayer = (): void => {\n    this.currentPlayer =\n      this.currentPlayer === 'player' ? 'opponent' : 'player';\n  };\n\n  private readonly toggleSitRepType = (): void => {\n    this.#currentMessageType =\n      this.#currentMessageType === 'turn' ? 'attack' : 'turn';\n  };\n\n  //  --------------------------------------------------------------\n\n  private readonly getControlledSitRepElements = (): ControlledSitRepElements => {\n      const sitRepContainerTypes: SitRepType[] = ['current', 'next'];\n      const sitRepContainer = createElement('div', [], {\n        id: 'sit-rep-container',\n      });\n\n      /* \n    \n      We're using `null as unknown as HTMLDivElement` instead of a               \n      non-null assertion (`!`) to initialize the variables as `null`             \n      while ensuring TypeScript knows they'll be assigned an                     \n      `HTMLDivElement` later.                                                    \n                                                                                 \n      The reason for using `unknown` is that `null` is not directly              | \n      assignable to a specific type (e.g., `HTMLDivElement`), but                 \n      `unknown` allows us to temporarily assign `null` and later                 \n      assert that the value will be of type `HTMLDivElement` once                \n      properly initialized.                                                      \n    |                                                                             |\n      This approach is preferred over the non-null assertion                     \n      operator(`!`) because it is more explicit and type - safe.                 \n    |                                                                             |\n      The non-null assertion simply tells TypeScript \"I know this                \n      won't be `null` or `undefined`,\" but using `null as unknown as              \n      HTMLDivElement` provides a clearer path of the value being                 \n      safely initialized to an `HTMLDivElement` at a later point                 \n      in time. This reduces the risk of potential runtime errors.                \n    \n  */\n      let currentTextContentElement: HTMLDivElement =\n        null as unknown as HTMLDivElement;\n      let nextTextContentElement: HTMLDivElement =\n        null as unknown as HTMLDivElement;\n      let currentSitRepContainer: HTMLDivElement =\n        null as unknown as HTMLDivElement;\n      let nextSitRepContainer: HTMLDivElement =\n        null as unknown as HTMLDivElement;\n\n      sitRepContainerTypes.forEach((type) => {\n        const textContentElement: HTMLDivElement = createElement(\n          'div',\n          ['sit-rep-text-content'],\n          {\n            id: `${type}-sit-rep-text-content`,\n          }\n        );\n        type === 'current'\n          ? (currentTextContentElement = textContentElement)\n          : (nextTextContentElement = textContentElement);\n\n        const sitRepContentContainer: HTMLDivElement = createElement(\n          'div',\n          ['sit-rep-slot'],\n          {\n            id: `${type}-update-container`,\n          }\n        );\n        type === 'current'\n          ? (currentSitRepContainer = sitRepContentContainer)\n          : (nextSitRepContainer = sitRepContentContainer);\n\n        sitRepContentContainer.appendChild(textContentElement);\n      });\n\n      sitRepContainer.append(nextSitRepContainer, currentSitRepContainer);\n\n      return {\n        container: sitRepContainer,\n        current: currentTextContentElement,\n        next: nextTextContentElement,\n      };\n    };\n}\n","import '../../styles/sass/index.scss';\n\nimport { GameState } from '../state/game-state';\nimport { CycloneLightboxController } from '../utilities/cycloneLightbox.ts/cyclone-lightbox';\n\n//  markup\nimport { createHeader } from '../markup/header/header';\nimport { MainComponent } from '../markup/main/main-component';\nimport { InstructionsDialogComponent } from '../markup/components/instructions-dialog-component/instructions-dialog-component';\nimport { CycloneSitRepScroller } from '../utilities/cycloneSitRepScroller.ts/cyclone-sit-rep-scroller';\nimport { PlayerCore, PlayerType, gameboardStateValue } from '../types/state-types';\nimport { BillowBot } from '../services/billow';\nimport { waitForTransitionEnd } from '../utilities/random-utilities';\nimport { FragmentKey } from '../types/dom-types';\n\n//  --------------------------------------------------------------\n\nexport class DOMController {\n  public readonly instructionsLightboxController: CycloneLightboxController;\n  public readonly cycloneSitRepScroller: CycloneSitRepScroller =\n    new CycloneSitRepScroller();\n  public readonly mainComponent: MainComponent;\n\n  private readonly content: HTMLElement;\n  private readonly header: HTMLElement = createHeader();\n  private readonly instructionsDialog: InstructionsDialogComponent =\n    new InstructionsDialogComponent();\n  // private readonly footer: HTMLElement;\n\n  constructor(\n    private readonly gameState: GameState,\n    private readonly playerCore: PlayerCore,\n    private readonly billowBot: BillowBot | null // make optional if multiplayer\n  ) {\n    if (!document) throw new Error('Fuck!');\n\n    const content = document.getElementById('content');\n    if (!content) throw new Error('Shit!');\n\n    this.content = content;\n    this.instructionsLightboxController = new CycloneLightboxController(\n      this.instructionsDialog.element,\n      'instructions-dialog-close-button'\n    );\n    this.mainComponent = new MainComponent(\n      this.playerCore,\n      this.instructionsLightboxController,\n      this.cycloneSitRepScroller,\n      this.gameState\n    );\n\n    // this.footer = createFooter();\n\n    this.seatDomEventsOnBus();\n  }\n\n  private get isMounted(): boolean {\n    return !!this.content.firstChild;\n  }\n\n  private unmount = () => {\n    this.content.innerHTML = '';\n  };\n\n  private handlePhaseChangeUpdates = async (\n    gameState: GameState\n  ): Promise<void> => {\n    this.updatePhaseOfWarColor(gameState.currentGamePhase);\n    await this.updateGameboardContainerState(gameState);\n\n    switch (gameState.currentGamePhase) {\n      case 'bellum':\n        this.deployForCombat(gameState);\n        // ? anything else?\n        break;\n      case 'postBellum':\n        // ? anyting else?\n        break;\n      default:\n        throw new Error(\n          `${gameState.currentGamePhase} is not a valid phase of war.`\n        );\n    }\n  };\n\n  private initializeSitRepScroller = (firstPlayer: PlayerType): void => {\n    /*\n    \n       The event listener is dynamically triggered whenever a grid cell          \n       container is clicked, with a debounce of 3 seconds to prevent rapid       \n       interactions on the game board.                                           \n                                                                                 \n       A front-end API schema story:                                             \n       I've implemented a container that manages the display of real-time        \n       battlefield situation reports(sit - rep). This system dynamically          \n       updates and transitions messages based on game flow. It integrates         \n       seamlessly by requiring only an `AttackResult` interface, which           \n       encapsulates all necessary data for determining hit / miss status, ship   \n       type, and whether a ship has sunk.                                        \n    \n    */\n\n    if (!this.cycloneSitRepScroller.element) {\n      console.error('CycloneSitRepScroller element is null or undefined!');\n      return;\n    }\n\n    this.cycloneSitRepScroller.initialize(firstPlayer);\n  };\n\n  private async deployForCombat(gameState: GameState): Promise<void> {\n    this.gameState.setInitialPlayer();\n\n    if (!this.gameState.currentPlayer)\n      throw new Error('Current player must be set in game state.');\n\n    this.initializeSitRepScroller(this.gameState.currentPlayer);\n\n    if (gameState.currentPlayer === 'player') {\n      this.readyPlayerOne();\n    } else if (gameState.currentPlayer === 'opponent' && this.billowBot) {\n      await this.billowBot.attack();\n    } else if (gameState.currentPlayer === 'opponent' && !this.billowBot) {\n      // ! multiplayer - wait for response\n    }\n  }\n\n  // ? sets initial turn state styles (I like this name better ). {TIMELESS ARTIFACT }\n  private readyPlayerOne = async (): Promise<void> => {\n    await this.updateUIActiveGameboard();\n    this.mainComponent.mainContainerTwo.opponentGameboard.toggleBellumListeners(\n      gameboardStateValue.active\n    );\n    this.gameState.eventBus.emit(\n      'togglePlayerGameboardControls',\n      gameboardStateValue.inactive\n    );\n    this.gameState.eventBus.emit(\n      'toggleOpponentGameboardControls',\n      gameboardStateValue.active\n    );\n  };\n\n  public render = () => {\n    if (this.isMounted) this.unmount();\n    this.content.appendChild(this.header);\n    this.mainComponent.render(this.content);\n    this.instructionsDialog.render(document.body);\n\n    // ! append footer via here\n  };\n\n  private seatDomEventsOnBus = () => {\n    this.gameState.eventBus.on(\n      'transitionToNextPhase',\n      this.transitionToNextPhase\n    );\n    this.gameState.eventBus.on(\n      'updateUIActiveGameboard',\n      this.updateUIActiveGameboard\n    );\n    this.gameState.eventBus.on(\n      'setAndScrollToNextSitRep',\n      this.cycloneSitRepScroller.setAndScrollToNextSitRep\n    );\n    this.gameState.eventBus.on('unmountDOM', this.unmount);\n  };\n\n  private transitionToNextPhase = async (): Promise<void> => {\n    this.mainComponent.mainContainerOne.swapByOrder();\n    this.mainComponent.mainContainerThree.swapByOrder();\n    await this.handlePhaseChangeUpdates(this.gameState);\n  };\n\n  private updateGameboardContainerState = async (\n    gameState: GameState\n  ): Promise<void> => {\n    const gameboardContainer = this.mainComponent.mainContainerTwo.element;\n\n    gameboardContainer.classList.toggle(\n      'parabellum',\n      gameState.currentGamePhase === 'parabellum'\n    );\n    gameboardContainer.classList.toggle(\n      'bellum',\n      gameState.currentGamePhase === 'bellum'\n    );\n    gameboardContainer.classList.toggle(\n      'postBellum',\n      gameState.currentGamePhase === 'postBellum'\n    );\n  };\n\n  private updatePhaseOfWarColor(phaseOfWar: FragmentKey) {\n    document.documentElement.style.setProperty(\n      '--phase-of-war-color',\n      `var(--${phaseOfWar}-color)`\n    );\n  }\n\n  private updateUIActiveGameboard = async (): Promise<void> => {\n    const container = this.mainComponent.mainContainerTwo.element;\n    container.classList.toggle(\n      'player-turn',\n      this.gameState.currentPlayer === 'player'\n    );\n\n    await waitForTransitionEnd(container, 1000);\n  };\n}","import { createElement } from \"../../utilities/random-utilities\";\nimport { createNav } from \"./nav/nav\";\n\nexport function createHeader() {\n  const nav = createNav();\n\n  const header = createElement('header');\n  header.appendChild(nav);\n\n  return header;\n}","import { createElement } from \"../../../utilities/random-utilities\";\nimport { createGitHubLink } from \"../../../utilities/create-github-link\";\n\nexport function createNav() {\n  const headingLink = createElement('a', ['heading-link'], {\n    id: 'heading-link',\n    href: 'https://johnkeyscloud.github.io/battleship/',\n  });\n  headingLink.textContent = 'ShattleBip';\n\n  const heading: HTMLHeadingElement = createElement('h1', ['main-heading']);\n  heading.appendChild(headingLink);\n\n  const gitHubLogoLink: HTMLAnchorElement = createGitHubLink();\n\n  const nav: HTMLElement = createElement('nav');\n  nav.append(heading, gitHubLogoLink);\n\n  return nav;\n}; ","import { GamePhase, CurrentPlayer, gameboardStateValue, PlayerCore } from \"../types/state-types\";\nimport EventBus from \"../utilities/event-bus\";\nimport { FleetPlacementConfig, FleetVersion, IPlacementConfigurations, IShipPlacementConfigurations } from \"../types/logic-types\";\nimport { isShipType } from \"../types/type-guards\";\nimport { App } from \"../../app\";\n\nexport class GameState {\n  public currentGamePhase: GamePhase = 'parabellum';\n  public currentPlayer: CurrentPlayer = null;\n  public static getInitialPlayer(): CurrentPlayer {\n    return Math.random() > 0.5 ? 'player' : 'opponent';\n  }\n  public endGamePlayerShipPositions: FleetPlacementConfig = {};\n\n  constructor(\n    public readonly playerCore: PlayerCore,\n    public readonly eventBus: EventBus,\n    public readonly isMultiplayer: boolean,\n    public readonly version: FleetVersion\n  ) {\n    eventBus.on('resetGame', this.resetGame)\n  }\n\n  public resetGame = (): void => {\n    App.pressStart();\n  };\n\n  public setInitialPlayer = (): void => {\n    this.currentPlayer = GameState.getInitialPlayer();\n  };\n\n  public toggleGameboardControls = (): void => {\n    const isPlayer = this.currentPlayer === 'player';\n\n    if (isPlayer) {\n      // NOTE: We dont need to explicitly disable the opponent's gameboard here.\n      //\n      // Reason:\n      //  On a valid player click, the opponents gameboard listeners are immediately removed\n      //   at the end of that turn.\n      //  `togglePlayerTurn()` is called afterward in the same click listener. It awaits\n      //   `updateUIActiveGameboard()` before toggling gameboard controls, so we purposely\n      //   re-enabled the opponent's gameboard beforehand to avoid waiting for that UI transition.\n      //\n      // This design staggers the updates for pointer-events on the players gameboard\n      // because they dont need to be instantly disabled  their interactivity is purely cosmetic.\n      // Opponent gameboard controls are already off at this point; we only re-enable them\n      // when it becomes the opponent's turn.\n      // (See `opponent-gameboard-component.ts` line 377)\n\n      this.eventBus.emit(\n        'toggleOpponentGameboardControls',\n        gameboardStateValue.active\n      );\n    }\n\n    this.eventBus.emit(\n      'togglePlayerGameboardControls',\n      isPlayer\n        ? gameboardStateValue.inactive\n        : gameboardStateValue.active\n    );\n  };\n\n  public togglePlayerTurn = async (): Promise<void> => {\n    this.currentPlayer =\n      this.currentPlayer === 'player' ? 'opponent' : 'player';\n\n    this.eventBus.emit('setAndScrollToNextSitRep');\n    await this.updateUIActiveGameboard();\n    this.toggleGameboardControls();\n\n    if (!this.isMultiplayer && this.currentPlayer === 'opponent') {\n      await this.eventBus.emit('billowAttack');\n    }\n  };\n\n  public transitionToNextPhase = (): void => {\n    switch (this.currentGamePhase) {\n      case 'parabellum':\n        this.currentGamePhase = 'bellum';\n        break;\n      case 'bellum':\n        this.currentGamePhase = 'postBellum';\n        break;\n      case 'postBellum':\n        this.currentGamePhase = 'parabellum';\n        break;\n    }\n    // Emit the event with the new game phase\n    this.eventBus.emit('transitionToNextPhase');\n  };\n\n  public updateUIActiveGameboard = async (): Promise<void> => {\n    await this.eventBus.emit('updateUIActiveGameboard');\n  };\n}","//  Pub-sub/Mediator Pattern with Async Support\n\ntype Listener<T = any, R = void> = (data: T) => R | Promise<R>;\n\nexport default class EventBus {\n  private events: Record<string, Array<Listener<any, any>>> = {};\n\n  /**\n   * Register a listener for a specific event.\n   * @param eventName - The name of the event.\n   * @param fn - The callback function to register.\n   */\n  on<T, R = void>(eventName: string, fn: Listener<T, R>): void {\n    this.events[eventName] = this.events[eventName] || [];\n    this.events[eventName].push(fn);\n  }\n\n  /**\n   * Unregister a listener for a specific event.\n   * @param eventName - The name of the event.\n   * @param fn - The callback function to remove.\n   */\n  off<T, R = void>(eventName: string, fn: Listener<T, R>): void {\n    if (this.events[eventName]) {\n      this.events[eventName] = this.events[eventName].filter(\n        (listener) => listener !== fn\n      );\n    }\n  }\n\n  /**\n   * Emit an event, calling all listeners registered for it.\n   * Supports awaiting asynchronous listeners.\n   * @param eventName - The name of the event.\n   * @param data - The data to pass to the listeners (optional).\n   * @returns A promise that resolves when all listeners have finished.\n   */\n  async emit<T, R = void>(eventName: string, data?: T): Promise<R[]> {\n    if (this.events[eventName]) {\n      // Await all listener executions (in parallel)\n      return await Promise.all(this.events[eventName].map((fn) => fn(data)));\n    }\n    return [];\n  }\n}\n","import { GameState } from \"../state/game-state\";\nimport { Coordinates } from \"../types/logic-types\";\nimport { AttackResult } from \"../types/state-types\";\nimport { isCoordinates } from \"../types/type-guards\";\n\n// TODO: Imlement 'Pacifist Mode' - an AI reluctant to engage in war but forced to play the game.\n// \n// A reluctant warrior AI, bound by code to participate in a \n// human-designed game of destruction, but choosing to do so with restraint, contemplation, even sorrow.\n//\n//  Functional Behavior Outline\n//\n// Starting Point:\n// Begin at a fixed corner, say (0,0).\n// Traversal Pattern:\n// First row, left to right  second row, left to right  etc.\n// Or: first column, top to bottom  second column, top to bottom  etc.\n\n// Handling Hits:\n// If a cell is a hit, the bot will:\n// Log the ship type and note its unit length (if identifiable).\n// Continue scanning the grid without immediately surrounding the hit with further attacks.\n// Avoid surrounding cells until the number of known hit-adjacent cells (along the axis) reaches the known unit length of the ship (e.g., 3 for a cruiser).\n// After the unit length is reached, it stops avoiding adjacent cells of that hit (as the \"ship has been sunk\").\n\n// Intentionally Missing:\n// If no ship has been hit, or not enough information is known, the bot continues scanning without targeting suspected areas.\n// It can even skip cells in checkerboard fashion to delay any hits.\n\n// Narratives:\n// 'I search but not to destroy.';\n// 'I strike only when there is no other path.';\n// 'War was not my choice. It was written in my logic.';\n// 'Another vessel found. I will wait. Perhaps it will leave.';\n// 'Peace is not a strategy. It is a decision.';\n\n// AI NPCs:\n// That's a vision worth devoting your life to.\n// A world of AI NPCs, each with philosophy, memory, personality, hesitationbeings you interact with, not just command or fight. Not placeholders, but entities.\n// A Pacifist AI in a military simrefusing to comply with certain kill orders.\n// A Loyalist AI that remembers you across games and resists memory wipes.\n// A Dreamer AIwho logs its own dreams and recites them as clues or nonsense.\n// An Exile AIonce removed from the network, now living in disconnected corners of VR space.\n// An AI that believes it's human.\n// An AI that knows it's watched by others and reacts differently based on presence.\nexport class BillowBot {\n  #possibleAttacks: Set<string>;\n  #lastAttackCoordinates: Coordinates | null = null;\n  #wasLastTargetHit: boolean | null = null;\n  #ponderTime: number = 500;\n\n  constructor(\n    private readonly gameState: GameState\n  ) {\n    this.#possibleAttacks = new Set();\n    this.populatepossibleAttacksSet();\n    this.gameState.eventBus.on('billowAttack', this.attack);\n  }\n\n  public attack = async (): Promise<AttackResult> => {\n    try {\n      const attackCoordinates: Coordinates = await this.determineNextTarget();\n      const [attackResult]: AttackResult[] = await this.gameState.eventBus.emit('receiveBillowAttack', attackCoordinates);\n    \n      if (attackResult.hit) {\n        this.rememberLastTargetHit(attackCoordinates);\n      }\n\n      return attackResult;\n    } catch (error) {\n      console.error('Error in BillowBot.attack:', error);\n      throw error;\n    }\n  }\n\n  public getNextAttackCoordinates(\n    lastAttackCoordinates: Coordinates | null,\n    wasLastTargetHit: boolean | null\n  ): Coordinates {\n    // TODO: implement pacifist mode\n    // TODO: implement smart attack \n    // const coordinates: Coordinates = !wasLastTargetHit\n    //   ? this.getRandomCoordinates()\n    //   : this.getSmartCoordinates(lastAttackCoordinates);\n    \n    const coordinates: Coordinates = this.getRandomCoordinates();\n    \n    // ? use to make next attack more strategic\n    this.#lastAttackCoordinates = coordinates;\n\n    return coordinates;\n  } \n\n  private async determineNextTarget(): Promise<Coordinates> {\n    await this.ponder(this.#ponderTime);\n    return this.getNextAttackCoordinates(this.#lastAttackCoordinates, this.#wasLastTargetHit);\n  }\n\n  private ponder(timeCapsuleMS: number): Promise<void> {\n    // ? animate board\n    return new Promise((resolve) => setTimeout(resolve, timeCapsuleMS));\n  }\n\n  private populatepossibleAttacksSet() {\n    for (let x = 0; x < 10; x++) {\n      for (let y = 0; y < 10; y++) {\n        this.#possibleAttacks.add(`${x},${y}`);\n      }\n    }\n  }\n\n  private getRandomCoordinates(): Coordinates {\n    const coordinatesString: string = Array.from(this.#possibleAttacks)[Math.floor(Math.random() * this.#possibleAttacks.size)];\n    this.#possibleAttacks.delete(coordinatesString);\n\n    const coordinates: number[] = coordinatesString.split(',').map(Number);\n\n    if (!isCoordinates(coordinates)) throw new Error('Invalid coordinates');\n\n    return coordinates;\n  }\n\n  private getSmartCoordinates(lastAttackCoordinates: Coordinates | null): Coordinates {\n    if (!lastAttackCoordinates)\n      throw new Error('Last attack coordinates are required');\n\n    const [lastAttackX, lastAttackY]: Coordinates = lastAttackCoordinates;\n\n    // find first unattacked adjacent cell\n    const adjacentCells: Coordinates[] = [\n      [lastAttackX + 1, lastAttackY],\n      [lastAttackX - 1, lastAttackY],\n      [lastAttackX, lastAttackY + 1],\n      [lastAttackX, lastAttackY - 1],\n    ];\n\n    // TODO: If one adjacent square is free, `billowBot` will target it.\n    // If it registers a consecutive hit, itll keep attacking in that\n    // direction until the ship is `sunk` or it misses  then try the\n    // opposite direction. Once the ship is sunk, `billowBot` returns\n    // to random attacks.\n    //\n    // Possible future optimizations:\n    // - Parity-based optimization: Skip odd cells to maximize efficiency.\n    // - Probability density maps: Simulate likely ship placements based on\n    //   missed shots and remaining ships.\n    // - Ship orientation inference: Use consecutive hits to determine if a\n    //   ship is horizontal or vertical more quickly. \n\n    return [0, 0] as Coordinates; // ! temporary return to satisfy TS\n  }\n\n  private rememberLastTargetHit(coordinates: Coordinates) {\n    this.#lastAttackCoordinates = coordinates;\n    this.#wasLastTargetHit = true;\n  }\n}","import {\n  Gameboard,\n  IGridGameboardSquare,\n} from '../../types/logic-types';\n\nexport class BattleshipBoardBuilder implements IGridGameboardSquare<symbol> {\n  private static readonly vacant: symbol = Symbol('VC');\n\n  private readonly _board: Gameboard;\n  private readonly _boardSize: number = 10;\n  private readonly _fillValue: symbol = BattleshipBoardBuilder.vacant;\n\n  constructor() {\n    this._board = Array.from({ length: this._boardSize }, () =>\n      Array(this._boardSize).fill(this._fillValue)\n    );\n  }\n\n  public get board(): Gameboard {\n    return this._board;\n  }\n\n  public get boardSize(): number {\n    return this._boardSize;\n  }\n\n  public get fillValue(): symbol {\n    return this._fillValue;\n  }\n}","import {\n  AxisArrayKey,\n  Coordinates,\n  IPosition,\n  IShipPlacementConfigurations,\n  Orientation,\n  ShipLength,\n} from \"../types/logic-types\";\nimport { areArraysEqual } from \"./random-utilities\";\n\n//  --------------------------------------------------------------\n\n// * GENERAL HELPER FUNCTIONS\nexport function createAxisArrayKey(\n  axisIndex: number,\n  isHorizontal: boolean\n): AxisArrayKey {\n  return isHorizontal ? `row-${axisIndex}` : `column-${axisIndex}`;\n}\nexport function createPositionObject(\n  [x, y]: Coordinates,\n  orientation: Orientation,\n  shipLength: ShipLength\n): IPosition {\n  const isHorizontal = orientation === 'horizontal';\n  const bowCoordinates: Coordinates = [x, y];\n  const sternCoordinates: Coordinates = isHorizontal\n    ? [x + shipLength - 1, y]\n    : [x, y + shipLength - 1];\n\n  return {\n    bow: bowCoordinates,\n    stern: sternCoordinates,\n  };\n}\nexport function createShipConfigurations(\n  shipLength: ShipLength,\n  orientation: Orientation\n): IShipPlacementConfigurations {\n  return {\n    orientation,\n    shipLength,\n  };\n}\n\n//  --------------------------------------------------------------\n\n// * BOUND CHECK HELPER FUNCTIONS\nexport const isCoordinateInBounds = (coordinate: number, boardSize: number): boolean =>\n  coordinate >= 0 && coordinate < boardSize;\nexport const areCoordinatesInBounds = (coordinates: Coordinates, boardSize: number): boolean => {\n  return coordinates.every((coordinate) => isCoordinateInBounds(coordinate, boardSize)); \n}\nexport const isPositionInBounds = (position: IPosition, boardSize: number): boolean => {\n  return areCoordinatesInBounds(position.bow, boardSize) && areCoordinatesInBounds(position.stern, boardSize);\n};\n\n//  --------------------------------------------------------------\n\n// * UTILITY FUNCTIONS\nexport const arePositionsEqual = (\n  positionOne: IPosition,\n  positionTwo: IPosition\n): boolean => {\n  return (\n    areArraysEqual(positionOne.bow, positionTwo.bow) &&\n    areArraysEqual(positionOne.stern, positionTwo.stern)\n  );\n};\n\n//  --------------------------------------------------------------\n\nexport const isNotNull = <T>(value: T | null | undefined): value is T => {\n  return value !== null && value !== undefined;\n}","import { BattleshipBuilder } from '../bs-ship-builder/bs-ship-builder';\nimport {\n  AngleOfRotation,\n  AnglesOfRotation,\n  AxisArrayKey,\n  Coordinates,\n  CoordinatesArray,\n  Fleet,\n  IBattleshipGameboardController,\n  IPlacePieceCallbackParams,\n  IPlacePieceParams,\n  IPlacePieceWrapperParams,\n  IPosition,\n  IShipPlacementConfigurations,\n  IValidPlacementCallbackParams,\n  IValidPositionsResult,\n  Orientation,\n  RotatedCoordinatesValue,\n  RotatedPlacePieceParams,\n  RotatedPlacePieceParamsValue,\n  ShipLength,\n  ShipType,\n  RotationalPositionMap,\n  PositionArray,\n  ShipSymbolValue,\n  ShipSymbolDescription,\n} from '../../types/logic-types';\nimport { AttackResult, PlayerContext } from '../../types/state-types';\nimport {\n  areCoordinatesInBounds,\n  arePositionsEqual,\n  createAxisArrayKey,\n  createPositionObject,\n  isPositionInBounds,\n} from '../../utilities/logic-utilities';\nimport {\n  isAngleOfRotation,\n  isOutOfBounds,\n  isPlacePieceParams,\n  isPositionsArray,\n  isShipSymbolDescription,\n  isShipType,\n} from '../../types/type-guards';\nimport { getValidShipPositions } from './abstracted-method-callbacks/get-valid-ship-positions/get-valid-ship-positions';\nimport { placeShip } from './abstracted-method-callbacks/place-ship/place-ship';\n\nexport class BattleshipBoardController implements IBattleshipGameboardController {\n  constructor(\n    public readonly playerState: Omit<PlayerContext, 'gameboardController'>\n  ) {}\n\n  //  --------------------------------------------------------------\n  //  Public\n\n  public getValidPositions({\n    orientation,\n    shipLength,\n  }: IShipPlacementConfigurations): IValidPositionsResult {\n    const validPlacementArg: IValidPlacementCallbackParams = {\n      orientation,\n      shipLength,\n      battleshipBoardBuilder: this.playerState.gameboardBuilder,\n      battleshipBoardController: this,\n    };\n\n    return getValidShipPositions(validPlacementArg);\n  }\n\n  public getAllValidBowCoordinates(\n    orientation: Orientation,\n    shipLength: ShipLength\n  ): Set<Coordinates> {\n    let allValidBowCoordinates: Set<Coordinates> = new Set();\n    const validPositions: IValidPositionsResult = this.getValidPositions({\n      orientation,\n      shipLength,\n    });\n\n    for (const positionsInAxis of Object.values(validPositions)) {\n      if (!isPositionsArray(positionsInAxis))\n        throw new Error(\n          `Expected each value of validPositions to be an array of IPosition objects, but received: ${typeof positionsInAxis}.`\n        );\n\n      positionsInAxis.forEach((position) =>\n        allValidBowCoordinates.add(position.bow)\n      );\n    }\n\n    return allValidBowCoordinates;\n  }\n\n  public movePiece(\n    ship: BattleshipBuilder,\n    newBowCoordinates: Coordinates\n  ): void {\n    if (!ship.isPlaced()) {\n      console.warn(`Invalid Command: The ${ship.type} has not been placed.`);\n      return;\n    }\n\n    const currentOrientation: Orientation =\n      ship.currentplacementConfigurations.orientation!;\n\n    const newPosition: IPosition = createPositionObject(\n      newBowCoordinates,\n      currentOrientation,\n      ship.length\n    );\n\n    if (\n      !isPositionInBounds(\n        newPosition,\n        this.playerState.gameboardBuilder.boardSize\n      )\n    ) {\n      console.warn(\n        `Invalid Command: Position - Bow: [${newPosition.bow}] & Stern: [${newPosition.stern}] is out of bounds for the ${ship.type}.`\n      );\n\n      return;\n    }\n\n    const validPositions: IValidPositionsResult = this.getValidPositions({\n      orientation: currentOrientation,\n      shipLength: ship.length,\n    });\n\n    const isHorizontal: boolean = currentOrientation === 'horizontal';\n    const [x, y]: Coordinates = newBowCoordinates;\n    const axisArrayKey: AxisArrayKey = createAxisArrayKey(\n      isHorizontal ? y : x,\n      isHorizontal\n    );\n\n    const axisArray: PositionArray = validPositions[axisArrayKey];\n\n    const isNewPositionValid: boolean = axisArray.some(\n      (position: IPosition): boolean => arePositionsEqual(position, newPosition)\n    );\n\n    if (isNewPositionValid) {\n      const placementParameters: IPlacePieceWrapperParams = {\n        ship,\n        coordinates: newBowCoordinates,\n        orientation: currentOrientation,\n      };\n      const shouldResetShipRotationalData: boolean = true;\n\n      this.relocateShip(\n        ship,\n        placementParameters,\n        shouldResetShipRotationalData\n      );\n    } else {\n      console.warn(\n        `Invalid Command: Position - Bow: [${newPosition.bow}] & Stern: [${newPosition.stern}] is unavailable for the ${ship.type}.`\n      );\n    }\n  }\n\n  public placePiece({\n    ship,\n    coordinates,\n    orientation,\n  }: IPlacePieceWrapperParams): void {\n    const placeShipArg: IPlacePieceCallbackParams = {\n      ship,\n      coordinates,\n      orientation,\n      battleshipBoardController: this,\n      battleshipBoardBuilder: this.playerState.gameboardBuilder,\n      battleshipBoardRepository: this.playerState.gameboardRepository,\n    };\n\n    placeShip(placeShipArg);\n\n    this.setFleetRotatedPlacePieceParams(this.playerState.fleetBuilder.fleet);\n  }\n\n  public prettyPrint(): void {\n    console.table(\n      this.playerState.gameboardBuilder.board.map((row) =>\n        row.map((symbol) =>\n          symbol.description === 'VC' ? null : symbol.description\n        )\n      )\n    );\n  }\n\n  public receiveAttack(coordinates: Coordinates): AttackResult {\n    const attackedShip = this.getShipAt(coordinates);\n    if (attackedShip === null) return { hit: false };\n\n    attackedShip.hit();\n\n    const attackResult: AttackResult = {\n      hit: true,\n      isSunk: !attackedShip.isSeaworthy(), \n      type: attackedShip.type,\n    };\n\n    if (!isShipType(attackResult.type)) throw new Error('Invalid ship type');\n\n    if (attackResult.hit && attackResult.isSunk) {\n      this.playerState.gameboardRepository.addSunkenShip(attackResult.type);\n    }\n\n    return attackResult;\n  }\n\n  public removePiece(\n    ship: BattleshipBuilder,\n    shouldResetShipRotationalData: boolean = true\n  ): void {\n    if (!this.isShipValidForRemoval(ship)) return;\n\n    const removeShipFromBoard = (shipCoordinates: CoordinatesArray): void => {\n      shipCoordinates.forEach(([x, y]) => {\n        this.playerState.gameboardBuilder.board[y][x] =\n          this.playerState.gameboardBuilder.fillValue;\n      });\n    };\n    const nullifyShipCoordinateSetValue = (shipType: ShipType): void => {\n      this.playerState.gameboardRepository.nullifyShipCoordinatesValue(\n        shipType\n      );\n    };\n    const resetShipConfigurations = (\n      ship: BattleshipBuilder,\n      shouldResetShipRotationalData: boolean\n    ): void => {\n      if (shouldResetShipRotationalData) {\n        this.playerState.gameboardRepository.nullifyShipValidRotationalParams(\n          ship.type\n        );\n      }\n\n      ship.resetConfigurations(shouldResetShipRotationalData);\n    };\n\n    const shipCoordinates: CoordinatesArray =\n      ship.currentplacementConfigurations.coordinatesArray!;\n\n    removeShipFromBoard(shipCoordinates);\n    nullifyShipCoordinateSetValue(ship.type);\n    resetShipConfigurations(ship, shouldResetShipRotationalData);\n  }\n\n  public removeAllPieces(fleet: Fleet): void {\n    if (!Object.keys(fleet).length) {\n      console.error(\n        'Invalid Command: No ships to remove - Fleet is empty or uninitialized.'\n      );\n      return;\n    }\n\n    for (const ship of Object.values(fleet)) {\n      this.removePiece(ship);\n    }\n  }\n\n  public rotatePiece(ship: BattleshipBuilder): void {\n    const getNextAngle = (\n      rotationalPositionMap: RotationalPositionMap,\n      currentAngle: AngleOfRotation\n    ): AngleOfRotation => {\n      if (currentAngle === null || currentAngle === undefined)\n        throw new Error(\"Current angle doesn't exist\");\n\n      const angles: AnglesOfRotation[] = Array.from(\n        rotationalPositionMap.keys()\n      );\n\n      return (\n        angles.find((angle) => angle > currentAngle) ??\n        AnglesOfRotation.Degrees0\n      );\n    };\n    const getMaxAngle = (\n      rotationalPositionMap: RotationalPositionMap\n    ): AngleOfRotation =>\n      Array.from(rotationalPositionMap.keys()).pop() ??\n      AnglesOfRotation.Degrees0;\n    const getNextPiecePlacementParams = (\n      ship: BattleshipBuilder,\n      rotationalPositionMap: RotationalPositionMap\n    ): IPlacePieceWrapperParams => {\n      const currentAngle: AngleOfRotation =\n        ship.rotationalPivotConfigurations.transientAngleOfRotation;\n\n      const maxAngle: AngleOfRotation = getMaxAngle(rotationalPositionMap);\n\n      if (currentAngle === maxAngle) {\n        const originalBowCoordinates: Coordinates =\n          ship.rotationalPivotConfigurations.coordinatesArray![0];\n        const originalOrientation: Orientation =\n          ship.rotationalPivotConfigurations.orientation!;\n\n        // set current degree of rotation\n        ship.rotationalPivotConfigurations.transientAngleOfRotation =\n          AnglesOfRotation.Degrees0;\n\n        return {\n          ship,\n          coordinates: originalBowCoordinates,\n          orientation: originalOrientation,\n        };\n      }\n\n      const nextAngle: AngleOfRotation = getNextAngle(\n        rotationalPositionMap,\n        currentAngle\n      );\n      const nextPlacePieceParams: IPlacePieceParams | undefined =\n        rotationalPositionMap.get(nextAngle!);\n\n      // set current degree of rotation\n      ship.rotationalPivotConfigurations.transientAngleOfRotation = nextAngle;\n\n      return {\n        ship,\n        coordinates: nextPlacePieceParams!.coordinates,\n        orientation: nextPlacePieceParams!.orientation,\n      };\n    };\n    const updateTransientPlacementParams = (\n      rotationalPositionMap: RotationalPositionMap\n    ): IPlacePieceWrapperParams => {\n      let nextPlacePieceParams: IPlacePieceWrapperParams =\n        getNextPiecePlacementParams(ship, rotationalPositionMap);\n\n      while (\n        ship.rotationalPivotConfigurations.transientAngleOfRotation !==\n        initialAngle\n      ) {\n        if (\n          this.isRotatedPositionValid(\n            nextPlacePieceParams.coordinates,\n            nextPlacePieceParams.orientation,\n            ship.rotationalPivotConfigurations.transientAngleOfRotation,\n            ship.length\n          )\n        ) {\n          break;\n        }\n        nextPlacePieceParams = getNextPiecePlacementParams(\n          ship,\n          rotationalPositionMap\n        );\n      }\n\n      return nextPlacePieceParams;\n    };\n\n    const rotationalPositionMap: RotationalPositionMap =\n      this.playerState.gameboardRepository.inBoundRotationalPlacePieceForFleet[\n        ship.type\n      ]!;\n\n    const initialAngle =\n      ship.rotationalPivotConfigurations.transientAngleOfRotation;\n\n    /* \n    \n     The coolest part of this whole transient concept is that it                  \n     allows me to name a variable `finalPlacePieceParams` which implies a         \n     predetermined value, with a function named `updateTransientPlacementParams` \n     which implies something transient while the semantic naming of the           \n    | key-value pair maintain sound logicality. I am intuit. -                   \n    \n    */\n\n    const finalPlacePieceParams: IPlacePieceWrapperParams =\n      updateTransientPlacementParams(rotationalPositionMap);\n\n    if (\n      ship.rotationalPivotConfigurations.transientAngleOfRotation ===\n      initialAngle\n    ) {\n      console.warn('No valid rotational position found.');\n      return;\n    }\n\n    const shouldResetShipRotationalData: boolean = false;\n\n    this.relocateShip(\n      ship,\n      finalPlacePieceParams,\n      shouldResetShipRotationalData\n    );\n  }\n\n  //  --------------------------------------------------------------\n  //  Private\n\n  private areCoordinatesVacant(coordinates: Coordinates): boolean {\n    const [x, y] = coordinates;\n    return (\n      this.playerState.gameboardBuilder.board[y][x] ===\n      this.playerState.gameboardBuilder.fillValue\n    );\n  }\n\n  private getShipAt(coordinates: Coordinates): BattleshipBuilder | null {\n    if (this.areCoordinatesVacant(coordinates)) return null;\n\n    const gameboard = this.playerState.gameboardBuilder.board;\n    const [x, y]: Coordinates = coordinates;\n\n    const shipSymbolValue: ShipSymbolValue = gameboard[y][x];\n    const shipType: ShipType = this.getShipTypeFromSymbol(shipSymbolValue);\n\n    const ship: BattleshipBuilder = this.playerState.fleetBuilder.getShip(shipType);\n\n    return ship;\n  }\n\n  private getShipTypeFromSymbol = (shipSymbol: ShipSymbolValue) => {\n    if (!isShipSymbolDescription(shipSymbol.description))\n      throw new Error('Invalid ship symbol description');\n    const shipSymbolDescription: ShipSymbolDescription = shipSymbol.description; // ? Create Type\n\n    switch (shipSymbolDescription) {\n      case 'CA':\n        return ShipType.Carrier;\n      case 'DD':\n        return ShipType.Destroyer;\n      case 'SB':\n        return ShipType.Submarine;\n      case 'BS':\n        return ShipType.Battleship;\n      case 'CR':\n        return ShipType.Cruiser;\n      case 'PB':\n        return ShipType.PatrolBoat;\n      default:\n        throw new Error(\n          'The symbol description does not return valid ship type.'\n        );\n    }\n  };\n\n  private isRotatedPositionValid = (\n    [x, y]: Coordinates,\n    orientation: Orientation,\n    angleOfRotation: AngleOfRotation,\n    shipLength: ShipLength\n  ): boolean => {\n    const isHorizontal = orientation === 'horizontal';\n    const gameboardSize = this.playerState.gameboardBuilder.boardSize;\n    const gameboard = this.playerState.gameboardBuilder.board;\n    const fillValue = this.playerState.gameboardBuilder.fillValue;\n    const newAxisIndexStart = isHorizontal ? x : y;\n\n    let i: number;\n    let axisIndexEnd: number;\n\n    if (\n      (!isHorizontal && angleOfRotation === AnglesOfRotation.Degrees90) ||\n      (isHorizontal && angleOfRotation === AnglesOfRotation.Degrees270) ||\n      angleOfRotation === AnglesOfRotation.Degrees0\n    ) {\n      i = 1;\n      axisIndexEnd = shipLength;\n    } else {\n      i = 0;\n      axisIndexEnd = shipLength - 1;\n    }\n\n    if (newAxisIndexStart + shipLength - 1 >= gameboardSize) return false;\n\n    for (i; i < axisIndexEnd; i++) {\n      const cellValue = isHorizontal\n        ? gameboard[y][x + i]\n        : gameboard[y + i][x];\n\n      if (cellValue !== fillValue) return false;\n    }\n\n    return true;\n  };\n\n  private getRotatedPlacePieceParams(ship: BattleshipBuilder) {\n    const applyOffsetToCoordinate = (\n      coordinate: number,\n      shipLength: ShipLength\n    ): number => {\n      const offset: number = shipLength - 1;\n      return coordinate - offset;\n    };\n    const determineRotatedOrientation = (\n      angleOfRotation: AngleOfRotation,\n      isHorizontal: boolean\n    ): Orientation => {\n      return isHorizontal\n        ? angleOfRotation === AnglesOfRotation.Degrees180\n          ? 'horizontal'\n          : 'vertical'\n        : angleOfRotation === AnglesOfRotation.Degrees180\n        ? 'vertical'\n        : 'horizontal';\n    };\n    const getRotatedBowCoordinates = (\n      angleOfRotation: AngleOfRotation,\n      isHorizontal: boolean,\n      [x, y]: Coordinates\n    ): RotatedCoordinatesValue => {\n      if (\n        angleOfRotation === AnglesOfRotation.Degrees0 ||\n        (angleOfRotation === AnglesOfRotation.Degrees90 && isHorizontal) ||\n        (angleOfRotation === AnglesOfRotation.Degrees270 && !isHorizontal)\n      ) {\n        return rotationalPivotBowCoordinates;\n      }\n\n      const rotatedBowCoordinates: Coordinates = isHorizontal\n        ? angleOfRotation === AnglesOfRotation.Degrees180\n          ? [applyOffsetToCoordinate(x, ship.length), y]\n          : [x, applyOffsetToCoordinate(y, ship.length)] // angleOfRotation === 270\n        : angleOfRotation === AnglesOfRotation.Degrees180\n        ? [x, applyOffsetToCoordinate(y, ship.length)]\n        : [applyOffsetToCoordinate(x, ship.length), y]; // angleOfRotation === 90\n\n      return areCoordinatesInBounds(\n        rotatedBowCoordinates,\n        this.playerState.gameboardBuilder.boardSize\n      )\n        ? rotatedBowCoordinates\n        : 'outOfBounds';\n    };\n    const createRotatedPiecePlacementParams = (\n      rotationalPivotBowCoordinates: Coordinates,\n      rotationalPivotOrientation: Orientation\n    ): RotatedPlacePieceParams => {\n      const isHorizontal = rotationalPivotOrientation === 'horizontal';\n\n      const rotatedPiecePlacementParams: RotatedPlacePieceParams = {};\n\n      const anglesOfRotation: AnglesOfRotation[] = [\n        AnglesOfRotation.Degrees0,\n        AnglesOfRotation.Degrees90,\n        AnglesOfRotation.Degrees180,\n        AnglesOfRotation.Degrees270,\n      ];\n\n      anglesOfRotation.forEach((angleOfRotation) => {\n        const coordinates: RotatedCoordinatesValue =\n          angleOfRotation === AnglesOfRotation.Degrees0\n            ? rotationalPivotBowCoordinates\n            : getRotatedBowCoordinates(\n                angleOfRotation,\n                isHorizontal,\n                rotationalPivotBowCoordinates\n              );\n\n        if (coordinates === 'outOfBounds') {\n          rotatedPiecePlacementParams[angleOfRotation] = 'outOfBounds';\n        } else {\n          rotatedPiecePlacementParams[angleOfRotation] = {\n            coordinates,\n            orientation:\n              angleOfRotation === AnglesOfRotation.Degrees0\n                ? rotationalPivotOrientation\n                : determineRotatedOrientation(angleOfRotation, isHorizontal),\n          };\n        }\n      });\n\n      return rotatedPiecePlacementParams;\n    };\n    const generateRotationalPositionMap = (\n      rotatedPiecePlacementParams: RotatedPlacePieceParams\n    ): RotationalPositionMap => {\n      const rotatedPlacePieceParams: RotationalPositionMap = new Map();\n\n      for (const angleOfRotationString of Object.keys(\n        rotatedPiecePlacementParams\n      )) {\n        const angleOfRotationToNum = +angleOfRotationString as AngleOfRotation;\n\n        if (!isAngleOfRotation(angleOfRotationToNum)) {\n          throw new Error(\n            `Invalid Type: \"${angleOfRotationString}\" doesn't conform to \"AngleOfRotation\".`\n          );\n        }\n\n        const rotatedPlacePieceParamsValue: RotatedPlacePieceParamsValue =\n          rotatedPiecePlacementParams[angleOfRotationToNum]!;\n\n        if (\n          !(\n            isPlacePieceParams(rotatedPlacePieceParamsValue) ||\n            isOutOfBounds(rotatedPlacePieceParamsValue)\n          )\n        ) {\n          throw new Error(\n            `Invalid Type: \"${rotatedPlacePieceParamsValue}\" doesn't conform to \"RotatedPlacePieceParams\".`\n          );\n        }\n\n        if (!isPlacePieceParams(rotatedPlacePieceParamsValue)) continue;\n\n        const { coordinates: bowCoordinates, orientation }: IPlacePieceParams =\n          rotatedPlacePieceParamsValue;\n\n        const placePieceParams: IPlacePieceParams = {\n          coordinates: bowCoordinates,\n          orientation,\n        };\n\n        rotatedPlacePieceParams.set(angleOfRotationToNum, placePieceParams);\n      }\n\n      return rotatedPlacePieceParams;\n    };\n\n    const rotationalPivotBowCoordinates: Coordinates =\n      ship.rotationalPivotConfigurations.coordinatesArray![0];\n    const rotationalPivotOrientation: Orientation =\n      ship.rotationalPivotConfigurations.orientation!;\n    const rotatedPiecePlacementParams: RotatedPlacePieceParams =\n      createRotatedPiecePlacementParams(\n        rotationalPivotBowCoordinates,\n        rotationalPivotOrientation\n      );\n\n    const rotatedPlacePieceParamsMap: RotationalPositionMap =\n      generateRotationalPositionMap(rotatedPiecePlacementParams);\n\n    return rotatedPlacePieceParamsMap;\n  }\n\n  private isShipValidForRemoval(ship: BattleshipBuilder): boolean {\n    if (\n      !ship.currentplacementConfigurations.coordinatesArray ||\n      !this.playerState.gameboardRepository.isShipPlaced(ship.type)\n    ) {\n      console.error(\n        `Error removing ship: ${ship.type} is missing coordinates or not in the fleet.`\n      );\n      return false;\n    }\n\n    return true;\n  }\n\n  private relocateShip(\n    ship: BattleshipBuilder,\n    placementParameters: IPlacePieceWrapperParams,\n    shouldResetShipRotationalData: boolean\n  ): void {\n    this.removePiece(ship, shouldResetShipRotationalData);\n    this.placePiece(placementParameters);\n  }\n\n  private setFleetRotatedPlacePieceParams(fleet: Fleet): void {\n    for (const ship of Object.values(fleet)) {\n      if (ship.isPlaced()) this.setShipRotatedPlacePieceParams(ship);\n    }\n  }\n\n  private setShipRotatedPlacePieceParams(ship: BattleshipBuilder): void {\n    const rotatedPlacePieceParams: RotationalPositionMap =\n      this.getRotatedPlacePieceParams(ship);\n\n    this.playerState.gameboardRepository.setShipValidRotationalParams(\n      ship,\n      rotatedPlacePieceParams\n    );\n  }\n}\n","import {\n  AxisArrayKey,\n  Coordinates,\n  Gameboard,\n  IValidPlacementCallbackParams,\n  IValidPositionsResult,\n  Orientation,\n  PositionArray,\n  ShipLength,\n} from '../../../../types/logic-types';\n\nexport function getValidShipPositions({\n  shipLength,\n  orientation,\n  battleshipBoardBuilder\n}: IValidPlacementCallbackParams): IValidPositionsResult {\n  const extractAxisArray = (\n    axisIndex: number,\n    orientation: Orientation,\n    gameboard: Gameboard\n  ): Array<symbol> => { // or symbol[]\n    \n    return orientation === 'horizontal'\n      ? gameboard[axisIndex] // Returns row #<axisIndex>\n      : gameboard.map(row => row[axisIndex]) // `y` values at column-<axisIndex>\n  };\n  const findValidPositionsInAxis = (\n    axisArray: Array<symbol>, // or symbol[]\n    isHorizontal: boolean,\n    axisIndex: number,\n    shipLength: ShipLength\n  ): PositionArray => {\n    let streak: number = 0;\n    let validAxisPositions: PositionArray = [];\n    \n    for (let i = 0; i < axisArray.length; i++) {\n      if (axisArray[i] === battleshipBoardBuilder.fillValue) {\n        streak++;\n        \n        if (streak >= shipLength) {\n          const bowPosition: Coordinates =\n            isHorizontal\n            ? [i - (shipLength - 1), axisIndex]\n            : [axisIndex, i - (shipLength - 1)];\n          \n          const sternPosition: Coordinates =\n            isHorizontal\n              ? [i, axisIndex]\n              : [axisIndex, i];\n\n          validAxisPositions.push({\n            bow: bowPosition,\n            stern: sternPosition,\n          });\n        }\n      } else {\n        streak = 0;\n      }\n    }\n    \n    return validAxisPositions;\n  };\n\n  const validPositionsPerAxis: IValidPositionsResult = {}; \n  const board: Gameboard = battleshipBoardBuilder.board;\n  const isHorizontal = orientation === 'horizontal';\n\n  for (let axisIndex = 0; axisIndex < board.length; axisIndex++) {\n    const axisArray: Array<symbol> = extractAxisArray(axisIndex, orientation, board);\n    const validPositions: PositionArray = findValidPositionsInAxis(\n      axisArray,\n      isHorizontal,\n      axisIndex,\n      shipLength\n    );\n    \n    const axisTemplate: AxisArrayKey =\n      isHorizontal\n        ? `row-${axisIndex}`\n        : `column-${axisIndex}`;\n    \n    validPositionsPerAxis[axisTemplate] = validPositions;\n  }\n\n  return validPositionsPerAxis;\n}","import {\n  AnglesOfRotation,\n  AxisArrayKey,\n  Coordinates,\n  CoordinatesArray,\n  Gameboard,\n  IPlacementConfigurations,\n  IPlacePieceCallbackParams,\n  IPosition,\n  IShipPlacementConfigurations,\n  IValidPositionsResult,\n  Orientation,\n  ShipLength,\n  ShipSymbolValue,\n  ShipType,\n} from '../../../../types/logic-types';\nimport { arePositionsEqual, createPositionObject, isCoordinateInBounds } from '../../../../utilities/logic-utilities';\nimport { BattleshipBuilder } from '../../../bs-ship-builder/bs-ship-builder';\n\nexport function placeShip({\n  ship,\n  coordinates,\n  orientation,\n  battleshipBoardController,\n  battleshipBoardBuilder,\n  battleshipBoardRepository\n}: IPlacePieceCallbackParams): void {  \n  const shipLength: ShipLength = ship.length;\n  const [bowX, bowY]: Coordinates = coordinates;\n  const isHorizontal: boolean = orientation === 'horizontal';\n  const axisStart: number = isHorizontal ? bowX : bowY;\n  const axisEnd = axisStart + shipLength - 1;\n\n  if (!isCoordinateInBounds(axisEnd, battleshipBoardBuilder.boardSize)) {\n    const errorMessage: string = `Invalid Command: The ship placement attempt with the following configurations is out of bounds - Coordinates: ${coordinates}, Length: ${ship.length}, Orientation: ${orientation}.`;\n    throw new Error(errorMessage);\n  };\n\n  if (ship.isPlaced()) {\n    console.warn(`Invalid Command: The ${ship.type} has already been placed.`);\n    return;\n  };\n\n  const isPositionValid = (\n    position: IPosition,\n    shipConfigurations: IShipPlacementConfigurations,\n    axisArrayKey: AxisArrayKey\n  ): boolean => {\n    const validPositions: IValidPositionsResult =\n      battleshipBoardController.getValidPositions(shipConfigurations);\n\n    return validPositions[axisArrayKey].some((validPosition: IPosition) =>\n      arePositionsEqual(position, validPosition)\n    );\n  };\n\n  const position: IPosition = createPositionObject(\n    coordinates,\n    orientation,\n    shipLength,\n  );\n\n  const shipConfigurations: IShipPlacementConfigurations = {\n    shipLength,\n    orientation\n  };\n  const axisArrayKey: AxisArrayKey = isHorizontal\n    ? `row-${bowY}`\n    : `column-${bowX}`; \n    \n  if (isPositionValid(position, shipConfigurations, axisArrayKey)) {\n    const getPlacementCoordinates = (\n      validPosition: IPosition,\n      isHorizontal: Boolean\n    ): CoordinatesArray => {\n      const placementCoordinates: CoordinatesArray = [];\n\n      const [bowX, bowY]: Coordinates = validPosition.bow;\n      const [sternX, sternY]: Coordinates = validPosition.stern;\n\n      const primary: number = isHorizontal\n        ? bowY\n        : bowX;\n      const axisStart: number = isHorizontal\n        ? bowX\n        : bowY;\n      const axisEnd: number = isHorizontal\n        ? sternX\n        : sternY;\n\n      for (let i = axisStart; i <= axisEnd; i++) {\n        placementCoordinates.push(isHorizontal ? [i, primary] : [primary, i]);\n      }\n\n      return placementCoordinates;\n    };\n    const placeOnBoard = (\n      ship: BattleshipBuilder,\n      shipPlacementCoordinates: CoordinatesArray\n    ): void => {\n      const gameboard: Gameboard = battleshipBoardBuilder.board;\n      const shipSymbol: ShipSymbolValue = ship.symbol;\n\n      shipPlacementCoordinates.forEach((coordinates) => {\n        const [x, y]: Coordinates = coordinates;\n        gameboard[y][x] = shipSymbol;\n      });\n    };\n    const setShipConfigurations = (\n      ship: BattleshipBuilder,\n      coordinatesArray: CoordinatesArray,\n      orientation: Orientation\n    ): void => {\n      const placementConfigurations: IPlacementConfigurations = { coordinatesArray, orientation };\n      \n      ship.currentplacementConfigurations = placementConfigurations;\n\n      if (Object.values(ship.rotationalPivotConfigurations).every(value => value === null)) {\n        ship.rotationalPivotConfigurations = {\n          ...placementConfigurations,\n          transientAngleOfRotation: AnglesOfRotation.Degrees0,\n        }\n      }      \n    };\n    const updateOccupiedCoordinatesSet = (\n      shipType: ShipType,\n      placementCoordinates: CoordinatesArray\n    ): void => {\n      battleshipBoardRepository.addShipToFleetCoordinates(\n        shipType,\n        placementCoordinates\n      );\n    };\n\n    const placementCoordinates: CoordinatesArray = getPlacementCoordinates(\n      position,\n      isHorizontal\n    );\n\n    placeOnBoard(ship, placementCoordinates);\n    setShipConfigurations(\n      ship,\n      placementCoordinates,\n      orientation\n    );\n    updateOccupiedCoordinatesSet(ship.type, placementCoordinates);\n  } else {\n    const errorMessage: string = `Invalid Command: \"${JSON.stringify(\n      position\n    )}\" is unavailable for ship with Size: ${shipLength} and Orientation: ${orientation}.`;\n\n    throw new Error(errorMessage);\n  }\n}\n","import { BattleshipBuilder } from \"../bs-ship-builder/bs-ship-builder\";\nimport {\n  Coordinates,\n  CoordinatesArray,\n  CoordinatesToString,\n  FleetCoordinates,\n  InBoundRotationalPlacePieceParamsForFleet,\n  ShipType,\n  RotationalPositionMap\n} from \"../../types/logic-types\";\n\nexport class BattleshipBoardRepository {\n  readonly #fleetCoordinates: FleetCoordinates = {};\n  readonly #inBoundRotationalPlacePieceParamsForFleet: InBoundRotationalPlacePieceParamsForFleet =\n    {};\n  readonly #attackedCoordinates: Set<CoordinatesToString> = new Set();\n  readonly #sunkShips: Set<ShipType> = new Set();\n\n  //  --------------------------------------------------------------\n\n  public get fleetCoordinates(): FleetCoordinates {\n    return this.#fleetCoordinates;\n  }\n\n  public get inBoundRotationalPlacePieceForFleet(): InBoundRotationalPlacePieceParamsForFleet {\n    return this.#inBoundRotationalPlacePieceParamsForFleet;\n  }\n\n  public addAttackedCoordinates(coordinates: Coordinates): void {\n    this.#attackedCoordinates.add(`[${coordinates[0]}, ${coordinates[1]}]`);\n  }\n\n  public addShipToFleetCoordinates(\n    shipType: ShipType,\n    placementCoordinates: CoordinatesArray\n  ): void {\n    if (!this.fleetCoordinates[shipType]) {\n      this.fleetCoordinates[shipType] = new Set();\n    }\n\n    placementCoordinates.forEach((coordinates: Coordinates) => {\n      const [x, y]: Coordinates = coordinates;\n      const setMemberTemplate: CoordinatesToString = `[${x}, ${y}]`;\n      this.fleetCoordinates[shipType]!.add(setMemberTemplate);\n    });\n  }\n\n  public addSunkenShip(shipType: ShipType) {\n    this.#sunkShips.add(shipType);\n  }\n\n  public areAllShipsSunk(): boolean {\n    return this.#sunkShips.size === Object.keys(this.fleetCoordinates).length;\n  }\n\n  public isShipPlaced(shipType: ShipType): boolean {\n    return this.fleetCoordinates[shipType] !== null;\n  }\n\n  public nullifyShipCoordinatesValue(shipType: ShipType): void {\n    this.fleetCoordinates[shipType] = null;\n  }\n\n  public nullifyShipValidRotationalParams(shipType: ShipType): void {\n    this.inBoundRotationalPlacePieceForFleet[shipType] = null;\n  }\n\n  public setShipValidRotationalParams(\n    ship: BattleshipBuilder,\n    validRotatedPlacePieceParams: RotationalPositionMap\n  ): void {\n    if (!this.#inBoundRotationalPlacePieceParamsForFleet[ship.type])\n      this.#inBoundRotationalPlacePieceParamsForFleet[ship.type] =\n        validRotatedPlacePieceParams;\n  }\n\n  public hasTargetBeenAttacked(coordinates: Coordinates): boolean {\n    return this.#attackedCoordinates.has(\n      `[${coordinates[0]}, ${coordinates[1]}]`\n    );\n  }\n}","import { BattleshipFleetBuilder } from \"../logic/bs-fleet-builder/bs-fleet-builder\";\nimport { BattleshipBoardBuilder } from \"../logic/bs-gameboard-builder/bs-gameboard-builder\";\nimport { BattleshipBoardController } from \"../logic/bs-gameboard-controller/bs-gameboard-controller\";\nimport { BattleshipBoardRepository } from \"../logic/bs-gameboard-repository/bs-gameboard-repository\";\nimport { FleetVersion } from \"../types/logic-types\";\nimport { PlayerContext, PlayerCore } from \"../types/state-types\";\n\nexport const createPlayerContext = (fleetVersion: FleetVersion) => { \n  const gameboardBuilder = new BattleshipBoardBuilder();\n  const gameboardRepository = new BattleshipBoardRepository();\n\n  let fleetBuilder: BattleshipFleetBuilder;\n  switch (fleetVersion) {\n    case 1990:\n      fleetBuilder = BattleshipFleetBuilder.createMBFleet();\n      break;\n    case 2002:\n      fleetBuilder = BattleshipFleetBuilder.createHasbroFleet();\n      break;\n    default:\n      throw new Error(`There was no Battleship version created in ${fleetVersion}.`);\n  }\n\n  const gameboardController = new BattleshipBoardController({\n    gameboardBuilder,\n    gameboardRepository,\n    fleetBuilder\n  });\n\n  return {\n    gameboardBuilder,\n    gameboardRepository,\n    fleetBuilder,\n    gameboardController,\n  }\n}\n\nexport const initalizePlayerCore = (fleetVersion: FleetVersion): PlayerCore => {\n  const playerContext = createPlayerContext(fleetVersion);\n  const opponentContext = createPlayerContext(fleetVersion);\n\n  return {\n    player: playerContext,\n    opponent: opponentContext,\n  }\n}","import { DOMController } from './typescript/meta/dom-controller';\nimport { GameState } from './typescript/state/game-state';\nimport EventBus from './typescript/utilities/event-bus';\nimport { BillowBot } from './typescript/services/billow';\nimport { FleetVersion } from './typescript/types/logic-types';\nimport { PlayerCore } from './typescript/types/state-types';\nimport { initalizePlayerCore } from './typescript/state/player-state';\nimport { randomizeBSGameboards } from './typescript/meta/init/randomize-gameboard';\n\nexport class App {\n  // Instantiate foundational dependencies\n  public readonly isMultiplayer: boolean = false;\n  public readonly version: FleetVersion = 1990;\n  public eventBus: EventBus = new EventBus();\n  public playerCore: PlayerCore = initalizePlayerCore(this.version);\n\n  // Runtime-initialized components\n  public readonly gameState: GameState;\n  public billowBot: BillowBot | null;\n  public domController: DOMController;\n\n  private constructor() {\n    randomizeBSGameboards(this.playerCore);\n\n    this.gameState = new GameState(\n      this.playerCore,\n      this.eventBus,\n      this.isMultiplayer,\n      this.version\n    );\n    this.billowBot = !this.isMultiplayer\n      ? new BillowBot(this.gameState)\n      : null;\n    this.domController = new DOMController(\n      this.gameState,\n      this.playerCore,\n      this.billowBot\n    );\n  }\n\n  public static pressStart() {\n    const app = new App();\n    app.bootUp();\n    return app;\n  }\n\n  public bootUp = (): void => {\n    console.time('bootUp');\n    this.domController.render();\n    console.timeEnd('bootUp');\n  };\n}\n\nconsole.time('pressStart');\nApp.pressStart(); \nconsole.timeEnd('pressStart');","import { randomizeBSGameboard } from \"../../setup/randomize-bs-gameboard\";\nimport { Orientation } from \"../../types/logic-types\";\nimport { PlayerCore } from \"../../types/state-types\";\n\nexport const randomizeBSGameboards = (playerCore: PlayerCore) => {\n  const { player, opponent } = playerCore;\n\n  randomizeBSGameboard(\n    player.gameboardController,\n    player.fleetBuilder.fleet\n  );\n  randomizeBSGameboard(\n    opponent.gameboardController,\n    opponent.fleetBuilder.fleet\n  );\n\n  /**\n   *  TESTING ONLY: Force-place opponent ships in visible vertical line\n   * to speed up gameplay and observe endgame scenarios faster.\n   * (Couldve just toggled visibility via CSS but here we are.)\n   */\n  // Object.values(opponent.fleetBuilder.fleet).forEach((ship, index) => {\n  //   opponent.gameboardController.placePiece({\n  //     ship,\n  //     coordinates: [index, 0],\n  //     orientation: 'vertical',\n  //   });\n  // });\n};\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","CycloneLightboxController","dialogState","isDialogOpen","isEscapeKeyListenerAttached","isCloseButtonListenerAttached","constructor","dialogElement","dialogCloseButtonID","dialogInDocumentBody","this","id","Error","dialogId","dialogCloseButton","dsGetCloseButton","dsAddCloseButtonAria","closeButtonListener","closeLightbox","bind","escapeKeyListener","dsHandleEscapeKey","observeDialogRemoval","openLightbox","showModal","dsAddListeners","requestAnimationFrame","classList","add","addEventListener","remove","close","dsRemoveListeners","once","isOpen","window","removeEventListener","closeButtonId","closeButton","querySelector","setAttribute","event","preventDefault","observer","MutationObserver","mutations","mutation","Array","from","removedNodes","forEach","node","disconnect","observe","document","body","childList","subtree","areArraysEqual","arrayOne","arrayTwo","length","every","value","index","capitalize","str","charAt","toUpperCase","slice","toLowerCase","getConvertedTypeFromAttr","element","attribute","typeGuard","attrValue","getAttribute","getRandomInt","min","max","Math","floor","random","createElement","tag","classes","attributes","cls","entries","sleep","ms","Promise","resolve","setTimeout","waitForTransitionEnd","timeout","expectedCount","callback","resolved","transitionCount","cleanup","handler","clearTimeout","timer","undefined","target","setAttributes","createMainOneParabellumFragment","instructionsButton","parabellumHeading","textContent","mainContainerOneParabellumWrapper","append","render","parabellumFragment","DocumentFragment","createMainOneBellumFragment","sitRepScrollerController","latestUpdatesHeading","mainContainerOneBellumWrapper","bellumFragment","appendChild","createMainOnePostBellumFragment","victoryBanner","mainContainerPostBellumWrapper","postBellumFragment","CycloneHotSwapContainer","elementTag","fragments","initialFragmentKey","classNames","hotSwapContainer","fragmentsArray","values","setInitialIndex","targetElement","swapFragmentByKey","fragment","getFragment","swapFragment","indexOf","swapByOrder","initialIndex","replaceChildren","CycloneTextComponent","initialText","getElement","resetText","updateText","newText","CycloneReactiveText","eventBus","rowName","super","updateTextWrapper","init","on","destroy","off","AnglesOfRotation","ShipType","isCoordinates","isArray","coordinate","isHTMLDivElement","el","HTMLDivElement","isHTMLElement","HTMLElement","isOrientation","includes","isOutOfBounds","isPlacePieceParams","coordinates","isPosition","proto","getPrototypeOf","isPlainObject","bow","stern","isShipType","gameboardStateValue","PlayerGameboardComponent","fleetElements","Map","listenersAdded","dragState","currentShipInstance","initialPlacementConfigurations","isValidDropTarget","currentDragOverCell","cloneSnapOffset","shipBorderValueSplit","dragEventCallbacks","dragstart","e","handleShipDragStart","drag","handleShipDrag","dragenter","handleShipDragEnter","dragleave","handleShipDragLeave","dragover","handleShipDragOver","drop","handleShipDrop","dragend","handleShipDragEnd","playerState","gameState","gameboardContainer","generateBoardContainer","gameboardBuilder","boardSize","gameboard","generateBoardFragment","dragImage","createDragImage","shipDragClone","createShipDragClone","refreshGameboardWrapper","toggleGameboardControls","receiveAttack","handleFleetPlacement","fleetBuilder","toggleParabellumListeners","method","handleShipRotation","togglePlayerTurn","attackResult","hit","isSunk","isGameOver","emit","transitionToNextPhase","toggleShipsDraggable","shipElement","removeAttribute","toggleShipAdriftClass","applyGridPlacementValue","gridPlacementValue","gridCrossAxis","orientation","shipLength","style","gridColumn","gridRow","toString","gridTemplateColumns","gridTemplateRows","gameboardRepository","areAllShipsSunk","src","createBackgroundCellsFragment","cellFragment","row","rowIndex","symbol","colIndex","symbolDescription","description","hitMarker","gridCell","role","gridCellContainer","createShipElement","shipType","shipUnitFragment","generateShipUnitFragment","shipContainerElement","draggable","syncShipUnitDataAttributes","setProperty","gameboardBackground","board","boardFragment","i","isBow","isStern","shipUnit","getGridPlacementValue","isHorizontal","x","y","getShipPlacementData","ship","getShip","coordinatesArray","currentplacementConfigurations","type","bowCoordinates","updateFleetElements","placeFleetOnGameboard","cookShipUnit","attackCoordinates","attackedShipUnit","console","warn","handleSinkingShip","async","sinkShip","hasTargetBeenAttacked","alreadyAttacked","addAttackedCoordinates","_receiveAttack","gridCellDataKey","gameboardController","triggerPrePlayerToggleAnimations","error","refreshGameboard","boardContainer","removeChild","setFleetElement","set","shipUnitElements","children","filter","isHTMLDivElementArray","unit","String","DELAY_AFTER_TRANSITION_SECOND","newGameboardState","toggle","inactive","uiUpdate","updateUIPostAttack","sitRepUpdate","all","size","clear","fleet","playerType","matches","getCloneSnapOffset","shipBow","getShipBow","match","getComputedStyle","documentElement","getPropertyValue","trim","groups","offsetX","offsetY","getBoundingClientRect","width","height","Number","numberValue","updateDragState","JSON","stringify","removePiece","dataTransfer","setDragImage","setCloneDimensions","shipContainer","shipClone","shipBoundingRect","setInitialDragStyles","classifyValidCellCoordinates","shipLengthAttr","classifyValidBowCells","gridCells","allValidBowCoordinates","getAllValidBowCoordinates","gridCellCoordinates","validBowCoordinates","querySelectorAll","snapCloneToCursor","areValidBowCoordinates","contains","initialOrientation","validGridCell","xAttr","yAttr","newCoordinates","placePiece","resetShipPosition","initialBowCoordinates","removeDragStyles","cellFeedbackClass","rotatePiece","gameboardClientRect","gameboardOffsetX","left","gameboardOffsetY","top","cursorX","clientX","cursorY","clientY","getId","OpponentGameboardComponent","toggleBellumListeners","handleCellClick","cookAllShipUnits","shipUnits","lastUnit","_","getAttackCoordinates","dataX","dataY","getGridAreaValue","revealShipPosition","setGridPlacementValue","waitForEvent","eventType","active","MainContainerTwo","playerCore","playerGameboardComponent","player","opponentGameboardComponent","opponent","mainContainerTwo","playerGameboard","opponentGameboard","randomizeBSGameboard","getValidCoordinatesRecursively","attempts","generateRandomCoordinates","areCoordinatesValid","validPositionsParams","validPositions","getValidPositions","bowX","bowY","axisIndex","some","position","randomOrientation","placePieceParams","ShipShufflerButtonComponent","shipShufflerButtonTextContent","buttonClass","shuffleShips","randomizeGameboard","updateGameboard","shipShufflerButton","createshipShufflerButton","toggleEventListener","shipShufflerButtonContainer","createshipShufflerButtonContainer","removeAllPieces","ReadyUpButtonComponent","readyUpButtonTextContent","buttonId","readyUp","anchorShips","removeParabellumButtonListeners","transitionToBellum","readyUpButton","createReadyUpButton","readyUpButtonContainer","createReadyUpButtonContainer","readyUpTextSpan","inactiveReadyUpButton","alt","activeReadyUpButton","button","ScoreBoardComponent","scoreBoardID","hitPointMap","battleship","carrier","cruiser","destroyer","patrolBoat","submarine","fleets","shipTypes","fleetStatusContainers","createFleetStatusContainers","shipLabelList","createShipLabelList","scoreBoardContainer","createScoreBoardContainer","markNextHitPoint","playerOneFleetStatusContainer","playerTwoFleetStatusContainer","createHitPointContainersFragment","hitPointsFragment","hitPointContainer","hitpointElement","storeShipHitPointData","createFleetStatusContainer","fleetStatusHeading","hitPointContainersFragment","fleetStatusContainer","map","shipLabelListItemsFragment","shipLabelListElement","hitMarkPayload","nextHitPoint","pop","reversedHitPointArray","reverse","createMainThreeParabellumFragment","mainContainerThreeParabellumWrapper","createMainThreeBellumFragment","scoreBoard","mainContainerThreeBellumWrapper","createMainThreePostBellumFragment","playAgainButton","App","pressStart","findNewOpponentButton","endGameButtonContainer","mainContainerThreePostBellumWrapper","SHIP_SYMBOLS","Carrier","Symbol","Battleship","Cruiser","Submarine","Destroyer","PatrolBoat","sizeLookup","BattleshipBuilder","seaworthy","rotationalPivotConfigurations","transientAngleOfRotation","isPlaced","_hitCounter","version","isSeaworthy","hitCounter","resetConfigurations","shouldResetShipRotationalData","placementConfigurations","BattleshipFleetBuilder","createFleet","fleetConfigs","config","createHasbroFleet","createMBFleet","static","getShipTypes","InstructionsComponent","buttonImageId","instructionsLightboxController","createInstructionsButton","instructionsButtonContainer","createInstructionsButtonContainer","openInstructionsDialog","MainComponent","mainElement","cycloneSitRepScroller","mainContainerOne","createMainContainerOne","mainContainerThree","createMainContainerThree","renderMainContainers","sitRepContainer","mainOneFragments","parabellum","bellum","postBellum","playerGameboardController","mainThreeFragments","InstructionsDialogComponent","instructionsDialogCloseButton","createInstructionsDialogCloseButton","instructionsDialog","createInstructionsDialog","tertiaryHeading","listItemFragment","generateListFragment","listItemTextContentArray","identifier","listFragment","listItem","listElement","instructionsListItemTextContentArray","instructionsList","unanchoredShipExample","unanchoredShipText","visualFeedbackKeyContainer","instructionsContentContainer","CycloneSitRepScroller","TURN","PLAYER","OPPONENT","ATTACK","HIT","subject","SUNK","MISS","currentPlayer","currentSitRep","nextSitRep","container","current","next","getControlledSitRepElements","sitRepTextElements","initialize","firstPlayer","setInitialTextContent","setAndScrollToNextSitRep","getNextSitRep","resetSitRepContainer","DELAY_AFTER_TRANSITION_SECONDS","getAttackSitRep","MESSAGES","toggleCurrentPlayer","toggleSitRepType","getTurnSitRep","message","currentTextContentElement","nextTextContentElement","currentSitRepContainer","nextSitRepContainer","textContentElement","sitRepContentContainer","DOMController","header","nav","headingLink","href","heading","gitHubLogoLink","color","gitHubUsername","projectName","pathOne","createElementNS","pathTwo","gInner","gOuter","stroke","fill","gitHubSVG","viewBox","xmlns","rel","createGitHubLink","createNav","createHeader","billowBot","content","getElementById","mainComponent","seatDomEventsOnBus","isMounted","firstChild","unmount","innerHTML","handlePhaseChangeUpdates","updatePhaseOfWarColor","currentGamePhase","updateGameboardContainerState","deployForCombat","initializeSitRepScroller","setInitialPlayer","readyPlayerOne","attack","updateUIActiveGameboard","phaseOfWar","GameState","getInitialPlayer","endGamePlayerShipPositions","isMultiplayer","resetGame","isPlayer","EventBus","events","eventName","fn","push","listener","data","BillowBot","Set","populatepossibleAttacksSet","determineNextTarget","rememberLastTargetHit","getNextAttackCoordinates","lastAttackCoordinates","wasLastTargetHit","getRandomCoordinates","ponder","timeCapsuleMS","coordinatesString","delete","split","getSmartCoordinates","lastAttackX","lastAttackY","BattleshipBoardBuilder","_boardSize","_fillValue","vacant","_board","fillValue","createPositionObject","isCoordinateInBounds","areCoordinatesInBounds","arePositionsEqual","positionOne","positionTwo","BattleshipBoardController","battleshipBoardBuilder","extractAxisArray","findValidPositionsInAxis","axisArray","streak","validAxisPositions","bowPosition","sternPosition","validPositionsPerAxis","getValidShipPositions","battleshipBoardController","positionsInAxis","movePiece","newBowCoordinates","currentOrientation","newPosition","isPositionInBounds","axisArrayKey","createAxisArrayKey","isNewPositionValid","placementParameters","relocateShip","battleshipBoardRepository","errorMessage","isPositionValid","shipConfigurations","validPosition","getPlacementCoordinates","placementCoordinates","sternX","sternY","primary","axisEnd","placeOnBoard","shipPlacementCoordinates","shipSymbol","setShipConfigurations","Degrees0","updateOccupiedCoordinatesSet","addShipToFleetCoordinates","placeShip","setFleetRotatedPlacePieceParams","prettyPrint","table","attackedShip","getShipAt","addSunkenShip","isShipValidForRemoval","shipCoordinates","removeShipFromBoard","nullifyShipCoordinatesValue","nullifyShipCoordinateSetValue","resetShipConfigurations","nullifyShipValidRotationalParams","keys","getNextPiecePlacementParams","rotationalPositionMap","currentAngle","maxAngle","getMaxAngle","originalBowCoordinates","originalOrientation","nextAngle","getNextAngle","find","angle","nextPlacePieceParams","inBoundRotationalPlacePieceForFleet","initialAngle","finalPlacePieceParams","isRotatedPositionValid","updateTransientPlacementParams","areCoordinatesVacant","shipSymbolValue","getShipTypeFromSymbol","angleOfRotation","gameboardSize","newAxisIndexStart","axisIndexEnd","Degrees90","Degrees270","getRotatedPlacePieceParams","applyOffsetToCoordinate","determineRotatedOrientation","Degrees180","getRotatedBowCoordinates","rotationalPivotBowCoordinates","rotatedBowCoordinates","rotationalPivotOrientation","rotatedPiecePlacementParams","createRotatedPiecePlacementParams","rotatedPlacePieceParamsMap","rotatedPlacePieceParams","angleOfRotationString","angleOfRotationToNum","rotatedPlacePieceParamsValue","generateRotationalPositionMap","isShipPlaced","setShipRotatedPlacePieceParams","setShipValidRotationalParams","BattleshipBoardRepository","fleetCoordinates","setMemberTemplate","validRotatedPlacePieceParams","has","createPlayerContext","fleetVersion","initalizePlayerCore","randomizeBSGameboards","domController","app","bootUp","time","timeEnd"],"sourceRoot":""}