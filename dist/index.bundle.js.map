{"version":3,"file":"index.bundle.js","mappings":"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","sources":["webpack://battleship/./src/typescript/utilities/random-utilities.ts","webpack://battleship/./src/typescript/types/logic-types.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-builder/bs-gameboard-builder.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-controller/bs-gameboard-controller.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-controller/helpers/get-valid-ship-positions/get-valid-ship-positions.ts","webpack://battleship/./src/typescript/utilities/logic-utilities.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-controller/helpers/place-ship/place-ship.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-repository/bs-gameboard-repository.ts","webpack://battleship/./src/typescript/logic/bs-ship-builder/bs-ship-builder.ts","webpack://battleship/./src/typescript/logic/bs-fleet-builder/bs-fleet-builder.ts","webpack://battleship/./src/typescript/setup/randomize-bs-gameboard.ts","webpack://battleship/./src/typescript/state/player-state.ts","webpack://battleship/./src/typescript/utilities/event-bus.ts","webpack://battleship/./src/app.ts","webpack://battleship/./src/typescript/components/gameboard-component/gameboard-component.ts","webpack://battleship/./src/typescript/components/ship-shuffler-component.ts"],"sourcesContent":["export const areArraysEqual = <T>(arrayOne: T[], arrayTwo: T[]) =>\n  arrayOne.length === arrayTwo.length\n  &&\n  arrayOne.every((value, index) => value === arrayTwo[index]);\n\nexport const getConvertedTypeFromAttr = <T extends string>(\n  element: HTMLElement,\n  attribute: string,\n  typeGuard: (value: string) => value is T\n): T => {\n  const attrValue = element.getAttribute(attribute);\n  if (!attrValue || !typeGuard(attrValue)) {\n    throw new Error(`Invalid or missing attribute: ${attribute}`);\n  }\n  return attrValue;\n};\n\nexport const getRandomInt = (min: number, max: number): number =>\n  Math.floor(Math.random() * (max - min + 1)) + min;\n\nexport const isEmptyObject = (obj: Record<PropertyKey, unknown>): boolean => {\n  return (\n    Object.keys(obj).length === 0 &&\n    Object.getOwnPropertySymbols(obj).length === 0\n  );\n};\n\nexport type Range<N extends number, Acc extends number[] = []> =\n  Acc['length'] extends N\n    ? Acc[number]\n    : Range<N, [...Acc, Acc['length']]>;\n    \n\nexport const createElement = <K extends keyof HTMLElementTagNameMap>(\n  tag: K,\n  classes: string[] = [],\n  attributes: Record<string, string> = {}\n): HTMLElementTagNameMap[K] => {\n  const element: HTMLElementTagNameMap[K] = document.createElement(tag);\n  classes.forEach((cls) => element.classList.add(cls));\n  Object.entries(attributes).forEach(([key, value]) =>\n    element.setAttribute(key, value)\n  );\n  return element;\n};\n\nexport const createPlayerIdentifier = (playerId: string, identifier: string): string => {\n  const playerNumberString: string = playerId.split('player')[1].toLowerCase();\n  return `player-${playerNumberString}-${identifier}`;\n};\n","import { BattleshipFleetBuilder } from '../logic/bs-fleet-builder/bs-fleet-builder';\nimport { BattleshipBoardBuilder } from '../logic/bs-gameboard-builder/bs-gameboard-builder';\nimport { BattleshipBoardController } from '../logic/bs-gameboard-controller/bs-gameboard-controller';\nimport { BattleshipBoardRepository } from '../logic/bs-gameboard-repository/bs-gameboard-repository';\nimport {\n  BattleshipBuilder,\n  SHIP_SYMBOLS\n} from '../logic/bs-ship-builder/bs-ship-builder';\nimport { PlayerState } from './state-types';\n\n// ðŸ’­ --------------------------------------------------------------\n// ðŸ’­ Enumerations\n\nexport enum AnglesOfRotation {\n  Degrees0 = 0,\n  Degrees90 = 90,\n  Degrees180 = 180,\n  Degrees270 = 270\n};\nexport enum ShipType {\n  Battleship = 'battleship',\n  Carrier = 'carrier',\n  Cruiser = 'cruiser',\n  Destroyer = 'destroyer',\n  PatrolBoat = 'patrolBoat',\n  Submarine = 'submarine',\n};\n\n// ðŸ’­ --------------------------------------------------------------\n// ðŸ’­ Types\n\nexport type AngleOfRotation = null | AnglesOfRotation;\nexport type AxisArrayKey = `row-${number}` | `column-${number}`;\nexport type Coordinates = [number, number];\nexport type CoordinatesArray = Coordinates[];\nexport type OccupiedCoordinatesSet = Set<OccupiedCoordinatesSetMemberKey> | null;\nexport type OccupiedCoordinatesSetMemberKey = `[${number}, ${number}]`;\nexport type Fleet = {\n  [key in ShipType]?: BattleshipBuilder;\n};\nexport type FleetConfigs = {\n  [key in ShipType]?: ShipConfig;\n};\nexport type FleetCoordinates = {\n  [key in ShipType]?: OccupiedCoordinatesSet | null;\n};\n\nexport type InBoundRotationalPlacePieceParamsForFleet = {\n  [key in ShipType]?: RotationalPositionMap | null;\n};\nexport type Gameboard = symbol[][];\nexport type OutOfBounds = 'outOfBounds';\nexport type Orientation = 'horizontal' | 'vertical';\nexport type PositionArray = IPosition[];\nexport type RotatedCoordinatesValue = Coordinates | OutOfBounds;\nexport type RotatedPlacePieceParams = {\n  [Key in AnglesOfRotation]?: RotatedPlacePieceParamsValue;\n};\nexport type RotatedPlacePieceParamsValue = IPlacePieceParams | OutOfBounds;\nexport type RotatedPlacePieceConfigurations = IPlacePieceParams | OutOfBounds;\nexport type ShipConfig = {\n  type: ShipType;\n  version?: Version;\n};\nexport type ShipLength = 2 | 3 | 4 | 5;\nexport type ShipSymbols = {\n  [key in ShipType]: symbol; // Each key in ShipType maps to a symbol\n};\nexport type ShipSymbolValueArray = ShipSymbolValue[];\nexport type ShipSymbolValue = typeof SHIP_SYMBOLS[ShipType];\nexport type SizeLookupKey = `${ShipType}-${Version}`;\nexport type RotationalPositionMap = Map<AnglesOfRotation, IPlacePieceParams>;\nexport type Version = 1990 | 2002;\n\n// ðŸ’­ --------------------------------------------------------------\n// ðŸ’­ Interfaces\n\ninterface IGridGameboard<T> {\n  readonly board: T[][];\n  fillValue: T;\n};\nexport interface IGridGameboardSquare<T> extends IGridGameboard<T> {\n  boardSize: number;\n};\nexport interface IBattlehipFleetBuilderSet {\n  playerOneFleetBuilder: BattleshipFleetBuilder;\n  playerTwoFleetBuilder: BattleshipFleetBuilder;\n}\nexport interface IBattleshipGameboardBuilderSet {\n  playerOneBoardBuilder: BattleshipBoardBuilder;\n  playerTwoBoardBuilder: BattleshipBoardBuilder;\n}\nexport interface IBattleshipFleetBuilderSet {\n  playerOneFleetBuilder: BattleshipFleetBuilder;\n  playerTwoFleetBuilder: BattleshipFleetBuilder;\n}\nexport interface IBattleshipGameboardController extends IGridGameboardController {\n  playerState: Omit<PlayerState, 'gameboardController' | 'fleetBuilder'>;\n  getValidPositions(\n    shipPlacementConfigs: IShipPlacementConfigurations\n  ): IValidPositionsResult;\n  movePiece(ship: BattleshipBuilder, newBowCoordinates: Coordinates): void;\n  placePiece(options: IPlacePieceWrapperParams): void;\n  prettyPrint(): void;\n  removePiece(ship: BattleshipBuilder, resetInitialConfigs: boolean): void;\n  removeAllPieces(fleet: Fleet): void;\n  rotatePiece(ship: BattleshipBuilder): void;\n}\nexport interface IBattleshipGameboardControllerSet {\n  playerOneBoardController: BattleshipBoardController;\n  playerTwoBoardController: BattleshipBoardController;\n}\nexport interface IBattleshipGameboardRepositorySet {\n  playerOneBoardRepository: BattleshipBoardRepository;\n  playerTwoBoardRepository: BattleshipBoardRepository;\n}\ninterface IGridGameboardController {\n  placePiece(...args: any): void;\n  removePiece(...args: any): void;\n  removeAllPieces(...args: any): void;\n}\nexport interface IPlacementConfigurations {\n  coordinatesArray: CoordinatesArray | null;\n  orientation: Orientation | null;\n};\nexport interface IRotationalPivotConfigurations extends IPlacementConfigurations {\n  transientAngleOfRotation: AngleOfRotation;\n};\nexport interface IPlacePieceParams {\n  coordinates: Coordinates;\n  orientation: Orientation;\n};\nexport interface IPlacePieceWrapperParams extends IPlacePieceParams {\n  ship: BattleshipBuilder;\n};\nexport interface IPlacePieceCallbackParams extends IPlacePieceWrapperParams {\n  battleshipBoardBuilder: BattleshipBoardBuilder\n  battleshipBoardController: BattleshipBoardController;\n  battleshipBoardRepository: BattleshipBoardRepository;\n};\nexport interface IPosition {\n  bow: Coordinates; // [rowIndex, colIndex]\n  stern: Coordinates; // [rowIndex, colIndex]\n};\nexport interface IShipOptions {\n  hitCounter: number;\n  length: ShipLength;\n  type: ShipType;\n  version: Version;\n};\nexport interface IShipPlacementConfigurations {\n  orientation: Orientation;\n  shipLength: ShipLength;\n};\nexport interface ITestCaseShipHit {\n  expected: string; // Expected output\n  hits: number; // Function returning the string to be tested\n};\nexport interface ITestCaseValidPositions {\n  shipPlacementConfigs: IShipPlacementConfigurations;\n  validPositions: IValidPositionsResult;\n};\nexport interface IValidPlacementCallbackParams extends IShipPlacementConfigurations {\n  battleshipBoardBuilder: BattleshipBoardBuilder;\n  battleshipBoardController: BattleshipBoardController;\n};\nexport interface IValidPositionsResult {\n  [key: AxisArrayKey]: PositionArray;\n};","import {\n  Gameboard,\n  IGridGameboardSquare,\n} from '../../types/logic-types';\n\nexport class BattleshipBoardBuilder implements IGridGameboardSquare<symbol> {\n  private static readonly vacant: symbol = Symbol('VC');\n\n  private readonly _board: Gameboard;\n  private readonly _boardSize: number = 10;\n  private readonly _fillValue: symbol = BattleshipBoardBuilder.vacant;\n\n  constructor() {\n    this._board = Array.from({ length: this._boardSize }, () =>\n      Array(this._boardSize).fill(this._fillValue)\n    );\n  }\n\n  public get board(): Gameboard {\n    return this._board;\n  }\n\n  public get boardSize(): number {\n    return this._boardSize;\n  }\n\n  public get fillValue(): symbol {\n    return this._fillValue;\n  }\n}","import { BattleshipBuilder } from '../bs-ship-builder/bs-ship-builder';\nimport {\n  AngleOfRotation,\n  AnglesOfRotation,\n  AxisArrayKey,\n  Coordinates,\n  CoordinatesArray,\n  Fleet,\n  IBattleshipGameboardController,\n  IPlacePieceCallbackParams,\n  IPlacePieceParams,\n  IPlacePieceWrapperParams,\n  IPosition,\n  IShipPlacementConfigurations,\n  IValidPlacementCallbackParams,\n  IValidPositionsResult,\n  Orientation,\n  RotatedCoordinatesValue,\n  RotatedPlacePieceParams,\n  RotatedPlacePieceParamsValue,\n  ShipLength,\n  ShipType,\n  RotationalPositionMap,\n  PositionArray,\n} from '../../types/logic-types';\nimport { PlayerState } from '../../types/state-types';\nimport {\n  areCoordinatesInBounds,\n  arePositionsEqual,\n  createAxisArrayKey,\n  createPositionObject,\n  isAngleOfRotation,\n  isOutOfBounds,\n  isPlacePieceParams,\n  isPositionInBounds,\n  isPositionsArray,\n} from '../../utilities/logic-utilities';\nimport { getValidShipPositions } from './helpers/get-valid-ship-positions/get-valid-ship-positions';\nimport { placeShip } from './helpers/place-ship/place-ship';\n\nexport class BattleshipBoardController\n  implements IBattleshipGameboardController\n{\n  constructor(\n    public readonly playerState: Omit<PlayerState, 'gameboardController'>\n  ) {}\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ Public\n\n  public getValidPositions({\n    orientation,\n    shipLength,\n  }: IShipPlacementConfigurations): IValidPositionsResult {\n    const validPlacementArg: IValidPlacementCallbackParams = {\n      orientation,\n      shipLength,\n      battleshipBoardBuilder: this.playerState.gameboardBuilder,\n      battleshipBoardController: this,\n    };\n\n    return getValidShipPositions(validPlacementArg);\n  }\n\n  public getAllValidBowCoordinates(\n    orientation: Orientation,\n    shipLength: ShipLength\n  ): Set<Coordinates> {\n    let allValidBowCoordinates: Set<Coordinates> = new Set();\n    const validPositions: IValidPositionsResult = this.getValidPositions({\n      orientation,\n      shipLength,\n    });\n\n    for (const positionsInAxis of Object.values(validPositions)) {\n      if (!isPositionsArray(positionsInAxis))\n        throw new Error(\n          `Expected each value of validPositions to be an array of IPosition objects, but received: ${typeof positionsInAxis}.`\n        );\n\n      positionsInAxis.forEach((position) =>\n        allValidBowCoordinates.add(position.bow)\n      );\n    }\n\n    return allValidBowCoordinates;\n  }\n\n  public movePiece(\n    ship: BattleshipBuilder,\n    newBowCoordinates: Coordinates\n  ): void {\n    if (!ship.isPlaced()) {\n      console.warn(`Invalid Command: The ${ship.type} has not been placed.`);\n      return;\n    }\n\n    const currentOrientation: Orientation =\n      ship.currentplacementConfigurations.orientation!;\n\n    const newPosition: IPosition = createPositionObject(\n      newBowCoordinates,\n      currentOrientation,\n      ship.length\n    );\n\n    if (\n      !isPositionInBounds(\n        newPosition,\n        this.playerState.gameboardBuilder.boardSize\n      )\n    ) {\n      console.warn(\n        `Invalid Command: Position - Bow: [${newPosition.bow}] & Stern: [${newPosition.stern}] is out of bounds for the ${ship.type}.`\n      );\n\n      return;\n    }\n\n    const validPositions: IValidPositionsResult = this.getValidPositions({\n      orientation: currentOrientation,\n      shipLength: ship.length,\n    });\n\n    const isHorizontal: boolean = currentOrientation === 'horizontal';\n    const [x, y]: Coordinates = newBowCoordinates;\n    const axisArrayKey: AxisArrayKey = createAxisArrayKey(\n      isHorizontal ? y : x,\n      isHorizontal\n    );\n\n    const axisArray: PositionArray = validPositions[axisArrayKey];\n\n    const isNewPositionValid: boolean = axisArray.some(\n      (position: IPosition): boolean => arePositionsEqual(position, newPosition)\n    );\n\n    if (isNewPositionValid) {\n      const placementParameters: IPlacePieceWrapperParams = {\n        ship,\n        coordinates: newBowCoordinates,\n        orientation: currentOrientation,\n      };\n      const shouldResetShipRotationalData: boolean = true;\n\n      this.relocateShip(\n        ship,\n        placementParameters,\n        shouldResetShipRotationalData\n      );\n    } else {\n      console.warn(\n        `Invalid Command: Position - Bow: [${newPosition.bow}] & Stern: [${newPosition.stern}] is unavailable for the ${ship.type}.`\n      );\n    }\n  }\n\n  public placePiece({\n    ship,\n    coordinates,\n    orientation,\n  }: IPlacePieceWrapperParams): void {\n    const placeShipArg: IPlacePieceCallbackParams = {\n      ship,\n      coordinates,\n      orientation,\n      battleshipBoardController: this,\n      battleshipBoardBuilder: this.playerState.gameboardBuilder,\n      battleshipBoardRepository: this.playerState.gameboardRepository,\n    };\n\n    placeShip(placeShipArg);\n\n    this.setFleetRotatedPlacePieceParams(this.playerState.fleetBuilder.fleet);\n  }\n\n  public prettyPrint(): void {\n    console.table(\n      this.playerState.gameboardBuilder.board.map((row) =>\n        row.map((symbol) =>\n          symbol.description === 'VC' ? null : symbol.description\n        )\n      )\n    );\n  }\n\n  public removePiece(\n    ship: BattleshipBuilder,\n    shouldResetShipRotationalData: boolean = true\n  ): void {\n    if (!this.isShipValidForRemoval(ship)) return;\n\n    const removeShipFromBoard = (shipCoordinates: CoordinatesArray): void => {\n      shipCoordinates.forEach(([x, y]) => {\n        this.playerState.gameboardBuilder.board[y][x] =\n          this.playerState.gameboardBuilder.fillValue;\n      });\n    };\n    const nullifyShipCoordinateSetValue = (shipType: ShipType): void => {\n      this.playerState.gameboardRepository.nullifyShipCoordinatesValue(\n        shipType\n      );\n    };\n    const resetShipConfigurations = (\n      ship: BattleshipBuilder,\n      shouldResetShipRotationalData: boolean\n    ): void => {\n      if (shouldResetShipRotationalData) {\n        this.playerState.gameboardRepository.nullifyShipValidRotationalParams(\n          ship.type\n        );\n      }\n\n      ship.resetConfigurations(shouldResetShipRotationalData);\n    };\n\n    const shipCoordinates: CoordinatesArray =\n      ship.currentplacementConfigurations.coordinatesArray!;\n\n    removeShipFromBoard(shipCoordinates);\n    nullifyShipCoordinateSetValue(ship.type);\n    resetShipConfigurations(ship, shouldResetShipRotationalData);\n  }\n\n  public removeAllPieces(fleet: Fleet): void {\n    if (!Object.keys(fleet).length) {\n      console.error(\n        'Invalid Command: No ships to remove - Fleet is empty or uninitialized.'\n      );\n      return;\n    }\n\n    for (const ship of Object.values(fleet)) {\n      this.removePiece(ship);\n    }\n  }\n\n  public rotatePiece(ship: BattleshipBuilder): void {\n    const getNextAngle = (\n      rotationalPositionMap: RotationalPositionMap,\n      currentAngle: AngleOfRotation\n    ): AngleOfRotation => {\n      if (currentAngle === null || currentAngle === undefined)\n        throw new Error(\"Current angle doesn't exist\");\n\n      const angles: AnglesOfRotation[] = Array.from(\n        rotationalPositionMap.keys()\n      );\n\n      return (\n        angles.find((angle) => angle > currentAngle) ??\n        AnglesOfRotation.Degrees0\n      );\n    };\n    const getMaxAngle = (\n      rotationalPositionMap: RotationalPositionMap\n    ): AngleOfRotation =>\n      Array.from(rotationalPositionMap.keys()).pop() ??\n      AnglesOfRotation.Degrees0;\n    const getNextPiecePlacementParams = (\n      ship: BattleshipBuilder,\n      rotationalPositionMap: RotationalPositionMap\n    ): IPlacePieceWrapperParams => {\n      const currentAngle: AngleOfRotation =\n        ship.rotationalPivotConfigurations.transientAngleOfRotation;\n\n      const maxAngle: AngleOfRotation = getMaxAngle(rotationalPositionMap);\n\n      if (currentAngle === maxAngle) {\n        const originalBowCoordinates: Coordinates =\n          ship.rotationalPivotConfigurations.coordinatesArray![0];\n        const originalOrientation: Orientation =\n          ship.rotationalPivotConfigurations.orientation!;\n\n        // set current degree of rotation\n        ship.rotationalPivotConfigurations.transientAngleOfRotation =\n          AnglesOfRotation.Degrees0;\n\n        return {\n          ship,\n          coordinates: originalBowCoordinates,\n          orientation: originalOrientation,\n        };\n      }\n\n      const nextAngle: AngleOfRotation = getNextAngle(\n        rotationalPositionMap,\n        currentAngle\n      );\n      const nextPlacePieceParams: IPlacePieceParams | undefined =\n        rotationalPositionMap.get(nextAngle!);\n\n      // set current degree of rotation\n      ship.rotationalPivotConfigurations.transientAngleOfRotation = nextAngle;\n\n      return {\n        ship,\n        coordinates: nextPlacePieceParams!.coordinates,\n        orientation: nextPlacePieceParams!.orientation,\n      };\n    };\n    const updateTransientPlacementParams = (\n      rotationalPositionMap: RotationalPositionMap\n    ): IPlacePieceWrapperParams => {\n      let nextPlacePieceParams: IPlacePieceWrapperParams =\n        getNextPiecePlacementParams(ship, rotationalPositionMap);\n\n      while (\n        ship.rotationalPivotConfigurations.transientAngleOfRotation !==\n        initialAngle\n      ) {\n        if (\n          this.isRotatedPositionValid(\n            nextPlacePieceParams.coordinates,\n            nextPlacePieceParams.orientation,\n            ship.rotationalPivotConfigurations.transientAngleOfRotation,\n            ship.length\n          )\n        ) {\n          break;\n        }\n        nextPlacePieceParams = getNextPiecePlacementParams(\n          ship,\n          rotationalPositionMap\n        );\n      }\n\n      return nextPlacePieceParams;\n    };\n\n    const rotationalPositionMap: RotationalPositionMap =\n      this.playerState.gameboardRepository.inBoundRotationalPlacePieceForFleet[\n        ship.type\n      ]!;\n\n    const initialAngle =\n      ship.rotationalPivotConfigurations.transientAngleOfRotation;\n    \n    /* \n    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n    â”‚ The coolest part of this whole transient concept is that it                  â”‚\n    â”‚ allows me to name a variable `finalPlacePieceParams`â€¦ which implies a         â”‚\n    â”‚ predetermined value, with a function named `updateTransientPlacementParams`â€¦ â”‚\n    â”‚ which implies something transientâ€¦ while the semantic naming of the          â”‚ \n    | key-value pair maintain sound logicality. I am intuit. - ðŸ’­                  â”‚\n    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n    */ \n\n    const finalPlacePieceParams: IPlacePieceWrapperParams =\n      updateTransientPlacementParams(rotationalPositionMap);\n\n    if (\n      ship.rotationalPivotConfigurations.transientAngleOfRotation ===\n      initialAngle\n    ) {\n      console.warn('No valid rotational position found.');\n      return;\n    }\n\n    const shouldResetShipRotationalData: boolean = false;\n\n    this.relocateShip(\n      ship,\n      finalPlacePieceParams,\n      shouldResetShipRotationalData\n    );\n  }\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ Private\n\n  private areCoordinatesVacant(coordinates: Coordinates): boolean {\n    const [x, y] = coordinates;\n    return (\n      this.playerState.gameboardBuilder.board[y][x] ===\n      this.playerState.gameboardBuilder.fillValue\n    );\n  }\n\n  // ? maybe use this with UI? (TODO: create return value type)\n  private getShipAt(coordinates: Coordinates) {\n    if (this.areCoordinatesVacant(coordinates)) return;\n\n    return this.playerState.gameboardRepository.getShipDataAt(coordinates);\n  }\n\n  private isRotatedPositionValid = (\n    [x, y]: Coordinates,\n    orientation: Orientation,\n    angleOfRotation: AngleOfRotation,\n    shipLength: ShipLength\n  ): boolean => {\n    const isHorizontal = orientation === 'horizontal';\n    const gameboardSize = this.playerState.gameboardBuilder.boardSize;\n    const gameboard = this.playerState.gameboardBuilder.board;\n    const fillValue = this.playerState.gameboardBuilder.fillValue;\n    const newAxisIndexStart = isHorizontal ? x : y;\n\n    let i: number;\n    let axisIndexEnd: number;\n\n    if (\n      (!isHorizontal && angleOfRotation === AnglesOfRotation.Degrees90) ||\n      (isHorizontal && angleOfRotation === AnglesOfRotation.Degrees270) ||\n      angleOfRotation === AnglesOfRotation.Degrees0\n    ) {\n      i = 1;\n      axisIndexEnd = shipLength;\n    } else {\n      i = 0;\n      axisIndexEnd = shipLength - 1;\n    }\n\n    if (newAxisIndexStart + shipLength - 1 >= gameboardSize) return false;\n\n    for (i; i < axisIndexEnd; i++) {\n      const cellValue = isHorizontal\n        ? gameboard[y][x + i]\n        : gameboard[y + i][x];\n\n      if (cellValue !== fillValue) return false;\n    }\n\n    return true;\n  };\n\n  private getRotatedPlacePieceParams(ship: BattleshipBuilder) {\n    const applyOffsetToCoordinate = (\n      coordinate: number,\n      shipLength: ShipLength\n    ): number => {\n      const offset: number = shipLength - 1;\n      return coordinate - offset;\n    };\n    const determineRotatedOrientation = (\n      angleOfRotation: AngleOfRotation,\n      isHorizontal: boolean\n    ): Orientation => {\n      return isHorizontal\n        ? angleOfRotation === AnglesOfRotation.Degrees180\n          ? 'horizontal'\n          : 'vertical'\n        : angleOfRotation === AnglesOfRotation.Degrees180\n        ? 'vertical'\n        : 'horizontal';\n    };\n    const getRotatedBowCoordinates = (\n      angleOfRotation: AngleOfRotation,\n      isHorizontal: boolean,\n      [x, y]: Coordinates\n    ): RotatedCoordinatesValue => {\n      if (\n        angleOfRotation === AnglesOfRotation.Degrees0 ||\n        (angleOfRotation === AnglesOfRotation.Degrees90 && isHorizontal) ||\n        (angleOfRotation === AnglesOfRotation.Degrees270 && !isHorizontal)\n      ) {\n        return rotationalPivotBowCoordinates;\n      }\n\n      const rotatedBowCoordinates: Coordinates = isHorizontal\n        ? angleOfRotation === AnglesOfRotation.Degrees180\n          ? [applyOffsetToCoordinate(x, ship.length), y]\n          : [x, applyOffsetToCoordinate(y, ship.length)] // angleOfRotation === 270\n        : angleOfRotation === AnglesOfRotation.Degrees180\n        ? [x, applyOffsetToCoordinate(y, ship.length)]\n        : [applyOffsetToCoordinate(x, ship.length), y]; // angleOfRotation === 90\n\n      return areCoordinatesInBounds(\n        rotatedBowCoordinates,\n        this.playerState.gameboardBuilder.boardSize\n      )\n        ? rotatedBowCoordinates\n        : 'outOfBounds';\n    };\n    const createRotatedPiecePlacementParams = (\n      rotationalPivotBowCoordinates: Coordinates,\n      rotationalPivotOrientation: Orientation\n    ): RotatedPlacePieceParams => {\n      const isHorizontal = rotationalPivotOrientation === 'horizontal';\n\n      const rotatedPiecePlacementParams: RotatedPlacePieceParams = {};\n\n      const anglesOfRotation: AnglesOfRotation[] = [\n        AnglesOfRotation.Degrees0,\n        AnglesOfRotation.Degrees90,\n        AnglesOfRotation.Degrees180,\n        AnglesOfRotation.Degrees270,\n      ];\n\n      anglesOfRotation.forEach((angleOfRotation) => {\n        const coordinates: RotatedCoordinatesValue =\n          angleOfRotation === AnglesOfRotation.Degrees0\n            ? rotationalPivotBowCoordinates\n            : getRotatedBowCoordinates(\n                angleOfRotation,\n                isHorizontal,\n                rotationalPivotBowCoordinates\n              );\n\n        if (coordinates === 'outOfBounds') {\n          rotatedPiecePlacementParams[angleOfRotation] = 'outOfBounds';\n        } else {\n          rotatedPiecePlacementParams[angleOfRotation] = {\n            coordinates,\n            orientation:\n              angleOfRotation === AnglesOfRotation.Degrees0\n                ? rotationalPivotOrientation\n                : determineRotatedOrientation(angleOfRotation, isHorizontal),\n          };\n        }\n      });\n\n      return rotatedPiecePlacementParams;\n    };\n    const generateRotationalPositionMap = (\n      rotatedPiecePlacementParams: RotatedPlacePieceParams\n    ): RotationalPositionMap => {\n      const rotatedPlacePieceParams: RotationalPositionMap = new Map();\n\n      for (const angleOfRotationString of Object.keys(\n        rotatedPiecePlacementParams\n      )) {\n        const angleOfRotationToNum = +angleOfRotationString as AngleOfRotation;\n\n        if (!isAngleOfRotation(angleOfRotationToNum)) {\n          throw new Error(\n            `Invalid Type: \"${angleOfRotationString}\" doesn't conform to \"AngleOfRotation\".`\n          );\n        }\n\n        const rotatedPlacePieceParamsValue: RotatedPlacePieceParamsValue =\n          rotatedPiecePlacementParams[angleOfRotationToNum]!;\n\n        if (\n          !(\n            isPlacePieceParams(rotatedPlacePieceParamsValue) ||\n            isOutOfBounds(rotatedPlacePieceParamsValue)\n          )\n        ) {\n          throw new Error(\n            `Invalid Type: \"${rotatedPlacePieceParamsValue}\" doesn't conform to \"RotatedPlacePieceParams\".`\n          );\n        }\n\n        if (!isPlacePieceParams(rotatedPlacePieceParamsValue)) continue;\n\n        const { coordinates: bowCoordinates, orientation }: IPlacePieceParams =\n          rotatedPlacePieceParamsValue;\n\n        const placePieceParams: IPlacePieceParams = {\n          coordinates: bowCoordinates,\n          orientation,\n        };\n\n        rotatedPlacePieceParams.set(angleOfRotationToNum, placePieceParams);\n      }\n\n      return rotatedPlacePieceParams;\n    };\n\n    const rotationalPivotBowCoordinates: Coordinates =\n      ship.rotationalPivotConfigurations.coordinatesArray![0];\n    const rotationalPivotOrientation: Orientation =\n      ship.rotationalPivotConfigurations.orientation!;\n    const rotatedPiecePlacementParams: RotatedPlacePieceParams =\n      createRotatedPiecePlacementParams(\n        rotationalPivotBowCoordinates,\n        rotationalPivotOrientation\n      );\n\n    const rotatedPlacePieceParamsMap: RotationalPositionMap =\n      generateRotationalPositionMap(rotatedPiecePlacementParams);\n\n    return rotatedPlacePieceParamsMap;\n  }\n\n  private isShipValidForRemoval(ship: BattleshipBuilder): boolean {\n    if (\n      !ship.currentplacementConfigurations.coordinatesArray ||\n      !this.playerState.gameboardRepository.isShipPlaced(ship.type)\n    ) {\n      console.error(\n        `Error removing ship: ${ship.type} is missing coordinates or not in the fleet.`\n      );\n      return false;\n    }\n\n    return true;\n  }\n\n  private relocateShip(\n    ship: BattleshipBuilder,\n    placementParameters: IPlacePieceWrapperParams,\n    shouldResetShipRotationalData: boolean\n  ): void {\n    this.removePiece(ship, shouldResetShipRotationalData);\n    this.placePiece(placementParameters);\n  }\n\n  private setFleetRotatedPlacePieceParams(fleet: Fleet): void {\n    for (const ship of Object.values(fleet)) {\n      if (ship.isPlaced()) this.setShipRotatedPlacePieceParams(ship);\n    }\n  }\n\n  private setShipRotatedPlacePieceParams(ship: BattleshipBuilder): void {\n    const rotatedPlacePieceParams: RotationalPositionMap =\n      this.getRotatedPlacePieceParams(ship);\n\n    this.playerState.gameboardRepository.setShipValidRotationalParams(\n      ship,\n      rotatedPlacePieceParams\n    );\n  }\n}\n","import {\n  AxisArrayKey,\n  Coordinates,\n  Gameboard,\n  IValidPlacementCallbackParams,\n  IValidPositionsResult,\n  Orientation,\n  PositionArray,\n  ShipLength,\n} from '../../../../types/logic-types';\n\nexport function getValidShipPositions({\n  shipLength,\n  orientation,\n  battleshipBoardBuilder\n}: IValidPlacementCallbackParams): IValidPositionsResult {\n  const extractAxisArray = (\n    axisIndex: number,\n    orientation: Orientation,\n    gameboard: Gameboard\n  ): Array<symbol> => { // or symbol[]\n    \n    return orientation === 'horizontal'\n      ? gameboard[axisIndex] // Returns row #<axisIndex>\n      : gameboard.map(row => row[axisIndex]) // `y` values at column-<axisIndex>\n  };\n  const findValidPositionsInAxis = (\n    axisArray: Array<symbol>, // or symbol[]\n    isHorizontal: boolean,\n    axisIndex: number,\n    shipLength: ShipLength\n  ): PositionArray => {\n    let streak: number = 0;\n    let validAxisPositions: PositionArray = [];\n    \n    for (let i = 0; i < axisArray.length; i++) {\n      if (axisArray[i] === battleshipBoardBuilder.fillValue) {\n        streak++;\n        \n        if (streak >= shipLength) {\n          const bowPosition: Coordinates =\n            isHorizontal\n            ? [i - (shipLength - 1), axisIndex]\n            : [axisIndex, i - (shipLength - 1)];\n          \n          const sternPosition: Coordinates =\n            isHorizontal\n              ? [i, axisIndex]\n              : [axisIndex, i];\n\n          validAxisPositions.push({\n            bow: bowPosition,\n            stern: sternPosition,\n          });\n        }\n      } else {\n        streak = 0;\n      }\n    }\n    \n    return validAxisPositions;\n  };\n\n  const validPositionsPerAxis: IValidPositionsResult = {}; \n  const board: Gameboard = battleshipBoardBuilder.board;\n  const isHorizontal = orientation === 'horizontal';\n\n  for (let axisIndex = 0; axisIndex < board.length; axisIndex++) {\n    const axisArray: Array<symbol> = extractAxisArray(axisIndex, orientation, board);\n    const validPositions: PositionArray = findValidPositionsInAxis(\n      axisArray,\n      isHorizontal,\n      axisIndex,\n      shipLength\n    );\n    \n    const axisTemplate: AxisArrayKey =\n      isHorizontal\n        ? `row-${axisIndex}`\n        : `column-${axisIndex}`;\n    \n    validPositionsPerAxis[axisTemplate] = validPositions;\n  }\n\n  return validPositionsPerAxis;\n}","import {\n  AnglesOfRotation,\n  AxisArrayKey,\n  Coordinates,\n  OccupiedCoordinatesSet,\n  OccupiedCoordinatesSetMemberKey,\n  FleetCoordinates,\n  IBattlehipFleetBuilderSet,\n  IBattleshipFleetBuilderSet,\n  IBattleshipGameboardBuilderSet,\n  IBattleshipGameboardControllerSet,\n  IBattleshipGameboardRepositorySet,\n  IPlacePieceParams,\n  IPosition,\n  IShipPlacementConfigurations,\n  Orientation,\n  OutOfBounds,\n  RotatedCoordinatesValue,\n  ShipLength,\n  ShipType,\n  Version,\n  PositionArray\n} from \"../types/logic-types\";\nimport { BattleshipBoardBuilder } from \"../logic/bs-gameboard-builder/bs-gameboard-builder\";\nimport { BattleshipBoardController } from \"../logic/bs-gameboard-controller/bs-gameboard-controller\";\nimport { BattleshipBoardRepository } from \"../logic/bs-gameboard-repository/bs-gameboard-repository\";\nimport { BattleshipFleetBuilder } from \"../logic/bs-fleet-builder/bs-fleet-builder\";\nimport { areArraysEqual } from \"./random-utilities\";\n\n// ðŸ’­ --------------------------------------------------------------\n\n// * FACTORY FUNCTIONS\nexport function createBattleshipBoardController(\n  gameboardBuilder: BattleshipBoardBuilder,\n  gameboardRepository: BattleshipBoardRepository,\n  fleetBuilder: BattleshipFleetBuilder\n): BattleshipBoardController {\n  return new BattleshipBoardController({gameboardBuilder, gameboardRepository, fleetBuilder});\n}\nexport function createBattleshipControllerSet(\n  { playerOneBoardBuilder, playerTwoBoardBuilder}: IBattleshipGameboardBuilderSet,\n  { playerOneBoardRepository, playerTwoBoardRepository }: IBattleshipGameboardRepositorySet,\n  { playerOneFleetBuilder, playerTwoFleetBuilder }: IBattleshipFleetBuilderSet,\n): IBattleshipGameboardControllerSet {\n  return {\n    playerOneBoardController: createBattleshipBoardController(\n      playerOneBoardBuilder,\n      playerOneBoardRepository,\n      playerOneFleetBuilder\n    ),\n    playerTwoBoardController: createBattleshipBoardController(\n      playerTwoBoardBuilder,\n      playerTwoBoardRepository,\n      playerTwoFleetBuilder\n    ),\n  };\n}\nexport function createBattleshipBoardBuilderSet(): IBattleshipGameboardBuilderSet {\n  return {\n    playerOneBoardBuilder: new BattleshipBoardBuilder(),\n    playerTwoBoardBuilder: new BattleshipBoardBuilder(),\n  };\n}\nexport function createBattleshipBoardRepositorySet(): IBattleshipGameboardRepositorySet {\n  return {\n    playerOneBoardRepository: new BattleshipBoardRepository(),\n    playerTwoBoardRepository: new BattleshipBoardRepository(),\n  };\n}\nexport function createBattleshipFleetBuilderSet(\n  version: Version = 2002\n): IBattlehipFleetBuilderSet {\n  const createBattleshipFleetBuilder =\n    version === 2002\n      ? BattleshipFleetBuilder.createHasbroFleet\n      : BattleshipFleetBuilder.createMBFleet;\n\n  return {\n    playerOneFleetBuilder: createBattleshipFleetBuilder(),\n    playerTwoFleetBuilder: createBattleshipFleetBuilder(),\n  };\n}\n\n// ðŸ’­ --------------------------------------------------------------\n\n// * GENERAL HELPER FUNCTIONS\nexport function createAxisArrayKey(\n  axisIndex: number,\n  isHorizontal: boolean\n): AxisArrayKey {\n  return isHorizontal ? `row-${axisIndex}` : `column-${axisIndex}`;\n}\nexport function createPositionObject(\n  [x, y]: Coordinates,\n  orientation: Orientation,\n  shipLength: ShipLength\n): IPosition {\n  const isHorizontal = orientation === 'horizontal';\n  const bowCoordinates: Coordinates = [x, y];\n  const sternCoordinates: Coordinates = isHorizontal\n    ? [x + shipLength - 1, y]\n    : [x, y + shipLength - 1];\n\n  return {\n    bow: bowCoordinates,\n    stern: sternCoordinates,\n  };\n}\nexport function createShipConfigurations(\n  shipLength: ShipLength,\n  orientation: Orientation\n): IShipPlacementConfigurations {\n  return {\n    orientation,\n    shipLength,\n  };\n}\n\n// ðŸ’­ --------------------------------------------------------------\n\n// * BOUND CHECK HELPER FUNCTIONS\nexport const isCoordinateInBounds = (coordinate: number, boardSize: number): boolean =>\n  coordinate >= 0 && coordinate < boardSize;\nexport const areCoordinatesInBounds = (coordinates: Coordinates, boardSize: number): boolean => {\n  return coordinates.every((coordinate) => isCoordinateInBounds(coordinate, boardSize)); \n}\nexport const isPositionInBounds = (position: IPosition, boardSize: number): boolean => {\n  return areCoordinatesInBounds(position.bow, boardSize) && areCoordinatesInBounds(position.stern, boardSize);\n};\n\n// ðŸ’­ --------------------------------------------------------------\n\n// * UTILITY FUNCTIONS\nexport const arePositionsEqual = (\n  positionOne: IPosition,\n  positionTwo: IPosition\n): boolean => {\n  return (\n    areArraysEqual(positionOne.bow, positionTwo.bow) &&\n    areArraysEqual(positionOne.stern, positionTwo.stern)\n  );\n};\n\n// ðŸ’­ --------------------------------------------------------------\n\n// * TYPE GUARDS\nexport function isAngleOfRotation(\n  value: unknown\n): value is AnglesOfRotation {\n  return Object.values(AnglesOfRotation).includes(value as ShipType);\n};\nexport const isCoordinates = (value: unknown): value is Coordinates => {\n  if (!Array.isArray(value) || value.length !== 2) return false;\n\n  return value.every((coordinate) => typeof coordinate === 'number');\n};\nexport const isOccupiedCoordinatesSet = (value: unknown): value is OccupiedCoordinatesSet => {\n  if (value === null) return true;\n  if (!(value instanceof Set)) return false;\n\n  for (const member of value) {\n    if (!isOccupiedCoordinatesSetMemberKey(member)) {\n      return false;\n    }\n  }\n\n  return true;\n};\nexport const isFleetCoordinates = (\n  value: unknown\n): value is FleetCoordinates => {\n  if (typeof value !== 'object' || value === null) return false;\n\n  for (const key in value) {\n    if (!Object.values(ShipType).includes(key as ShipType)) {\n      return false\n    }\n\n    const OccupiedCoordinatesSetOrNull = (value as FleetCoordinates)[\n      key as ShipType\n    ];\n\n    if (OccupiedCoordinatesSetOrNull !== null && !isOccupiedCoordinatesSet(OccupiedCoordinatesSetOrNull)) {\n      return false;\n    }\n  }\n  return true;\n};\nexport const isPlainObject = (value: unknown): value is object => {\n  if (typeof value !== 'object' || value === null) return false;\n\n  const proto = Object.getPrototypeOf(value);\n  return proto === Object.prototype || proto === null;\n  // ? Why `proto === null`: Object.create(null) is a valid plain object.\n}\nexport const isOrientation = (value: unknown): value is Orientation => {\n  if (typeof value !== 'string') return false;\n  return ['horizontal', 'vertical'].includes(value);\n}\nexport const isOutOfBounds = (value: unknown): value is OutOfBounds => {\n  return (value) === 'outOfBounds';\n};\nexport const isPlacePieceParams = (\n  value: unknown\n): value is IPlacePieceParams => {\n  if (typeof value !== 'object' || value === null) return false;\n\n  if (!isCoordinates((value as IPlacePieceParams).coordinates)) return false;\n\n  return true;\n};\nexport const isPosition = (value: unknown): value is IPosition => {\n  if (!isPlainObject(value)) return false;\n\n  const { bow, stern } = value as IPosition;\n\n  return isCoordinates(bow) && isCoordinates(stern);\n};\nexport const isPositionsArray = (value: unknown): value is PositionArray => {\n  if (!Array.isArray(value)) return false;\n\n  return value.every(position => isPosition(position));\n};\nexport const isOccupiedCoordinatesSetMemberKey = (value: unknown): value is OccupiedCoordinatesSetMemberKey => {\n  if (typeof value !== 'string') return false;\n\n  const match = value.match(/^\\[\\d{1}, \\d{1}\\]$/);\n  return match !== null;\n};\nexport const isRotatedCoordinatesValue = (\n  value: unknown\n): value is RotatedCoordinatesValue => {\n  return isCoordinates(value) || isOutOfBounds(value);\n};\nexport const isShipLength = (value: unknown): value is ShipLength => {\n  return typeof value === 'number' && [2, 3, 4, 5].includes(value);\n}\nexport const isShipType = (\n  value: unknown\n): value is ShipType => {\n  return Object.values(ShipType).includes(value as ShipType);\n};\n\n// ðŸ’­ --------------------------------------------------------------\n\nexport const isNotNull = <T>(value: T | null | undefined): value is T => {\n  return value !== null && value !== undefined;\n}","import {\n  AnglesOfRotation,\n  AxisArrayKey,\n  Coordinates,\n  CoordinatesArray,\n  Gameboard,\n  IPlacementConfigurations,\n  IPlacePieceCallbackParams,\n  IPosition,\n  IShipPlacementConfigurations,\n  IValidPositionsResult,\n  Orientation,\n  ShipLength,\n  ShipSymbolValue,\n  ShipType,\n} from '../../../../types/logic-types';\nimport { arePositionsEqual, createPositionObject, isCoordinateInBounds } from '../../../../utilities/logic-utilities';\nimport { BattleshipBuilder } from '../../../bs-ship-builder/bs-ship-builder';\n\nexport function placeShip({\n  ship,\n  coordinates,\n  orientation,\n  battleshipBoardController,\n  battleshipBoardBuilder,\n  battleshipBoardRepository\n}: IPlacePieceCallbackParams): void {  \n  const shipLength: ShipLength = ship.length;\n  const [bowX, bowY]: Coordinates = coordinates;\n  const isHorizontal: boolean = orientation === 'horizontal';\n  const axisStart: number = isHorizontal ? bowX : bowY;\n  const axisEnd = axisStart + shipLength - 1;\n\n  if (!isCoordinateInBounds(axisEnd, battleshipBoardBuilder.boardSize)) {\n    const errorMessage: string = `Invalid Command: The ship placement attempt with the following configurations is out of bounds - Coordinates: ${coordinates}, Length: ${ship.length}, Orientation: ${orientation}.`;\n    throw new Error(errorMessage);\n  };\n\n  if (ship.isPlaced()) {\n    console.warn(`Invalid Command: The ${ship.type} has already been placed.`);\n    return;\n  };\n\n  const isPositionValid = (\n    position: IPosition,\n    shipConfigurations: IShipPlacementConfigurations,\n    axisArrayKey: AxisArrayKey\n  ): boolean => {\n    const validPositions: IValidPositionsResult =\n      battleshipBoardController.getValidPositions(shipConfigurations);\n\n    return validPositions[axisArrayKey].some((validPosition: IPosition) =>\n      arePositionsEqual(position, validPosition)\n    );\n  };\n\n  const position: IPosition = createPositionObject(\n    coordinates,\n    orientation,\n    shipLength,\n  );\n\n  const shipConfigurations: IShipPlacementConfigurations = {\n    shipLength,\n    orientation\n  };\n  const axisArrayKey: AxisArrayKey = isHorizontal\n    ? `row-${bowY}`\n    : `column-${bowX}`; \n    \n  if (isPositionValid(position, shipConfigurations, axisArrayKey)) {\n    const getPlacementCoordinates = (\n      validPosition: IPosition,\n      isHorizontal: Boolean\n    ): CoordinatesArray => {\n      const placementCoordinates: CoordinatesArray = [];\n\n      const [bowX, bowY]: Coordinates = validPosition.bow;\n      const [sternX, sternY]: Coordinates = validPosition.stern;\n\n      const primary: number = isHorizontal\n        ? bowY\n        : bowX;\n      const axisStart: number = isHorizontal\n        ? bowX\n        : bowY;\n      const axisEnd: number = isHorizontal\n        ? sternX\n        : sternY;\n\n      for (let i = axisStart; i <= axisEnd; i++) {\n        placementCoordinates.push(isHorizontal ? [i, primary] : [primary, i]);\n      }\n\n      return placementCoordinates;\n    };\n    const placeOnBoard = (\n      ship: BattleshipBuilder,\n      shipPlacementCoordinates: CoordinatesArray\n    ): void => {\n      const gameboard: Gameboard = battleshipBoardBuilder.board;\n      const shipSymbol: ShipSymbolValue = ship.symbol;\n\n      shipPlacementCoordinates.forEach((coordinates) => {\n        const [x, y]: Coordinates = coordinates;\n        gameboard[y][x] = shipSymbol;\n      });\n    };\n    const setShipConfigurations = (\n      ship: BattleshipBuilder,\n      coordinatesArray: CoordinatesArray,\n      orientation: Orientation\n    ): void => {\n      const placementConfigurations: IPlacementConfigurations = { coordinatesArray, orientation };\n      \n      ship.currentplacementConfigurations = placementConfigurations;\n\n      if (Object.values(ship.rotationalPivotConfigurations).every(value => value === null)) {\n        ship.rotationalPivotConfigurations = {\n          ...placementConfigurations,\n          transientAngleOfRotation: AnglesOfRotation.Degrees0,\n        }\n      }      \n    };\n    const updateOccupiedCoordinatesSet = (\n      shipType: ShipType,\n      placementCoordinates: CoordinatesArray\n    ): void => {\n      battleshipBoardRepository.addShipToFleetCoordinates(\n        shipType,\n        placementCoordinates\n      );\n    };\n\n    const placementCoordinates: CoordinatesArray = getPlacementCoordinates(\n      position,\n      isHorizontal\n    );\n\n    placeOnBoard(ship, placementCoordinates);\n    setShipConfigurations(\n      ship,\n      placementCoordinates,\n      orientation\n    );\n    updateOccupiedCoordinatesSet(ship.type, placementCoordinates);\n  } else {\n    const errorMessage: string = `Invalid Command: \"${JSON.stringify(\n      position\n    )}\" is unavailable for ship with Size: ${shipLength} and Orientation: ${orientation}.`;\n\n    throw new Error(errorMessage);\n  }\n}\n","import { BattleshipBuilder } from \"../bs-ship-builder/bs-ship-builder\";\nimport {\n  Coordinates,\n  CoordinatesArray,\n  OccupiedCoordinatesSetMemberKey,\n  FleetCoordinates,\n  InBoundRotationalPlacePieceParamsForFleet,\n  ShipType,\n  RotationalPositionMap\n} from \"../../types/logic-types\";\nimport { isOccupiedCoordinatesSet, isFleetCoordinates, isShipType } from \"../../utilities/logic-utilities\";\n\nexport class BattleshipBoardRepository {\n  private readonly _fleetCoordinates: FleetCoordinates = {};\n  private readonly _inBoundRotationalPlacePieceParamsForFleet: InBoundRotationalPlacePieceParamsForFleet = {};\n\n  // ðŸ’­ --------------------------------------------------------------\n\n  public get fleetCoordinates(): FleetCoordinates {\n    return this._fleetCoordinates;\n  }\n\n  public get inBoundRotationalPlacePieceForFleet(): InBoundRotationalPlacePieceParamsForFleet {\n    return this._inBoundRotationalPlacePieceParamsForFleet;\n  }\n\n  public addShipToFleetCoordinates(\n    shipType: ShipType,\n    placementCoordinates: CoordinatesArray\n  ): void {\n    if (!this.fleetCoordinates[shipType]) {\n      this.fleetCoordinates[shipType] = new Set();\n    }\n\n    placementCoordinates.forEach((coordinates: Coordinates) => {\n      const [x, y]: Coordinates = coordinates;\n      const setMemberTemplate: OccupiedCoordinatesSetMemberKey = `[${x}, ${y}]`;\n      this.fleetCoordinates[shipType]!.add(setMemberTemplate);\n    });\n  }\n\n  public getShipDataAt(coordinates: Coordinates) {\n    if (!isFleetCoordinates(this.fleetCoordinates)) {\n      throw new Error(\n        `Invalid Type: \"${this.fleetCoordinates}\" doesn't conform to \"FleetCoordinates\".`\n      );\n    }\n\n    const validateTypes = (shipType: unknown, OccupiedCoordinatesSet: unknown): void => {\n      if (!isShipType(shipType))\n        throw new Error(\n          `Invalid Type: \"${shipType}\" doesn't conform to \"ShipType\".`\n        );\n      if (!isOccupiedCoordinatesSet(OccupiedCoordinatesSet))\n        throw new Error(\n          `Invalid Type: \"${OccupiedCoordinatesSet}\" doesn't conform to \"OccupiedCoordinatesSet\".`\n        );\n    };\n\n    const [x, y]: Coordinates = coordinates;\n    const coordinateSetMemberKey: OccupiedCoordinatesSetMemberKey = `[${x}, ${y}]`;\n\n    for (const [shipType, occupiedCoordinatesSet] of Object.entries(this.fleetCoordinates)) {\n      if (!isShipType(shipType)) throw new Error('');\n      if (!isOccupiedCoordinatesSet(occupiedCoordinatesSet)) throw new Error();\n\n      validateTypes(shipType, occupiedCoordinatesSet);\n\n      if (occupiedCoordinatesSet?.has(coordinateSetMemberKey)) {\n        return {\n          shipType,\n          occupiedCoordinatesSet\n        }\n      }\n    }\n  }\n\n  public isShipPlaced(shipType: ShipType): boolean {\n    return this.fleetCoordinates[shipType] !== null;\n  }\n\n  public nullifyShipCoordinatesValue(shipType: ShipType): void {\n    this.fleetCoordinates[shipType] = null;\n  }\n\n  public nullifyShipValidRotationalParams(shipType: ShipType): void {\n    this.inBoundRotationalPlacePieceForFleet[shipType] = null;\n  }\n  \n  public setShipValidRotationalParams(\n    ship: BattleshipBuilder,\n    validRotatedPlacePieceParams: RotationalPositionMap\n  ): void {\n    if (!this._inBoundRotationalPlacePieceParamsForFleet[ship.type])\n      this._inBoundRotationalPlacePieceParamsForFleet[ship.type] =\n        validRotatedPlacePieceParams;\n  }\n}","import {\n  IPlacementConfigurations,\n  IRotationalPivotConfigurations,\n  IShipOptions,\n  ShipLength,\n  ShipSymbols,\n  ShipSymbolValue,\n  ShipType,\n  SizeLookupKey,\n  Version\n} from '../../types/logic-types';\n\nexport const SHIP_SYMBOLS: ShipSymbols = {\n  [ShipType.Carrier]: Symbol('CA'),\n  [ShipType.Battleship]: Symbol('BS'),\n  [ShipType.Cruiser]: Symbol('CR'),\n  [ShipType.Submarine]: Symbol('SB'),\n  [ShipType.Destroyer]: Symbol('DD'),\n  [ShipType.PatrolBoat]: Symbol('PB')\n} as const;\n\nconst sizeLookup: Record<SizeLookupKey, ShipLength | undefined> = {\n  'battleship-1990': 4,\n  'battleship-2002': 4,\n  'carrier-1990': 5,\n  'carrier-2002': 5,\n  'cruiser-1990': 3,\n  'cruiser-2002': undefined, // Explicitly mark missing values\n  'destroyer-1990': 2,\n  'destroyer-2002': 3,\n  'patrolBoat-1990': undefined,\n  'patrolBoat-2002': 2,\n  'submarine-1990': 3,\n  'submarine-2002': 3,\n};\n\nexport class BattleshipBuilder implements IShipOptions {\n  public readonly length: ShipLength;\n  public readonly seaworthy: boolean = true;\n  public readonly symbol: ShipSymbolValue;\n  public rotationalPivotConfigurations: IRotationalPivotConfigurations = {\n    transientAngleOfRotation: null,\n    coordinatesArray: null,\n    orientation: null\n  };\n  public currentplacementConfigurations: IPlacementConfigurations = {\n    coordinatesArray: null,\n    orientation: null\n  };\n  public isPlaced = (): boolean => this.currentplacementConfigurations.coordinatesArray !== null;\n  private _hitCounter: number = 0;\n\n  constructor(public readonly type: ShipType, public readonly version: Version = 2002) {\n    this.symbol = SHIP_SYMBOLS[type];\n\n    const key: SizeLookupKey = `${type}-${version}`;\n    const length: ShipLength | undefined = sizeLookup[key]; // Access using the typed key\n    if (length === undefined) {\n      throw new Error(`Invalid Command: ship type/version combination: ${key}.`);\n    }\n\n    this.length = length;\n  }\n\n  public hit = (): string => {\n    if (!this.isSeaworthy()) return 'This ship has already perished.';\n    \n    this._hitCounter++;\n    return `Hit registered. Hit count: ${this.hitCounter}.`; // Return the updated hit counter\n  };\n\n  isSeaworthy = (): boolean => this.hitCounter < this.length;\n\n  public resetConfigurations = (shouldResetShipRotationalData: boolean) => {\n    const placementConfigurations = { coordinatesArray: null, orientation: null };\n\n    this.currentplacementConfigurations = placementConfigurations;\n\n    if (shouldResetShipRotationalData === true) {\n      this.rotationalPivotConfigurations = {\n        ...placementConfigurations,\n        transientAngleOfRotation: null\n      };\n    }\n  };\n\n  public get hitCounter(): number {\n    return this._hitCounter;\n  }\n}","import {\n  Fleet,\n  FleetConfigs,\n  ShipType,\n  Version,\n} from '../../types/logic-types';\nimport {\n  BattleshipBuilder,\n} from '../bs-ship-builder/bs-ship-builder';\nimport { isShipType } from '../../utilities/logic-utilities';\n\nexport class BattleshipFleetBuilder {\n  private constructor(public readonly fleet: Fleet, public readonly version: Version) {}\n\n  private static createFleet(fleetConfigs: FleetConfigs): Fleet {\n    const fleet: Fleet = {};\n\n    for (const [shipType, config] of Object.entries(fleetConfigs)) {\n      if (config && isShipType(shipType)) {\n        fleet[shipType] = new BattleshipBuilder(config.type, config.version);\n      }\n    }\n\n    return fleet;\n  }\n\n  public static createHasbroFleet(): BattleshipFleetBuilder {\n    // 2002\n    return new BattleshipFleetBuilder(\n      BattleshipFleetBuilder.createFleet({\n        carrier: { type: ShipType.Carrier, version: 2002 },\n        battleship: { type: ShipType.Battleship, version: 2002 },\n        destroyer: { type: ShipType.Destroyer, version: 2002 },\n        submarine: { type: ShipType.Submarine, version: 2002 },\n        patrolBoat: { type: ShipType.PatrolBoat, version: 2002 },\n      }),\n      2002\n    );\n  }\n\n  public static createMBFleet(): BattleshipFleetBuilder {\n    // 1990\n    return new BattleshipFleetBuilder(\n      BattleshipFleetBuilder.createFleet({\n        carrier: { type: ShipType.Carrier, version: 1990 },\n        battleship: { type: ShipType.Battleship, version: 1990 },\n        cruiser: { type: ShipType.Cruiser, version: 1990 },\n        submarine: { type: ShipType.Submarine, version: 1990 },\n        destroyer: { type: ShipType.Destroyer, version: 1990 },\n      }),\n      1990\n    );\n  }\n\n  getShip(shipType: ShipType): BattleshipBuilder {\n    const ship = this.fleet[shipType];\n\n    if (!ship) {\n      throw new Error(\n        `Invalid Command: Ship of type ${shipType} not found in fleet.`\n      );\n    }\n\n    return ship;\n  }\n}","import {\n  Coordinates,\n  Fleet,\n  IPlacePieceWrapperParams,\n  IShipPlacementConfigurations,\n  Orientation,\n  IPosition,\n  PositionArray,\n  AxisArrayKey,\n} from '../types/logic-types';\nimport {\n  areArraysEqual,\n  getRandomInt,\n} from '../utilities/random-utilities';\nimport { BattleshipBuilder } from '../logic/bs-ship-builder/bs-ship-builder';\nimport { BattleshipBoardController } from '../logic/bs-gameboard-controller/bs-gameboard-controller';\nimport { isShipType } from '../utilities/logic-utilities';\n\nexport function randomizeBSGameboard(\n  gameboardController: BattleshipBoardController, fleet: Fleet\n) {\n  if (!gameboardController)\n    throw new Error('Invalid Command: `gameboardController` is required to randomize the gameboard.');\n  if (!fleet)\n    throw new Error('Invalid Command: `fleet` is required to randomize the gameboard.');\n\n  const generateRandomCoordinates = (\n    shipLength: number,\n    boardSize: number\n  ): Coordinates => {\n    const max: number = boardSize - shipLength;\n    const xRandom: number = getRandomInt(0, max);\n    const yRandom: number = getRandomInt(0, max);\n\n    return [xRandom, yRandom];\n  };\n  const generateRandomOrientation = (): Orientation => {\n    return Math.random() < 0.5 ? 'horizontal' : 'vertical';\n  };\n  const areCoordinatesValid = (\n    coordinates: Coordinates,\n    ship: BattleshipBuilder,\n    orientation: Orientation\n  ): boolean => {\n    const validPositionsParams: IShipPlacementConfigurations = {\n      shipLength: ship.length,\n      orientation,\n    };\n\n    const validPositions =\n      gameboardController.getValidPositions(validPositionsParams);\n    const [bowX, bowY]: Coordinates = coordinates;\n    const isHorizontal: boolean = orientation === 'horizontal';\n    const axisIndex: number = isHorizontal ? bowY : bowX;\n\n    const axisArrayKey: AxisArrayKey = isHorizontal\n      ? `row-${axisIndex}`\n      : `column-${axisIndex}`;\n    const axisArray: PositionArray = validPositions[axisArrayKey];\n\n    return axisArray.some((position: IPosition) =>\n      areArraysEqual(position.bow, coordinates)\n    );\n  }; \n  const getValidCoordinatesRecursively = (\n    ship: BattleshipBuilder,\n    orientation: Orientation,\n    boardSize: number,\n    attempts: number = 0\n  ): Coordinates => {\n    if (attempts > 100)\n      throw new Error(`Max recursion depth exceeded when placing the ${ship.type}.`);\n\n    const coordinates: Coordinates = generateRandomCoordinates(\n      ship.length,\n      boardSize\n    );\n\n    return areCoordinatesValid(coordinates, ship, orientation)\n      ? coordinates\n      : getValidCoordinatesRecursively(\n          ship,\n          orientation,\n          boardSize,\n          attempts + 1\n        )\n  };\n\n  const boardSize: number = 10;\n\n  for (const shipType in fleet) {\n    if (!isShipType(shipType)) throw new Error(`Invalid Type: \"${shipType}\" doesn't conform to \"ShipType\".`);\n\n    const ship: BattleshipBuilder = fleet[shipType]!;\n    const randomOrientation: Orientation = generateRandomOrientation();\n\n    const coordinates: Coordinates = getValidCoordinatesRecursively(\n      ship,\n      randomOrientation,\n      boardSize\n    );\n\n    const placePieceParams: IPlacePieceWrapperParams = {\n      ship,\n      coordinates,\n      orientation: randomOrientation,\n    };\n    \n    gameboardController.placePiece(placePieceParams);\n  }\n}\n","import { PlayerState } from \"../types/state-types\";\nimport {\n  createBattleshipBoardBuilderSet,\n  createBattleshipBoardRepositorySet,\n  createBattleshipControllerSet,\n  createBattleshipFleetBuilderSet,\n} from \"../utilities/logic-utilities\";\n\nconst { playerOneBoardBuilder, playerTwoBoardBuilder } =\n  createBattleshipBoardBuilderSet();\n\nconst { playerOneBoardRepository, playerTwoBoardRepository } =\n  createBattleshipBoardRepositorySet();\n\nconst { playerOneFleetBuilder, playerTwoFleetBuilder } =\n    createBattleshipFleetBuilderSet();\n\nconst { playerOneBoardController, playerTwoBoardController } =\n  createBattleshipControllerSet(\n    { playerOneBoardBuilder, playerTwoBoardBuilder },\n    { playerOneBoardRepository, playerTwoBoardRepository },\n    { playerOneFleetBuilder, playerTwoFleetBuilder }\n  );\n\nconst playerOne: PlayerState = {\n  gameboardBuilder: playerOneBoardBuilder,\n  gameboardController: playerOneBoardController,\n  gameboardRepository: playerOneBoardRepository,\n  fleetBuilder: playerOneFleetBuilder\n};\n\nconst playerTwo: PlayerState = {\n  gameboardBuilder: playerTwoBoardBuilder,\n  gameboardController: playerTwoBoardController,\n  gameboardRepository: playerTwoBoardRepository,\n  fleetBuilder: playerTwoFleetBuilder\n};\n\nexport const players = {\n  playerOne,\n  playerTwo\n};","// ðŸ’­ Pub-sub/Mediator Pattern\n\ntype Listener<T = any> = (data: T) => void;\n\nclass EventBus {\n  private events: Record<string, Array<Listener>> = {};\n\n  /**\n   * Register a listener for a specific event.\n   * @param eventName - The name of the event.\n   * @param fn - The callback function to register.\n   */\n  on<T>(eventName: string, fn: Listener<T>): void {\n    this.events[eventName] = this.events[eventName] || [];\n    this.events[eventName].push(fn);\n  }\n\n  /**\n   * Unregister a listener for a specific event.\n   * @param eventName - The name of the event.\n   * @param fn - The callback function to remove.\n   */\n  off<T>(eventName: string, fn: Listener<T>): void {\n    if (this.events[eventName]) {\n      this.events[eventName] = this.events[eventName].filter(\n        (listener) => listener !== fn\n      );\n    }\n  }\n\n  /**\n   * Emit an event, calling all listeners registered for it.\n   * @param eventName - The name of the event.\n   * @param data - The data to pass to the listeners (optional).\n   */\n  emit<T>(eventName: string, data?: T): void {\n    if (this.events[eventName]) {\n      this.events[eventName].forEach((fn) => fn(data));\n    }\n  }\n}\n\nconst GlobalEventBus = new EventBus();\n\nexport default GlobalEventBus;","import { BattleshipBuilder } from './typescript/logic/bs-ship-builder/bs-ship-builder';\nimport { BattleshipBoardController } from './typescript/logic/bs-gameboard-controller/bs-gameboard-controller';\nimport { randomizeBSGameboard } from './typescript/setup/randomize-bs-gameboard';\nimport { players } from './typescript/state/player-state';\nimport { GameboardComponent } from './typescript/components/gameboard-component/gameboard-component';\nimport './styles/sass/main.scss'\nimport { ShipShufflerButtonComponent } from './typescript/components/ship-shuffler-component';\n\nfunction init() {\n  const randomizeBSGameboards = () => {\n    randomizeBSGameboard(\n      players.playerOne.gameboardController,\n      players.playerOne.fleetBuilder.fleet\n    );\n    randomizeBSGameboard(\n      players.playerTwo.gameboardController,\n      players.playerTwo.fleetBuilder.fleet\n    );\n  };\n\n  // benchmark board set randomization\n  console.time('randomizeBSGameboards');\n  randomizeBSGameboards();\n  console.timeEnd('randomizeBSGameboards'); \n\n  // create and render gameboard component to '#content`\n  const gameboardComponent = new GameboardComponent('playerTwo', players.playerTwo);\n  gameboardComponent.render('#content');\n\n  const shipShuffler = new ShipShufflerButtonComponent(\n    players.playerTwo.gameboardController,\n    players.playerTwo.fleetBuilder.fleet,\n    '#content',\n    'player-one-randomizer-button',\n  );\n\n  shipShuffler.render('#content');\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ ----------------- TESTING GAMEBOARD METHODS ------------------\n\n  const computerBoardController: BattleshipBoardController = players.playerTwo.gameboardController;\n  const computerBoardRepository = players.playerTwo.gameboardRepository;\n  const computerCarrier: BattleshipBuilder = players.playerTwo.fleetBuilder.fleet.carrier!;\n\n  // // * Should log warning because ship is already placed\n  // // console.log('Intentional invalid ship placement:')\n  // // computerBoardController.placePiece({ ship: computerCarrier, coordinates: [0, 0], orientation: 'horizontal' });\n  \n  // console.log('Initial fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n\n  // // * initial board print\n  // console.log('Initial randomized board');\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship once\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship again\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship another time\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship penultimately\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship once more\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * move da ship\n  // console.log(`Move ${computerCarrier.type}:`);\n  // computerBoardController.movePiece(computerCarrier, [9, 0]);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship in new position\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship penultimately, again\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship once more, again\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  \n  // // * check all coordinates the ship occupies\n  // console.log('Final fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n}\n\n// time all the above stuff\nconsole.time('init');\ninit();\nconsole.timeEnd('init');","import { BattleshipFleetBuilder } from '../../logic/bs-fleet-builder/bs-fleet-builder';\nimport {\n  Coordinates,\n  CoordinatesArray,\n  Fleet,\n  Gameboard,\n  Orientation,\n  ShipLength,\n  ShipSymbolValue,\n  ShipSymbolValueArray,\n  ShipType,\n} from '../../types/logic-types';\nimport {\n  areArraysEqual,\n  createElement,\n  createPlayerIdentifier,\n  getConvertedTypeFromAttr,\n} from '../../utilities/random-utilities';\nimport { GridPlacementValue } from '../../types/css-types';\nimport { PlayerState } from '../../types/state-types';\nimport GlobalEventBus from '../../utilities/event-bus';\nimport { isOrientation, isShipLength, isShipType } from '../../utilities/logic-utilities';\nimport { DragState } from '../component-types';\nimport { BattleshipBoardController } from '../../logic/bs-gameboard-controller/bs-gameboard-controller';\n\nexport class GameboardComponent {\n  private boardContainer: HTMLDivElement;\n  private fleetElements: Set<HTMLDivElement> = new Set();\n\n  constructor(\n    private readonly id: string,\n    public readonly playerState: PlayerState\n  ) {\n    this.boardContainer = this.generateBoardContainer(\n      this.playerState.gameboardBuilder.boardSize\n    );\n\n    GlobalEventBus.on('updateGameboard', () => {\n      this.updateGameboard();\n    });\n  }\n\n  public render(targetSelector: string): void {\n    const target: HTMLElement | null = document.querySelector(targetSelector);\n\n    if (!target) {\n      throw new Error(\n        `Target element not found with ID - ${this.id} and selector - \"${targetSelector}\".`\n      );\n    }\n\n    const gameboard: DocumentFragment = this.generateBoardFragment(\n      this.playerState.gameboardBuilder.boardSize\n    );\n\n    this.boardContainer.appendChild(gameboard);\n\n    this.handleFleetPlacement(\n      this.playerState.fleetBuilder,\n      this.fleetElements\n    );\n\n    target.appendChild(this.boardContainer);\n  }\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ Helpers\n\n  private appendFleetClonesToGameboard(fleetElements: Set<HTMLDivElement>) {\n    const gameboard: HTMLDivElement | null =\n      this.boardContainer.querySelector('.gameboard');\n\n    if (!gameboard) throw new Error('Gameboard not found');\n\n    fleetElements.forEach((shipElement) => {\n      const shipCloneElement: HTMLDivElement = createElement(\n        'div',\n        ['ship-container-clone'],\n        {\n          id: `${shipElement.getAttribute('id')}-clone`,\n        }\n      );\n\n      gameboard.appendChild(shipCloneElement);\n    });\n  }\n\n  private clearBoardContainer(boardContainer: HTMLDivElement): void {\n    while (boardContainer.firstChild) {\n      boardContainer.removeChild(boardContainer.firstChild);\n    }\n  }\n\n  private createBackgroundCellsFragment(\n    gameboard: Gameboard\n  ): DocumentFragment {\n    const cellFragment: DocumentFragment = new DocumentFragment();\n\n    gameboard.forEach((row: ShipSymbolValueArray, rowIndex) => {\n      row.forEach((symbol: ShipSymbolValue, colIndex) => {\n        const symbolDescription: string = symbol.description!.toLowerCase();\n\n        const gridCell: HTMLDivElement = createElement(\n          'div',\n          [\n            `${createPlayerIdentifier(this.id, symbolDescription)}-cell`,\n            'grid-cell',\n          ],\n          {\n            'data-x': colIndex.toString(),\n            'data-y': rowIndex.toString(),\n            'aria-label': `Row ${rowIndex + 1}, Column ${colIndex + 1}`,\n            role: 'gridCell',\n          }\n        );\n\n        const gridCellContainer: HTMLDivElement = createElement('div', [\n          createPlayerIdentifier(\n            this.id,\n            `${symbolDescription}-cell-container`\n          ),\n          'grid-cell-container',\n        ]);\n\n        gridCellContainer.appendChild(gridCell);\n        cellFragment.appendChild(gridCellContainer);\n      });\n    });\n\n    return cellFragment;\n  }\n\n  private createShipElement(\n    shipType: ShipType,\n    shipLength: ShipLength,\n    gridPlacementValue: string,\n    gridCrossAxis: number,\n    orientation: Orientation\n  ): HTMLDivElement {\n    const shipUnitFragment: DocumentFragment = this.generateShipUnitFragment(\n      shipLength,\n      shipType,\n      this.id\n    );\n\n    const shipContainerElement: HTMLDivElement = createElement(\n      'div',\n      ['ship-container'],\n      {\n        id: createPlayerIdentifier(this.id, `${shipType}-container`),\n        'data-shipType': shipType,\n        'data-length': shipLength.toString(),\n        'data-orientation': orientation,\n        draggable: 'true',\n      }\n    );\n    shipContainerElement.style.display = 'grid';\n    shipContainerElement.appendChild(shipUnitFragment);\n\n    const isHorizontal: boolean = orientation === 'horizontal';\n    if (isHorizontal) {\n      shipContainerElement.style.gridColumn = gridPlacementValue;\n      shipContainerElement.style.gridRow = gridCrossAxis.toString();\n      shipContainerElement.style.gridTemplateColumns = `repeat(${shipLength}, 1fr)`;\n    } else {\n      shipContainerElement.style.gridRow = gridPlacementValue;\n      shipContainerElement.style.gridColumn = gridCrossAxis.toString();\n      shipContainerElement.style.gridTemplateRows = `repeat(${shipLength}, 1fr)`;\n    }\n\n    return shipContainerElement;\n  }\n\n  private generateBoardContainer(boardSize: number): HTMLDivElement {\n    const gameboardContainer: HTMLDivElement = createElement(\n      'div',\n      ['gameboard-container'],\n      {\n        id: createPlayerIdentifier(this.id, 'gameboard-container'),\n      }\n    );\n\n    gameboardContainer.style.setProperty('--grid-size', boardSize.toString());\n\n    this.handleDragListeners(gameboardContainer);\n    this.handleClickListeners(gameboardContainer);\n\n    return gameboardContainer;\n  }\n\n  private generateBoardFragment(boardSize: number): DocumentFragment {\n    const gameboardBackground: HTMLDivElement = createElement(\n      'div',\n      ['gameboard-background'],\n      {\n        id: createPlayerIdentifier(this.id, 'gameboard-background'),\n      }\n    );\n    gameboardBackground.appendChild(\n      this.createBackgroundCellsFragment(\n        this.playerState.gameboardBuilder.board\n      )\n    );\n\n    const gameboard = createElement('div', ['gameboard'], {\n      id: createPlayerIdentifier(this.id, 'gameboard'),\n    });\n    gameboard.style.setProperty('--grid-size', boardSize.toString());\n\n    const boardFragment: DocumentFragment = new DocumentFragment();\n    boardFragment.append(gameboardBackground, gameboard);\n\n    return boardFragment;\n  }\n\n  private generateShipUnitFragment(\n    shipLength: ShipLength,\n    shipType: ShipType,\n    id: string\n  ): DocumentFragment {\n    const shipUnitFragment: DocumentFragment = new DocumentFragment();\n\n    for (let i = 0; i < shipLength; i++) {\n      const isBow: boolean = i === 0;\n      const shipUnit: HTMLDivElement = createElement('div', [\n        'ship-unit',\n        createPlayerIdentifier(id, shipType),\n      ]);\n\n      if (isBow) {\n        shipUnit.classList.add('ship-bow');\n        shipUnit.setAttribute(\n          'id',\n          createPlayerIdentifier(id, `${shipType}-bow`)\n        );\n      }\n\n      shipUnitFragment.appendChild(shipUnit);\n    }\n\n    return shipUnitFragment;\n  }\n\n  private getGridPlacementValue(\n    coordinates: Coordinates,\n    orientation: Orientation,\n    shipLength: ShipLength\n  ): [GridPlacementValue, number] {\n    const isHorizontal = orientation === 'horizontal';\n\n    const [x, y] = coordinates;\n    const gridStartMain = isHorizontal ? x + 1 : y + 1;\n    const gridCrossAxis = isHorizontal ? y + 1 : x + 1;\n\n    return [`${gridStartMain} / span ${shipLength}`, gridCrossAxis];\n  }\n\n  private handleFleetPlacement(\n    fleetBuilder: BattleshipFleetBuilder,\n    fleetElements: Set<HTMLDivElement>\n  ) {\n    this.updateFleetElements(fleetBuilder);\n    this.placeFleetOnGameboard(fleetElements);\n    this.appendFleetClonesToGameboard(fleetElements);\n  }\n\n  private placeFleetOnGameboard(fleetElements: Set<HTMLDivElement>): void {\n    const gameboard =\n      this.boardContainer.querySelector<HTMLDivElement>('.gameboard');\n\n    if (!gameboard) {\n      throw new Error('Gameboard container not found.');\n    }\n\n    fleetElements.forEach((shipElement) => gameboard.appendChild(shipElement));\n  }\n\n  private updateFleetElements = (fleetBuilder: BattleshipFleetBuilder) => {\n    if (this.fleetElements.size) this.fleetElements.clear();\n\n    for (const ship of Object.values(fleetBuilder.fleet)) {\n      const shipType: ShipType = ship.type;\n      const shipLength: ShipLength = ship.length;\n\n      const orientation: Orientation | null =\n        ship.currentplacementConfigurations.orientation;\n\n      if (!orientation) throw new Error('Orientation not set.');\n\n      const coordinatesArray: CoordinatesArray | null =\n        ship.currentplacementConfigurations.coordinatesArray;\n\n      if (!coordinatesArray || coordinatesArray.length === 0) {\n        console.log(`The ${shipType} has not been placed. Continuing...`);\n        continue;\n      }\n\n      const [x, y]: Coordinates = coordinatesArray[0];\n      const [gridPlacementValue, gridCrossAxis]: [GridPlacementValue, number] =\n        this.getGridPlacementValue([x, y], orientation, shipLength);\n\n      const shipElement: HTMLDivElement = this.createShipElement(\n        shipType,\n        shipLength,\n        gridPlacementValue,\n        gridCrossAxis,\n        orientation\n      );\n\n      this.fleetElements.add(shipElement);\n    }\n  };\n\n  private updateGameboard() {\n    this.clearBoardContainer(this.boardContainer);\n\n    const gameboard: DocumentFragment = this.generateBoardFragment(\n      this.playerState.gameboardBuilder.boardSize\n    );\n\n    this.boardContainer.appendChild(gameboard);\n\n    this.handleFleetPlacement(\n      this.playerState.fleetBuilder,\n      this.fleetElements\n    );\n  }\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ HTML Drag and Drop API (Repositioning)\n\n  private handleDragListeners(gameboardContainer: HTMLDivElement) {\n    const dragState: DragState = {\n      currentShipInstance: null,\n      initialPlacementConfigurations: null,\n      isValidDropTarget: false,\n      currentDragOverCell: null,\n    };\n\n    gameboardContainer.addEventListener('dragstart', (e: DragEvent) =>\n      this.handleShipDragStart(e, dragState)\n    );\n    gameboardContainer.addEventListener('dragenter', (e: DragEvent) =>\n      this.handleShipDragEnter(e)\n    );\n    gameboardContainer.addEventListener('dragleave', (e: DragEvent) =>\n      this.handleShipDragLeave(e)\n    );\n    gameboardContainer.addEventListener('dragleave', (e: DragEvent) =>\n      this.handleShipDragLeave(e)\n    );\n    gameboardContainer.addEventListener('dragover', (e: DragEvent) =>\n      this.handleShipDragOver(e, dragState)\n    );\n    gameboardContainer.addEventListener('drop', (e: DragEvent) =>\n      this.handleShipDrop(e, dragState)\n    );\n    gameboardContainer.addEventListener('dragend', (e: DragEvent) =>\n      this.handleShipDragEnd(e, dragState)\n    );\n  }\n\n  private handleShipDragStart(e: DragEvent, dragState: DragState) {\n    if (!(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n\n    // Ensure it's a valid ship container\n    if (!e.target.classList.contains('ship-container')) return;\n\n    const snapToClone = (\n      e: DragEvent,\n      boardContainer: HTMLDivElement\n    ): void => {\n      if (!e.target || !(e.target instanceof HTMLDivElement))\n        throw new Error('Target element not found or is not an HTMLElement.');\n\n      const shipContainerElement: HTMLDivElement = e.target;\n      const shipContainerId: string | null =\n        shipContainerElement.getAttribute('id');\n\n      const shipContainerClone: HTMLDivElement | null =\n        boardContainer.querySelector(`#${shipContainerId}-clone`);\n\n      if (!shipContainerClone) throw new Error('Ship clone not found.');\n      if (!shipContainerId)\n        throw new Error(\"Ship container doesn't have an ID.\");\n\n      const shipBoundingRect = shipContainerElement.getBoundingClientRect();\n\n      shipContainerClone.style.height = `${shipBoundingRect.height}px`;\n      shipContainerClone.style.width = `${shipBoundingRect.width}px`;\n\n      const shipBow = shipContainerElement.querySelector(`.ship-bow`);\n      if (!shipBow) throw new Error('Ship bow not found.');\n\n      const shipBowBoundingRect = shipBow?.getBoundingClientRect();\n\n      e.dataTransfer?.setDragImage(\n        shipContainerClone,\n        shipBowBoundingRect.width / 2,\n        shipBowBoundingRect.height / 2\n      );\n\n      // reveal ship container clone\n      shipContainerClone.style.visibility = 'visible'; // Ensure the clone is visible\n      shipContainerClone.style.pointerEvents = 'auto'; // Ensure pointer events work on the clone\n\n      // TODO: Make this less hacky ðŸ« \n      // enable drag events for grid cells under ships\n      setTimeout(() => {\n        shipContainerElement.style.pointerEvents = 'none';\n      }, 0);\n    };\n\n    const classifyValidCellCoordinates = (\n      boardContainer: HTMLDivElement,\n      shipContainerElement: HTMLDivElement,\n      orientation: Orientation,\n      gameboardController: BattleshipBoardController\n    ): void => {\n      const shipLengthAttr: number | null = Number(\n        shipContainerElement.getAttribute('data-length')\n      );\n      if (!shipLengthAttr || !isShipLength(shipLengthAttr)) {\n        throw new Error('Invalid or missing ship type attribute.');\n      }\n\n      const classifyValidBowCells = (\n        gridCells: NodeListOf<HTMLDivElement>,\n        shipLength: ShipLength,\n        orientation: Orientation\n      ) => {\n        const allValidBowCoordinates: Set<Coordinates> =\n          gameboardController.getAllValidBowCoordinates(\n            orientation,\n            shipLength\n          );\n\n        gridCells.forEach((gridCell: HTMLDivElement) => {\n          const gridCellCoordinates: Coordinates = [\n            Number(gridCell.getAttribute('data-x')),\n            Number(gridCell.getAttribute('data-y')),\n          ];\n\n          for (const validBowCoordinates of allValidBowCoordinates) {\n            if (!areArraysEqual(validBowCoordinates, gridCellCoordinates))\n              continue;\n            gridCell.classList.add('valid-bow-coordinates');\n          }\n        });\n      };\n\n      const shipLength: ShipLength = shipLengthAttr;\n\n      const gridCells: NodeListOf<HTMLDivElement> =\n        boardContainer.querySelectorAll('.grid-cell');\n\n      classifyValidBowCells(gridCells, shipLength, orientation);\n    };\n\n    // Update drag state\n    const setUpShipForDrag = (\n      dragState: DragState,\n      fleet: Fleet,\n      shipType: ShipType\n    ) => {\n      // Ensure the ship type exists in the fleet\n\n      if (!fleet[shipType])\n        throw new Error(`The ${shipType} is not present in the fleet.`);\n\n      // Set the current ship instance and its initial configurations\n      dragState.currentShipInstance = fleet[shipType];\n      dragState.initialPlacementConfigurations =\n        dragState.currentShipInstance.currentplacementConfigurations;\n    };\n\n    const shipContainer: HTMLDivElement = e.target;\n\n    // Get ship type and orientation, ensuring valid attributes and types\n    const shipType: ShipType = getConvertedTypeFromAttr(\n      e.target,\n      'data-shiptype',\n      isShipType\n    );\n\n    const orientation: Orientation = getConvertedTypeFromAttr(\n      e.target,\n      'data-orientation',\n      isOrientation\n    );\n\n    const fleet: Fleet = this.playerState.fleetBuilder.fleet;\n\n    setUpShipForDrag(dragState, fleet, shipType);\n\n    if (!dragState.currentShipInstance)\n      throw new Error(\n        `Drag state hasn't been updated with the current ship instance on drag start. Drag State: ${JSON.stringify(\n          dragState\n        )}`\n      );\n\n    // Remove the piece from the gameboard (non-null ensured by `setUpShipForDrag`)\n    this.playerState.gameboardController.removePiece(\n      dragState.currentShipInstance\n    );\n\n    // Handle snapping and classifying valid cells\n    snapToClone(e, this.boardContainer);\n    classifyValidCellCoordinates(\n      this.boardContainer,\n      shipContainer,\n      orientation,\n      this.playerState.gameboardController\n    );\n  }\n\n  private handleShipDragEnter(e: DragEvent) {\n    if (!(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n\n    // Ensure it's a grid cell\n    if (!e.target.classList.contains('grid-cell')) return;\n\n    const gridCell: HTMLDivElement = e.target;\n\n    // Check if current grid cell is valid for placement\n    const areValidBowCoordinates = gridCell.classList.contains(\n      'valid-bow-coordinates'\n    );\n\n    // Add appropriate visual feedback class to grid cell\n    areValidBowCoordinates\n      ? gridCell.classList.add('placement-is-valid')\n      : gridCell.classList.add('placement-is-invalid');\n  }\n\n  private handleShipDragLeave(e: DragEvent) {\n    if (!(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n\n    if (!e.target.classList.contains('grid-cell')) return;\n\n    const gridCell: HTMLDivElement = e.target;\n\n    // Remove assigned visual feedback class from grid cell\n    if (gridCell.classList.contains('placement-is-valid')) {\n      gridCell.classList.remove('placement-is-valid');\n    } else if (gridCell.classList.contains('placement-is-invalid')) {\n      gridCell.classList.remove('placement-is-invalid');\n    }\n  }\n\n  private handleShipDragOver(e: DragEvent, dragState: DragState) {\n    // Enables the drop event to fire\n    e.preventDefault();\n\n    if (!(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n    if (!e.target.classList.contains('grid-cell')) return;\n\n    const gridCell: HTMLDivElement = e.target;\n\n    // Update drag state for cleanup\n    dragState.currentDragOverCell = gridCell;\n\n    // Prevent further operations for invalid cells\n    if (!gridCell.classList.contains('valid-bow-coordinates')) return;\n  }\n\n  private handleShipDrop(e: DragEvent, dragState: DragState) {\n    e.preventDefault();\n\n    if (!e.target || !(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n\n    if (!e.target.classList.contains('valid-bow-coordinates')) return;\n\n    // Validate and modify state\n    const { coordinatesArray, orientation: initialOrientation } =\n      dragState.initialPlacementConfigurations || {};\n    if (!coordinatesArray || !initialOrientation) {\n      throw new Error('Initial placement configurations are incomplete.');\n    }\n\n    dragState.isValidDropTarget = true;\n\n    const validGridCell: HTMLDivElement = e.target;\n\n    // Retrieve new coordinates from the valid grid cell\n    const xAttr = validGridCell.getAttribute('data-x');\n    const yAttr = validGridCell.getAttribute('data-y');\n    if (!xAttr || !yAttr) {\n      throw new Error('Missing or invalid grid cell coordinates.');\n    }\n    const newCoordinates: Coordinates = [Number(xAttr), Number(yAttr)];\n\n    this.playerState.gameboardController.placePiece({\n      ship: dragState.currentShipInstance!,\n      coordinates: newCoordinates,\n      orientation: initialOrientation,\n    });\n\n    // Re-renders board with new ship placement\n    this.updateGameboard();\n\n    // Reset valid drop target state\n    dragState.isValidDropTarget = false;\n  }\n\n  private handleShipDragEnd(e: DragEvent, dragState: DragState) {\n    if (!(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n\n    if (!e.target.classList.contains('ship-container')) return;\n    const resetDragStyles = (shipContainerElement: HTMLDivElement): void => {\n      // Extract and validate ship container ID\n      const shipContainerId: string | null =\n        shipContainerElement.getAttribute('id');\n\n      // Retrieve and validate ship clone element\n      const shipContainerClone: HTMLDivElement | null =\n        this.boardContainer.querySelector(`#${shipContainerId}-clone`);\n\n      if (!shipContainerId || !shipContainerClone) {\n        throw new Error(\n          `Invalid ship container state. ID: ${shipContainerId}, Clone: ${shipContainerClone}`\n        );\n      }\n\n      // Re-hide drag clone\n      shipContainerClone.style.visibility = 'hidden'; // Ensure the clone is visible\n      shipContainerClone.style.pointerEvents = 'none'; // Ensure pointer events are revoked from clone\n\n      // Remove drag events for grid cells under ships\n      shipContainerElement.style.pointerEvents = 'auto';\n    };\n    const resetShipPosition = (): void => {\n      const { coordinatesArray, orientation: initialOrientation } =\n        dragState.initialPlacementConfigurations || {};\n      if (!coordinatesArray || !initialOrientation) {\n        throw new Error('Initial placement configurations are incomplete.');\n      }\n\n      // Get bow coordinates\n      const initialBowCoordinates: Coordinates = coordinatesArray[0];\n\n      // Re-place ship on logic gameboard\n      this.playerState.gameboardController.placePiece({\n        ship: dragState.currentShipInstance!,\n        coordinates: initialBowCoordinates,\n        orientation: initialOrientation,\n      });\n    };\n    const removeVisualFeedback = (\n      currentDragOverCell: HTMLDivElement,\n      isValidDropTarget: boolean\n    ): void => {\n      const feedbackClass: string = isValidDropTarget\n        ? 'placement-is-valid'\n        : 'placement-is-invalid';\n      currentDragOverCell.classList.remove(feedbackClass);\n    };\n\n    const shipContainerElement: HTMLDivElement = e.target;\n\n    try {\n      resetDragStyles(shipContainerElement);\n\n      const { currentDragOverCell, isValidDropTarget } = dragState;\n      if (!currentDragOverCell)\n        throw new Error(\n          `Current drag over cell is missing. Drag state: ${JSON.stringify(\n            dragState\n          )}`\n        );\n      removeVisualFeedback(currentDragOverCell, isValidDropTarget);\n\n      if (!isValidDropTarget) {\n        resetShipPosition();\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ Handle Ship Click (Rotation)\n\n  private handleClickListeners(gameboardContainer: HTMLDivElement) {\n    \n    gameboardContainer.addEventListener('click', (e: MouseEvent) => {\n      this.handleShipRotation(e);\n    });\n\n  }\n\n  private handleShipRotation(e: MouseEvent) {\n    if (!(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n\n    // Ensure it's a valid ship container\n    if (!e.target.classList.contains('ship-container')) return;\n\n    const shipContainer: HTMLDivElement = e.target;\n\n    const shipType: ShipType = getConvertedTypeFromAttr(\n      shipContainer,\n      'data-shiptype',\n      isShipType\n    );\n    \n    const ship = this.playerState.fleetBuilder.getShip(shipType);\n\n    this.playerState.gameboardController.rotatePiece(ship);\n    this.updateGameboard();\n  };\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ Utilities\n\n  // TODO: Do I need this\n  public getId(): string {\n    return this.id;\n  }\n}\n","import { BattleshipBoardController } from \"../logic/bs-gameboard-controller/bs-gameboard-controller\";\nimport { createElement } from \"../utilities/random-utilities\";\nimport { Fleet } from \"../types/logic-types\";\nimport { randomizeBSGameboard } from \"../setup/randomize-bs-gameboard\";\nimport GlobalEventBus from \"../utilities/event-bus\";\n\nexport class ShipShufflerButtonComponent {\n  private readonly ShipShufflerButton: HTMLButtonElement;\n  private readonly ShipShufflerButtonContainer: HTMLDivElement;\n  private readonly ShipShufflerButtonTextContent: string = 'Shuffle Ships';\n\n  constructor(\n    private gameboardController: BattleshipBoardController,\n    private fleet: Fleet,\n    private gameboardTargetSelector: string,\n    private id: string = 'randomizer-button',\n    private classes: string[] = ['randomizer-button']\n  ) {\n    this.validateGameboardTarget(this.gameboardTargetSelector);\n\n    this.ShipShufflerButton = this.createShipShufflerButton(\n      this.id,\n      this.classes\n    );\n    this.ShipShufflerButton.classList.add(...this.classes);\n    this.ShipShufflerButton.textContent = this.ShipShufflerButtonTextContent;\n    this.addEventListener(this.ShipShufflerButton);\n\n    this.ShipShufflerButtonContainer = this.createShipShufflerButtonContainer();\n    this.ShipShufflerButtonContainer.appendChild(this.ShipShufflerButton);\n  }\n\n  public render(targetSelector: string) {\n    const target: HTMLElement | null = document.querySelector(targetSelector);\n\n    if (!target) {\n      throw new Error(`Target element not found: \"${targetSelector}.\"`);\n    }\n\n    target.appendChild(this.ShipShufflerButtonContainer);\n  }\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ Helpers\n\n  private addEventListener(ShipShufflerButton: HTMLButtonElement) {\n    ShipShufflerButton.addEventListener('click', () => {\n      this.randomizeGameboard();\n      this.updateGameboard(this.gameboardTargetSelector);\n    });\n  }\n\n  private createShipShufflerButton(\n    id: string,\n    classes: string[]\n  ): HTMLButtonElement {\n    const button: HTMLButtonElement = createElement('button', [...classes], {\n      id,\n    });\n    return button;\n  }\n\n  private createShipShufflerButtonContainer(): HTMLDivElement {\n    const container: HTMLDivElement = createElement('div', [\n      'randomizer-button-container',\n    ]);\n    return container;\n  }\n\n  private randomizeGameboard() {\n    this.gameboardController.removeAllPieces(this.fleet);\n    randomizeBSGameboard(this.gameboardController, this.fleet);\n  }\n\n  private updateGameboard(targetSelector: string) {\n    GlobalEventBus.emit('updateGameboard', targetSelector);\n  }\n\n  private validateGameboardTarget(gameboardTargetSelector: string) {\n    if (!document.querySelector(gameboardTargetSelector)) {\n      throw new Error(\n        `Invalid gameboard target selector: \"${gameboardTargetSelector}\"`\n      );\n    }\n  }\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ Utilities\n\n  public getId() {\n    return this.id;\n  }\n}"],"names":["areArraysEqual","arrayOne","arrayTwo","length","every","value","index","getConvertedTypeFromAttr","element","attribute","typeGuard","attrValue","getAttribute","Error","getRandomInt","min","max","Math","floor","random","createElement","tag","classes","attributes","document","forEach","cls","classList","add","Object","entries","key","setAttribute","createPlayerIdentifier","playerId","identifier","split","toLowerCase","AnglesOfRotation","ShipType","BattleshipBoardBuilder","static","Symbol","_boardSize","_fillValue","vacant","constructor","this","_board","Array","from","fill","board","boardSize","fillValue","BattleshipBoardController","playerState","getValidPositions","orientation","shipLength","battleshipBoardBuilder","extractAxisArray","axisIndex","gameboard","map","row","findValidPositionsInAxis","axisArray","isHorizontal","streak","validAxisPositions","i","bowPosition","sternPosition","push","bow","stern","validPositionsPerAxis","validPositions","getValidShipPositions","gameboardBuilder","battleshipBoardController","getAllValidBowCoordinates","allValidBowCoordinates","Set","positionsInAxis","values","isPositionsArray","position","movePiece","ship","newBowCoordinates","isPlaced","console","warn","type","currentOrientation","currentplacementConfigurations","newPosition","createPositionObject","isPositionInBounds","x","y","axisArrayKey","createAxisArrayKey","some","arePositionsEqual","placementParameters","coordinates","shouldResetShipRotationalData","relocateShip","placePiece","battleshipBoardRepository","bowX","bowY","isCoordinateInBounds","errorMessage","isPositionValid","shipConfigurations","validPosition","JSON","stringify","getPlacementCoordinates","placementCoordinates","sternX","sternY","primary","axisEnd","placeOnBoard","shipPlacementCoordinates","shipSymbol","symbol","setShipConfigurations","coordinatesArray","placementConfigurations","rotationalPivotConfigurations","transientAngleOfRotation","Degrees0","updateOccupiedCoordinatesSet","shipType","addShipToFleetCoordinates","placeShip","gameboardRepository","setFleetRotatedPlacePieceParams","fleetBuilder","fleet","prettyPrint","table","description","removePiece","isShipValidForRemoval","shipCoordinates","removeShipFromBoard","nullifyShipCoordinatesValue","nullifyShipCoordinateSetValue","resetShipConfigurations","nullifyShipValidRotationalParams","resetConfigurations","removeAllPieces","keys","error","rotatePiece","getNextPiecePlacementParams","rotationalPositionMap","currentAngle","maxAngle","pop","getMaxAngle","originalBowCoordinates","originalOrientation","nextAngle","getNextAngle","find","angle","nextPlacePieceParams","get","inBoundRotationalPlacePieceForFleet","initialAngle","finalPlacePieceParams","isRotatedPositionValid","updateTransientPlacementParams","areCoordinatesVacant","getShipAt","getShipDataAt","angleOfRotation","gameboardSize","newAxisIndexStart","axisIndexEnd","Degrees90","Degrees270","getRotatedPlacePieceParams","applyOffsetToCoordinate","coordinate","determineRotatedOrientation","Degrees180","getRotatedBowCoordinates","rotationalPivotBowCoordinates","rotatedBowCoordinates","areCoordinatesInBounds","rotationalPivotOrientation","rotatedPiecePlacementParams","createRotatedPiecePlacementParams","rotatedPlacePieceParamsMap","rotatedPlacePieceParams","Map","angleOfRotationString","angleOfRotationToNum","includes","rotatedPlacePieceParamsValue","isPlacePieceParams","isOutOfBounds","bowCoordinates","placePieceParams","set","generateRotationalPositionMap","isShipPlaced","setShipRotatedPlacePieceParams","setShipValidRotationalParams","BattleshipBoardRepository","_fleetCoordinates","_inBoundRotationalPlacePieceParamsForFleet","fleetCoordinates","setMemberTemplate","isFleetCoordinates","validateTypes","OccupiedCoordinatesSet","isShipType","isOccupiedCoordinatesSet","coordinateSetMemberKey","occupiedCoordinatesSet","has","validRotatedPlacePieceParams","SHIP_SYMBOLS","Carrier","Battleship","Cruiser","Submarine","Destroyer","PatrolBoat","sizeLookup","undefined","BattleshipBuilder","seaworthy","_hitCounter","version","hit","isSeaworthy","hitCounter","BattleshipFleetBuilder","createFleet","fleetConfigs","config","createHasbroFleet","carrier","battleship","destroyer","submarine","patrolBoat","createMBFleet","cruiser","getShip","createBattleshipBoardController","positionOne","positionTwo","isCoordinates","isArray","member","isOccupiedCoordinatesSetMemberKey","OccupiedCoordinatesSetOrNull","isOrientation","proto","getPrototypeOf","prototype","isPlainObject","isPosition","match","randomizeBSGameboard","gameboardController","getValidCoordinatesRecursively","attempts","generateRandomCoordinates","areCoordinatesValid","validPositionsParams","randomOrientation","playerOneBoardBuilder","playerTwoBoardBuilder","playerOneBoardRepository","playerTwoBoardRepository","playerOneFleetBuilder","playerTwoFleetBuilder","createBattleshipFleetBuilder","createBattleshipFleetBuilderSet","playerOneBoardController","playerTwoBoardController","createBattleshipControllerSet","players","playerOne","playerTwo","events","on","eventName","fn","off","filter","listener","emit","data","time","timeEnd","fleetElements","id","boardContainer","generateBoardContainer","GlobalEventBus","updateGameboard","render","targetSelector","target","querySelector","generateBoardFragment","appendChild","handleFleetPlacement","appendFleetClonesToGameboard","shipElement","shipCloneElement","clearBoardContainer","firstChild","removeChild","createBackgroundCellsFragment","cellFragment","DocumentFragment","rowIndex","colIndex","symbolDescription","gridCell","toString","role","gridCellContainer","createShipElement","gridPlacementValue","gridCrossAxis","shipUnitFragment","generateShipUnitFragment","shipContainerElement","draggable","style","display","gridColumn","gridRow","gridTemplateColumns","gridTemplateRows","gameboardContainer","setProperty","handleDragListeners","handleClickListeners","gameboardBackground","boardFragment","append","isBow","shipUnit","getGridPlacementValue","updateFleetElements","placeFleetOnGameboard","size","clear","log","dragState","currentShipInstance","initialPlacementConfigurations","isValidDropTarget","currentDragOverCell","addEventListener","e","handleShipDragStart","handleShipDragEnter","handleShipDragLeave","handleShipDragOver","handleShipDrop","handleShipDragEnd","HTMLDivElement","contains","shipContainer","setUpShipForDrag","snapToClone","shipContainerId","shipContainerClone","shipBoundingRect","getBoundingClientRect","height","width","shipBow","shipBowBoundingRect","dataTransfer","setDragImage","visibility","pointerEvents","setTimeout","classifyValidCellCoordinates","shipLengthAttr","Number","classifyValidBowCells","gridCells","gridCellCoordinates","validBowCoordinates","querySelectorAll","remove","preventDefault","initialOrientation","validGridCell","xAttr","yAttr","newCoordinates","resetDragStyles","resetShipPosition","initialBowCoordinates","removeVisualFeedback","feedbackClass","handleShipRotation","getId","ShipShufflerButtonTextContent","gameboardTargetSelector","validateGameboardTarget","ShipShufflerButton","createShipShufflerButton","textContent","ShipShufflerButtonContainer","createShipShufflerButtonContainer","randomizeGameboard"],"sourceRoot":""}