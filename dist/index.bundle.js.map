{"version":3,"file":"index.bundle.js","mappings":"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","sources":["webpack://battleship/./src/typescript/utilities/random-utilities.ts","webpack://battleship/./src/typescript/types/logic-types.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-builder/bs-gameboard-builder.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-controller/bs-gameboard-controller.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-controller/helpers/get-valid-ship-positions/get-valid-ship-positions.ts","webpack://battleship/./src/typescript/utilities/logic-utilities.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-controller/helpers/place-ship/place-ship.ts","webpack://battleship/./src/typescript/logic/bs-gameboard-repository/bs-gameboard-repository.ts","webpack://battleship/./src/typescript/logic/bs-ship-builder/bs-ship-builder.ts","webpack://battleship/./src/typescript/logic/bs-fleet-builder/bs-fleet-builder.ts","webpack://battleship/./src/typescript/setup/randomize-bs-gameboard.ts","webpack://battleship/./src/typescript/state/player-state.ts","webpack://battleship/./src/typescript/utilities/event-bus.ts","webpack://battleship/./src/app.ts","webpack://battleship/./src/typescript/components/gameboard-component/gameboard-component.ts","webpack://battleship/./src/typescript/components/ship-shuffler-component.ts"],"sourcesContent":["export const areArraysEqual = <T>(arrayOne: T[], arrayTwo: T[]) =>\n  arrayOne.length === arrayTwo.length\n  &&\n  arrayOne.every((value, index) => value === arrayTwo[index]);\n\nexport const getConvertedTypeFromAttr = <T extends string>(\n  element: HTMLElement,\n  attribute: string,\n  typeGuard: (value: string) => value is T\n): T => {\n  const attrValue = element.getAttribute(attribute);\n  if (!attrValue || !typeGuard(attrValue)) {\n    throw new Error(`Invalid or missing attribute: ${attribute}`);\n  }\n  return attrValue;\n};\n\nexport const getRandomInt = (min: number, max: number): number =>\n  Math.floor(Math.random() * (max - min + 1)) + min;\n\nexport const isEmptyObject = (obj: Record<PropertyKey, unknown>): boolean => {\n  return (\n    Object.keys(obj).length === 0 &&\n    Object.getOwnPropertySymbols(obj).length === 0\n  );\n};\n\nexport type Range<N extends number, Acc extends number[] = []> =\n  Acc['length'] extends N\n    ? Acc[number]\n    : Range<N, [...Acc, Acc['length']]>;\n    \n\nexport const createElement = <K extends keyof HTMLElementTagNameMap>(\n  tag: K,\n  classes: string[] = [],\n  attributes: Record<string, string> = {}\n): HTMLElementTagNameMap[K] => {\n  const element: HTMLElementTagNameMap[K] = document.createElement(tag);\n  classes.forEach((cls) => element.classList.add(cls));\n  Object.entries(attributes).forEach(([key, value]) =>\n    element.setAttribute(key, value)\n  );\n  return element;\n};\n\nexport const createPlayerIdentifier = (playerId: string, identifier: string): string => {\n  const playerNumberString: string = playerId.split('player')[1].toLowerCase();\n  return `player-${playerNumberString}-${identifier}`;\n};\n","import { BattleshipFleetBuilder } from '../logic/bs-fleet-builder/bs-fleet-builder';\nimport { BattleshipBoardBuilder } from '../logic/bs-gameboard-builder/bs-gameboard-builder';\nimport { BattleshipBoardController } from '../logic/bs-gameboard-controller/bs-gameboard-controller';\nimport { BattleshipBoardRepository } from '../logic/bs-gameboard-repository/bs-gameboard-repository';\nimport {\n  BattleshipBuilder,\n  SHIP_SYMBOLS\n} from '../logic/bs-ship-builder/bs-ship-builder';\nimport { PlayerState } from './state-types';\n\n// ðŸ’­ --------------------------------------------------------------\n// ðŸ’­ Enumerations\n\nexport enum AnglesOfRotation {\n  Degrees0 = 0,\n  Degrees90 = 90,\n  Degrees180 = 180,\n  Degrees270 = 270\n};\nexport enum ShipType {\n  Battleship = 'battleship',\n  Carrier = 'carrier',\n  Cruiser = 'cruiser',\n  Destroyer = 'destroyer',\n  PatrolBoat = 'patrolBoat',\n  Submarine = 'submarine',\n};\n\n// ðŸ’­ --------------------------------------------------------------\n// ðŸ’­ Types\n\nexport type AngleOfRotation = null | AnglesOfRotation;\nexport type AxisArrayKey = `row-${number}` | `column-${number}`;\nexport type Coordinates = [number, number];\nexport type CoordinatesArray = Coordinates[];\nexport type OccupiedCoordinatesSet = Set<OccupiedCoordinatesSetMemberKey> | null;\nexport type OccupiedCoordinatesSetMemberKey = `[${number}, ${number}]`;\nexport type Fleet = {\n  [key in ShipType]?: BattleshipBuilder;\n};\nexport type FleetConfigs = {\n  [key in ShipType]?: ShipConfig;\n};\nexport type FleetCoordinates = {\n  [key in ShipType]?: OccupiedCoordinatesSet | null;\n};\n\nexport type FleetValidRotationalParams = {\n  [key in ShipType]?: ValidRotationalPositionMap | null;\n};\nexport type Gameboard = symbol[][];\nexport type OutOfBounds = 'outOfBounds';\nexport type Orientation = 'horizontal' | 'vertical';\nexport type PositionArray = IPosition[];\nexport type RotatedCoordinatesValue = Coordinates | OutOfBounds;\nexport type RotatedPlacePieceParams = {\n  [Key in AnglesOfRotation]?: RotatedPlacePieceParamsValue;\n};\nexport type RotatedPlacePieceParamsValue = IPlacePieceParams | OutOfBounds;\nexport type RotatedPlacePieceConfigurations = IPlacePieceParams | OutOfBounds;\nexport type ShipConfig = {\n  type: ShipType;\n  version?: Version;\n};\nexport type ShipLength = 2 | 3 | 4 | 5;\nexport type ShipSymbols = {\n  [key in ShipType]: symbol; // Each key in ShipType maps to a symbol\n};\nexport type ShipSymbolValueArray = ShipSymbolValue[];\nexport type ShipSymbolValue = typeof SHIP_SYMBOLS[ShipType];\nexport type SizeLookupKey = `${ShipType}-${Version}`;\nexport type ValidRotationalPositionMap = Map<AnglesOfRotation, IPlacePieceParams>;\nexport type Version = 1990 | 2002;\n\n// ðŸ’­ --------------------------------------------------------------\n// ðŸ’­ Interfaces\n\ninterface IGridGameboard<T> {\n  readonly board: T[][];\n  fillValue: T;\n};\nexport interface IGridGameboardSquare<T> extends IGridGameboard<T> {\n  boardSize: number;\n};\nexport interface IBattlehipFleetBuilderSet {\n  playerOneFleetBuilder: BattleshipFleetBuilder;\n  playerTwoFleetBuilder: BattleshipFleetBuilder;\n}\nexport interface IBattleshipGameboardBuilderSet {\n  playerOneBoardBuilder: BattleshipBoardBuilder;\n  playerTwoBoardBuilder: BattleshipBoardBuilder;\n}\nexport interface IBattleshipFleetBuilderSet {\n  playerOneFleetBuilder: BattleshipFleetBuilder;\n  playerTwoFleetBuilder: BattleshipFleetBuilder;\n}\nexport interface IBattleshipGameboardController extends IGridGameboardController {\n  playerState: Omit<PlayerState, 'gameboardController' | 'fleetBuilder'>;\n  getValidPositions(\n    shipPlacementConfigs: IShipPlacementConfigurations\n  ): IValidPositionsResult;\n  movePiece(ship: BattleshipBuilder, newBowCoordinates: Coordinates): void;\n  placePiece(options: IPlacePieceWrapperParams): void;\n  prettyPrint(): void;\n  removePiece(ship: BattleshipBuilder, resetInitialConfigs: boolean): void;\n  removeAllPieces(fleet: Fleet): void;\n  rotatePiece(ship: BattleshipBuilder): void;\n}\nexport interface IBattleshipGameboardControllerSet {\n  playerOneBoardController: BattleshipBoardController;\n  playerTwoBoardController: BattleshipBoardController;\n}\nexport interface IBattleshipGameboardRepositorySet {\n  playerOneBoardRepository: BattleshipBoardRepository;\n  playerTwoBoardRepository: BattleshipBoardRepository;\n}\ninterface IGridGameboardController {\n  placePiece(...args: any): void;\n  removePiece(...args: any): void;\n  removeAllPieces(...args: any): void;\n}\nexport interface IPlacementConfigurations {\n  coordinatesArray: CoordinatesArray | null;\n  orientation: Orientation | null;\n};\nexport interface IRotationalPivotConfigurations extends IPlacementConfigurations {\n  currentAngleOfRotation: AngleOfRotation;\n};\nexport interface IPlacePieceParams {\n  coordinates: Coordinates;\n  orientation: Orientation;\n};\nexport interface IPlacePieceWrapperParams extends IPlacePieceParams {\n  ship: BattleshipBuilder;\n};\nexport interface IPlacePieceCallbackParams extends IPlacePieceWrapperParams {\n  battleshipBoardBuilder: BattleshipBoardBuilder\n  battleshipBoardController: BattleshipBoardController;\n  battleshipBoardRepository: BattleshipBoardRepository;\n};\nexport interface IPosition {\n  bow: Coordinates; // [rowIndex, colIndex]\n  stern: Coordinates; // [rowIndex, colIndex]\n};\nexport interface IShipOptions {\n  hitCounter: number;\n  length: ShipLength;\n  type: ShipType;\n  version: Version;\n};\nexport interface IShipPlacementConfigurations {\n  orientation: Orientation;\n  shipLength: ShipLength;\n};\nexport interface ITestCaseShipHit {\n  expected: string; // Expected output\n  hits: number; // Function returning the string to be tested\n};\nexport interface ITestCaseValidPositions {\n  shipPlacementConfigs: IShipPlacementConfigurations;\n  validPositions: IValidPositionsResult;\n};\nexport interface IValidPlacementCallbackParams extends IShipPlacementConfigurations {\n  battleshipBoardBuilder: BattleshipBoardBuilder;\n  battleshipBoardController: BattleshipBoardController;\n};\nexport interface IValidPositionsResult {\n  [key: AxisArrayKey]: PositionArray;\n};","import {\n  Gameboard,\n  IGridGameboardSquare,\n} from '../../types/logic-types';\n\nexport class BattleshipBoardBuilder implements IGridGameboardSquare<symbol> {\n  private static readonly vacant: symbol = Symbol('VC');\n\n  private readonly _board: Gameboard;\n  private readonly _boardSize: number = 10;\n  private readonly _fillValue: symbol = BattleshipBoardBuilder.vacant;\n\n  constructor() {\n    this._board = Array.from({ length: this._boardSize }, () =>\n      Array(this._boardSize).fill(this._fillValue)\n    );\n  }\n\n  public get board(): Gameboard {\n    return this._board;\n  }\n\n  public get boardSize(): number {\n    return this._boardSize;\n  }\n\n  public get fillValue(): symbol {\n    return this._fillValue;\n  }\n}","import { BattleshipBuilder } from '../bs-ship-builder/bs-ship-builder';\nimport {\n  AngleOfRotation,\n  AnglesOfRotation,\n  AxisArrayKey,\n  Coordinates,\n  CoordinatesArray,\n  Fleet,\n  IBattleshipGameboardController,\n  IPlacePieceCallbackParams,\n  IPlacePieceParams,\n  IPlacePieceWrapperParams,\n  IPosition,\n  IShipPlacementConfigurations,\n  IValidPlacementCallbackParams,\n  IValidPositionsResult,\n  Orientation,\n  RotatedCoordinatesValue,\n  RotatedPlacePieceParams,\n  RotatedPlacePieceParamsValue,\n  ShipLength,\n  ShipType,\n  ValidRotationalPositionMap,\n  PositionArray,\n} from '../../types/logic-types';\nimport { PlayerState } from '../../types/state-types';\nimport {\n  areCoordinatesInBounds,\n  arePositionsEqual,\n  createAxisArrayKey,\n  createPositionObject,\n  isAngleOfRotation,\n  isOutOfBounds,\n  isPlacePieceParams,\n  isPositionInBounds,\n  isPositionsArray,\n} from '../../utilities/logic-utilities';\nimport { getValidShipPositions } from './helpers/get-valid-ship-positions/get-valid-ship-positions';\nimport { placeShip } from './helpers/place-ship/place-ship';\n\nexport class BattleshipBoardController implements IBattleshipGameboardController { \n  constructor(\n    public readonly playerState: Omit<PlayerState, 'gameboardController' | 'fleetBuilder'>\n  ) {}\n\n  public getValidPositions({\n    orientation,\n    shipLength,\n  }: IShipPlacementConfigurations): IValidPositionsResult {\n    const validPlacementArg: IValidPlacementCallbackParams = {\n      orientation,\n      shipLength,\n      battleshipBoardBuilder: this.playerState.gameboardBuilder,\n      battleshipBoardController: this,\n    };\n\n    return getValidShipPositions(validPlacementArg);\n  }\n\n  public getAllValidBowCoordinates(orientation: Orientation, shipLength: ShipLength): Set<Coordinates> {\n    let allValidBowCoordinates: Set<Coordinates> = new Set();\n    const validPositions: IValidPositionsResult = this.getValidPositions({ orientation, shipLength });\n\n    for (const positionsInAxis of Object.values(validPositions)) {\n      if (!isPositionsArray(positionsInAxis)) throw new Error(\n        `Expected each value of validPositions to be an array of IPosition objects, but received: ${typeof positionsInAxis}.`\n      );\n\n      positionsInAxis.forEach(position => allValidBowCoordinates.add(position.bow));\n    };\n\n    return allValidBowCoordinates;\n  }\n\n  public movePiece(\n    ship: BattleshipBuilder,\n    newBowCoordinates: Coordinates\n  ): void {\n    if (!ship.isPlaced()) {\n      console.warn(`Invalid Command: The ${ship.type} has not been placed.`);\n      return;\n    }\n\n    const currentOrientation: Orientation =\n      ship.currentplacementConfigurations.orientation!;\n\n    const newPosition: IPosition = createPositionObject(\n      newBowCoordinates,\n      currentOrientation,\n      ship.length\n    );\n\n    if (!isPositionInBounds(newPosition, this.playerState.gameboardBuilder.boardSize)) {\n      console.warn(\n        `Invalid Command: Position - Bow: [${newPosition.bow}] & Stern: [${newPosition.stern}] is out of bounds for the ${ship.type}.`\n      );\n\n      return;\n    }\n\n    const validPositions: IValidPositionsResult = this.getValidPositions({\n      orientation: currentOrientation,\n      shipLength: ship.length,\n    });\n\n    const isHorizontal: boolean = currentOrientation === 'horizontal';\n    const [x, y]: Coordinates = newBowCoordinates;\n    const axisArrayKey: AxisArrayKey = createAxisArrayKey(\n      isHorizontal ? y : x,\n      isHorizontal\n    );\n\n    const axisArray: PositionArray = validPositions[axisArrayKey];\n\n    const isNewPositionValid: boolean = axisArray.some(\n      (position: IPosition): boolean => arePositionsEqual(position, newPosition)\n    );\n\n    if (isNewPositionValid) {\n      const placementParameters: IPlacePieceWrapperParams = {\n        ship,\n        coordinates: newBowCoordinates,\n        orientation: currentOrientation,\n      };\n      const shouldResetShipRotationalData: boolean = true;\n\n      this.relocateShip(\n        ship,\n        placementParameters,\n        shouldResetShipRotationalData\n      );\n    } else {\n      console.warn(\n        `Invalid Command: Position - Bow: [${newPosition.bow}] & Stern: [${newPosition.stern}] is unavailable for the ${ship.type}.`\n      );\n    }\n  }\n\n  public placePiece({\n    ship,\n    coordinates,\n    orientation,\n  }: IPlacePieceWrapperParams): void {\n    const placeShipArg: IPlacePieceCallbackParams = {\n      ship,\n      coordinates,\n      orientation,\n      battleshipBoardController: this,\n      battleshipBoardBuilder: this.playerState.gameboardBuilder,\n      battleshipBoardRepository: this.playerState.gameboardRepository,\n    };\n\n    placeShip(placeShipArg);\n  }\n\n  public prettyPrint(): void {\n    console.table(\n      this.playerState.gameboardBuilder.board.map((row) =>\n        row.map((symbol) =>\n          symbol.description === 'VC' ? null : symbol.description\n        )\n      )\n    );\n  }\n\n  public removePiece(\n    ship: BattleshipBuilder,\n    shouldResetShipRotationalData: boolean = true\n  ): void {\n    if (!this.isShipValidForRemoval(ship)) return;\n\n    const removeShipFromBoard = (shipCoordinates: CoordinatesArray): void => {\n      shipCoordinates.forEach(([x, y]) => {\n        this.playerState.gameboardBuilder.board[y][x] = this.playerState.gameboardBuilder.fillValue;\n      });\n    };\n    const nullifyShipCoordinateSetValue = (shipType: ShipType): void => {\n      this.playerState.gameboardRepository.nullifyShipCoordinatesValue(shipType);\n    };\n    const resetShipConfigurations = (\n      ship: BattleshipBuilder,\n      shouldResetShipRotationalData: boolean\n    ): void => {\n      if (shouldResetShipRotationalData) {\n        this.playerState.gameboardRepository.nullifyShipValidRotationalParams(ship.type);\n      }\n\n      ship.resetConfigurations(shouldResetShipRotationalData);\n    };\n\n    const shipCoordinates: CoordinatesArray =\n      ship.currentplacementConfigurations.coordinatesArray!;\n\n    removeShipFromBoard(shipCoordinates);\n    nullifyShipCoordinateSetValue(ship.type);\n    resetShipConfigurations(ship, shouldResetShipRotationalData);\n  }\n\n  public removeAllPieces(fleet: Fleet): void {\n    if (!Object.keys(fleet).length) {\n      console.error(\n        'Invalid Command: No ships to remove - Fleet is empty or uninitialized.'\n      );\n      return;\n    }\n\n    for (const ship of Object.values(fleet)) {\n      this.removePiece(ship);\n    }\n  }\n\n  public rotatePiece(ship: BattleshipBuilder): void {\n    const setValidRotatedPlacePieceParams = (ship: BattleshipBuilder): void => {\n        const validRotatedPlacePieceParams: ValidRotationalPositionMap = this.getValidRotatedPlacePieceParams(ship);\n\n        this.playerState.gameboardRepository.setShipValidRotationalParams(\n          ship,\n          validRotatedPlacePieceParams\n        );\n    };\n\n    setValidRotatedPlacePieceParams(ship);\n\n    const canShipBeRotated = (\n      validRotationalPositionMap: ValidRotationalPositionMap\n    ): boolean => validRotationalPositionMap.size > 1;\n\n    const validRotationalPositionMap: ValidRotationalPositionMap =\n      this.playerState.gameboardRepository.fleetValidRotationalParams[ship.type]!;\n\n    if (!canShipBeRotated(validRotationalPositionMap)) {\n      console.warn(`Invalid Command: The ${ship.type} cannot be rotated.`);\n      return;\n    }\n\n    const getNextGreatestAngleOfRotation = (\n      validRotationalPositionMap: ValidRotationalPositionMap\n    ): AngleOfRotation => {\n      const validAnglesOfRotation: AnglesOfRotation[] = Array.from(\n        validRotationalPositionMap.keys()\n      );\n\n      const greatestValidAngleOfRotation: AngleOfRotation =\n        validAnglesOfRotation.filter(\n          (angleOfRotation) => angleOfRotation > shipCurrentAngleOfRotation!\n        )[0];\n\n      return greatestValidAngleOfRotation;\n    };\n    const getGreatestValidAngleOfRotation = (\n      validRotationalPositionMap: ValidRotationalPositionMap\n    ): AngleOfRotation => {\n      let greatestValidAngleOfRotation: AngleOfRotation =\n        AnglesOfRotation.Degrees0;\n\n      for (const [angleOfRotation, _] of validRotationalPositionMap) {\n        greatestValidAngleOfRotation = angleOfRotation;\n      }\n\n      return greatestValidAngleOfRotation;\n    };\n    const getNextValidPiecePlacementParams = (\n      ship: BattleshipBuilder\n    ): IPlacePieceWrapperParams => {\n      const shipCurrentAngleOfRotation: AngleOfRotation =\n        ship.rotationalPivotConfigurations.currentAngleOfRotation;\n      const greatestValidAngleOfRotation: AngleOfRotation =\n        getGreatestValidAngleOfRotation(validRotationalPositionMap);\n\n      if (shipCurrentAngleOfRotation === greatestValidAngleOfRotation) {\n        const originalBowCoordinates: Coordinates =\n          ship.rotationalPivotConfigurations.coordinatesArray![0];\n        const originalOrientation: Orientation =\n          ship.rotationalPivotConfigurations.orientation!;\n\n        ship.rotationalPivotConfigurations.currentAngleOfRotation =\n          AnglesOfRotation.Degrees0;\n\n        return {\n          ship,\n          coordinates: originalBowCoordinates,\n          orientation: originalOrientation,\n        };\n      } else {\n        const validRotationalPositionMap: ValidRotationalPositionMap =\n          this.playerState.gameboardRepository.fleetValidRotationalParams[ship.type]!;\n\n        const nextValidAngleOfRotation: AngleOfRotation =\n          getNextGreatestAngleOfRotation(validRotationalPositionMap);\n\n        const nextValidRotatedPlacePieceParams = validRotationalPositionMap.get(\n          nextValidAngleOfRotation!\n        );\n\n        ship.rotationalPivotConfigurations.currentAngleOfRotation =\n          nextValidAngleOfRotation;\n\n        return {\n          ship,\n          coordinates: nextValidRotatedPlacePieceParams!.coordinates,\n          orientation: nextValidRotatedPlacePieceParams!.orientation,\n        };\n      }\n    };\n\n    const shipCurrentAngleOfRotation: AngleOfRotation =\n      ship.rotationalPivotConfigurations.currentAngleOfRotation;\n    const nextValidPiecePlacementParams: IPlacePieceWrapperParams =\n      getNextValidPiecePlacementParams(ship);\n\n    const shouldResetShipRotationalData: boolean = false;\n\n    this.relocateShip(\n      ship,\n      nextValidPiecePlacementParams,\n      shouldResetShipRotationalData\n    );\n  }\n\n  private areCoordinatesVacant(coordinates: Coordinates): boolean {\n    const [x, y] = coordinates;\n    return this.playerState.gameboardBuilder.board[y][x] === this.playerState.gameboardBuilder.fillValue;\n  }\n\n  // ? maybe use this with UI? (TODO: create return value type)\n  private getShipAt(coordinates: Coordinates) {\n    if (this.areCoordinatesVacant(coordinates)) return;\n\n    return this.playerState.gameboardRepository.getShipDataAt(coordinates);\n  }\n\n  private getValidRotatedPlacePieceParams(ship: BattleshipBuilder) {\n    const applyOffsetToCoordinate = (\n      coordinate: number,\n      shipLength: ShipLength\n    ): number => {\n      const offset: number = shipLength - 1;\n      return coordinate - offset;\n    };\n    const determineRotatedOrientation = (\n      angleOfRotation: AngleOfRotation,\n      isHorizontal: boolean\n    ): Orientation => {\n      return isHorizontal\n        ? angleOfRotation === AnglesOfRotation.Degrees180\n          ? 'horizontal'\n          : 'vertical'\n        : angleOfRotation === AnglesOfRotation.Degrees180\n        ? 'vertical'\n        : 'horizontal';\n    };\n    const getRotatedBowCoordinates = (\n      angleOfRotation: AngleOfRotation,\n      isHorizontal: boolean,\n      [x, y]: Coordinates\n    ): RotatedCoordinatesValue => {\n      if (\n        angleOfRotation === AnglesOfRotation.Degrees0 ||\n        (angleOfRotation === AnglesOfRotation.Degrees90 && isHorizontal) ||\n        (angleOfRotation === AnglesOfRotation.Degrees270 && !isHorizontal)\n      ) {\n        return rotationalPivotBowCoordinates;\n      }\n\n      const rotatedBowCoordinates: Coordinates = isHorizontal\n        ? angleOfRotation === AnglesOfRotation.Degrees180\n          ? [applyOffsetToCoordinate(x, ship.length), y]\n          : [x, applyOffsetToCoordinate(y, ship.length)] // angleOfRotation === 270\n        : angleOfRotation === AnglesOfRotation.Degrees180\n        ? [x, applyOffsetToCoordinate(y, ship.length)]\n        : [applyOffsetToCoordinate(x, ship.length), y]; // angleOfRotation === 90\n\n      return areCoordinatesInBounds(rotatedBowCoordinates, this.playerState.gameboardBuilder.boardSize)\n        ? rotatedBowCoordinates\n        : 'outOfBounds';\n    };\n    const createRotatedPiecePlacementParams = (\n      rotationalPivotBowCoordinates: Coordinates,\n      rotationalPivotOrientation: Orientation\n    ): RotatedPlacePieceParams => {\n      const isHorizontal = rotationalPivotOrientation === 'horizontal';\n\n      const rotatedPiecePlacementParams: RotatedPlacePieceParams = {};\n\n      const anglesOfRotation: AnglesOfRotation[] = [\n        AnglesOfRotation.Degrees0,\n        AnglesOfRotation.Degrees90,\n        AnglesOfRotation.Degrees180,\n        AnglesOfRotation.Degrees270,\n      ];\n\n      anglesOfRotation.forEach((angleOfRotation) => {\n        const coordinates: RotatedCoordinatesValue =\n          angleOfRotation === AnglesOfRotation.Degrees0\n            ? rotationalPivotBowCoordinates\n            : getRotatedBowCoordinates(\n                angleOfRotation,\n                isHorizontal,\n                rotationalPivotBowCoordinates\n              );\n\n        if (coordinates === 'outOfBounds') {\n          rotatedPiecePlacementParams[angleOfRotation] = 'outOfBounds';\n        } else {\n          rotatedPiecePlacementParams[angleOfRotation] = {\n            coordinates,\n            orientation:\n              angleOfRotation === AnglesOfRotation.Degrees0\n                ? rotationalPivotOrientation\n                : determineRotatedOrientation(angleOfRotation, isHorizontal),\n          };\n        }\n      });\n\n      return rotatedPiecePlacementParams;\n    };\n    const validatePosition = (\n      [x, y]: Coordinates,\n      orientation: Orientation,\n      angleOfRotation: AngleOfRotation,\n      shipLength: ShipLength\n    ): boolean => {\n      if (angleOfRotation === AnglesOfRotation.Degrees0) return true;\n\n      const isHorizontal = orientation === 'horizontal';\n      let i: number;\n      let axisIndexEnd: number;\n\n      if (\n        (!isHorizontal && angleOfRotation === AnglesOfRotation.Degrees90) ||\n        (isHorizontal && angleOfRotation === AnglesOfRotation.Degrees270)\n      ) {\n        i = 1;\n        axisIndexEnd = shipLength;\n      } else {\n        i = 0;\n        axisIndexEnd = shipLength - 1;\n      }\n\n      for (i; i < axisIndexEnd; i++) {\n        if (isHorizontal) {\n          if (this.playerState.gameboardBuilder.board[y][x + i] !== this.playerState.gameboardBuilder.fillValue) return false;\n        } else {\n          if (this.playerState.gameboardBuilder.board[y + i][x] !== this.playerState.gameboardBuilder.fillValue) return false;\n        }\n      }\n      return true;\n    };\n    const generateValidRotatedPlacePieceParams = (\n      rotatedPiecePlacementParams: RotatedPlacePieceParams\n    ): ValidRotationalPositionMap => {\n      const validRotatedPlacePieceParams: ValidRotationalPositionMap =\n        new Map();\n\n      for (const angleOfRotationString of Object.keys(rotatedPiecePlacementParams)) {\n        const angleOfRotationToNum = +angleOfRotationString as AngleOfRotation;\n\n        if (!isAngleOfRotation(angleOfRotationToNum)) {\n          throw new Error(`Invalid Type: \"${angleOfRotationString}\" doesn't conform to \"AngleOfRotation\".`);\n        }\n      \n        const rotatedPlacePieceParamsValue: RotatedPlacePieceParamsValue =\n          rotatedPiecePlacementParams[angleOfRotationToNum]!;\n      \n        if (\n          !(isPlacePieceParams(rotatedPlacePieceParamsValue) ||\n          isOutOfBounds(rotatedPlacePieceParamsValue))\n        ) {\n          throw new Error(\n            `Invalid Type: \"${rotatedPlacePieceParamsValue}\" doesn't conform to \"RotatedPlacePieceParams\".`\n          );\n        }\n      \n        if (!isPlacePieceParams(rotatedPlacePieceParamsValue)) continue;\n      \n        const { coordinates: bowCoordinates, orientation }: IPlacePieceParams = rotatedPlacePieceParamsValue;\n      \n        const isPositionValid: boolean = validatePosition(\n          bowCoordinates,\n          orientation,\n          angleOfRotationToNum,\n          ship.length\n        );\n      \n        if (isPositionValid) {\n          const placePieceParams: IPlacePieceParams = {\n            coordinates: bowCoordinates,\n            orientation,\n          };\n        \n          validRotatedPlacePieceParams.set(angleOfRotationToNum, placePieceParams);\n        }\n      }\n\n      return validRotatedPlacePieceParams;\n    };\n\n    const rotationalPivotBowCoordinates: Coordinates =\n      ship.rotationalPivotConfigurations.coordinatesArray![0];\n    const rotationalPivotOrientation: Orientation =\n      ship.rotationalPivotConfigurations.orientation!;\n    const rotatedPiecePlacementParams: RotatedPlacePieceParams =\n      createRotatedPiecePlacementParams(\n        rotationalPivotBowCoordinates,\n        rotationalPivotOrientation\n      );\n\n    const validRotatedPlacePieceParams: ValidRotationalPositionMap =\n      generateValidRotatedPlacePieceParams(rotatedPiecePlacementParams);\n\n    return validRotatedPlacePieceParams;\n  }\n\n  private isShipValidForRemoval(ship: BattleshipBuilder): boolean {\n    if (\n      !ship.currentplacementConfigurations.coordinatesArray ||\n      !this.playerState.gameboardRepository.isShipPlaced(ship.type)\n    ) {\n      console.error(\n        `Error removing ship: ${ship.type} is missing coordinates or not in the fleet.`\n      );\n      return false;\n    }\n\n    return true;\n  }\n\n  private relocateShip(\n    ship: BattleshipBuilder,\n    placementParameters: IPlacePieceWrapperParams,\n    shouldResetShipRotationalData: boolean\n  ): void {\n    this.removePiece(ship, shouldResetShipRotationalData);\n    this.placePiece(placementParameters);\n  }\n}","import {\n  AxisArrayKey,\n  Coordinates,\n  Gameboard,\n  IValidPlacementCallbackParams,\n  IValidPositionsResult,\n  Orientation,\n  PositionArray,\n  ShipLength,\n} from '../../../../types/logic-types';\n\nexport function getValidShipPositions({\n  shipLength,\n  orientation,\n  battleshipBoardBuilder,\n  battleshipBoardController\n}: IValidPlacementCallbackParams): IValidPositionsResult {\n  const extractAxisArray = (\n    axisIndex: number,\n    orientation: Orientation,\n    gameboard: Gameboard\n  ): Array<symbol> => { // or symbol[]\n    \n    return orientation === 'horizontal'\n      ? gameboard[axisIndex] // Returns row #<axisIndex>\n      : gameboard.map(row => row[axisIndex]) // `y` values at column-<axisIndex>\n  };\n  const findValidPositionsInAxis = (\n    axisArray: Array<symbol>, // or symbol[]\n    isHorizontal: boolean,\n    axisIndex: number,\n    shipLength: ShipLength\n  ): PositionArray => {\n    let streak: number = 0;\n    let validAxisPositions: PositionArray = [];\n    \n    for (let i = 0; i < axisArray.length; i++) {\n      if (axisArray[i] === battleshipBoardBuilder.fillValue) {\n        streak++;\n        \n        if (streak >= shipLength) {\n          const bowPosition: Coordinates =\n            isHorizontal\n            ? [i - (shipLength - 1), axisIndex]\n            : [axisIndex, i - (shipLength - 1)];\n          \n          const sternPosition: Coordinates =\n            isHorizontal\n              ? [i, axisIndex]\n              : [axisIndex, i];\n\n          validAxisPositions.push({\n            bow: bowPosition,\n            stern: sternPosition,\n          });\n        }\n      } else {\n        streak = 0;\n      }\n    }\n    \n    return validAxisPositions;\n  };\n\n  const validPositionsPerAxis: IValidPositionsResult = {}; \n  const board: Gameboard = battleshipBoardBuilder.board;\n  const isHorizontal = orientation === 'horizontal';\n\n  for (let axisIndex = 0; axisIndex < board.length; axisIndex++) {\n    const axisArray: Array<symbol> = extractAxisArray(axisIndex, orientation, board);\n    const validPositions: PositionArray = findValidPositionsInAxis(\n      axisArray,\n      isHorizontal,\n      axisIndex,\n      shipLength\n    );\n    \n    const axisTemplate: AxisArrayKey =\n      isHorizontal\n        ? `row-${axisIndex}`\n        : `column-${axisIndex}`;\n    \n    validPositionsPerAxis[axisTemplate] = validPositions;\n  }\n\n  return validPositionsPerAxis;\n}","import {\n  AnglesOfRotation,\n  AxisArrayKey,\n  Coordinates,\n  OccupiedCoordinatesSet,\n  OccupiedCoordinatesSetMemberKey,\n  FleetCoordinates,\n  IBattlehipFleetBuilderSet,\n  IBattleshipFleetBuilderSet,\n  IBattleshipGameboardBuilderSet,\n  IBattleshipGameboardControllerSet,\n  IBattleshipGameboardRepositorySet,\n  IPlacePieceParams,\n  IPosition,\n  IShipPlacementConfigurations,\n  Orientation,\n  OutOfBounds,\n  RotatedCoordinatesValue,\n  ShipLength,\n  ShipType,\n  Version,\n  PositionArray\n} from \"../types/logic-types\";\nimport { BattleshipBoardBuilder } from \"../logic/bs-gameboard-builder/bs-gameboard-builder\";\nimport { BattleshipBoardController } from \"../logic/bs-gameboard-controller/bs-gameboard-controller\";\nimport { BattleshipBoardRepository } from \"../logic/bs-gameboard-repository/bs-gameboard-repository\";\nimport { BattleshipFleetBuilder } from \"../logic/bs-fleet-builder/bs-fleet-builder\";\nimport { areArraysEqual } from \"./random-utilities\";\n\n// ðŸ’­ --------------------------------------------------------------\n\n// * FACTORY FUNCTIONS\nexport function createBattleshipBoardController(\n  gameboardBuilder: BattleshipBoardBuilder,\n  gameboardRepository: BattleshipBoardRepository,\n): BattleshipBoardController {\n  return new BattleshipBoardController({gameboardBuilder, gameboardRepository});\n}\nexport function createBattleshipControllerSet(\n  { playerOneBoardBuilder, playerTwoBoardBuilder}: IBattleshipGameboardBuilderSet,\n  { playerOneBoardRepository, playerTwoBoardRepository }: IBattleshipGameboardRepositorySet,\n): IBattleshipGameboardControllerSet {\n  return {\n    playerOneBoardController: createBattleshipBoardController(\n      playerOneBoardBuilder,\n      playerOneBoardRepository,\n    ),\n    playerTwoBoardController: createBattleshipBoardController(\n      playerTwoBoardBuilder,\n      playerTwoBoardRepository,\n    ),\n  };\n}\nexport function createBattleshipBoardBuilderSet(): IBattleshipGameboardBuilderSet {\n  return {\n    playerOneBoardBuilder: new BattleshipBoardBuilder(),\n    playerTwoBoardBuilder: new BattleshipBoardBuilder(),\n  };\n}\nexport function createBattleshipBoardRepositorySet(): IBattleshipGameboardRepositorySet {\n  return {\n    playerOneBoardRepository: new BattleshipBoardRepository(),\n    playerTwoBoardRepository: new BattleshipBoardRepository(),\n  };\n}\nexport function createBattleshipFleetBuilderSet(\n  version: Version = 2002\n): IBattlehipFleetBuilderSet {\n  const createBattleshipFleetBuilder =\n    version === 2002\n      ? BattleshipFleetBuilder.createHasbroFleet\n      : BattleshipFleetBuilder.createMBFleet;\n\n  return {\n    playerOneFleetBuilder: createBattleshipFleetBuilder(),\n    playerTwoFleetBuilder: createBattleshipFleetBuilder(),\n  };\n}\n\n// ðŸ’­ --------------------------------------------------------------\n\n// * GENERAL HELPER FUNCTIONS\nexport function createAxisArrayKey(\n  axisIndex: number,\n  isHorizontal: boolean\n): AxisArrayKey {\n  return isHorizontal ? `row-${axisIndex}` : `column-${axisIndex}`;\n}\nexport function createPositionObject(\n  [x, y]: Coordinates,\n  orientation: Orientation,\n  shipLength: ShipLength\n): IPosition {\n  const isHorizontal = orientation === 'horizontal';\n  const bowCoordinates: Coordinates = [x, y];\n  const sternCoordinates: Coordinates = isHorizontal\n    ? [x + shipLength - 1, y]\n    : [x, y + shipLength - 1];\n\n  return {\n    bow: bowCoordinates,\n    stern: sternCoordinates,\n  };\n}\nexport function createShipConfigurations(\n  shipLength: ShipLength,\n  orientation: Orientation\n): IShipPlacementConfigurations {\n  return {\n    orientation,\n    shipLength,\n  };\n}\n\n// ðŸ’­ --------------------------------------------------------------\n\n// * BOUND CHECK HELPER FUNCTIONS\nexport const isCoordinateInBounds = (coordinate: number, boardSize: number): boolean =>\n  coordinate >= 0 && coordinate < boardSize;\nexport const areCoordinatesInBounds = (coordinates: Coordinates, boardSize: number): boolean => {\n  return coordinates.every((coordinate) => isCoordinateInBounds(coordinate, boardSize)); \n}\nexport const isPositionInBounds = (position: IPosition, boardSize: number): boolean => {\n  return areCoordinatesInBounds(position.bow, boardSize) && areCoordinatesInBounds(position.stern, boardSize);\n};\n\n// ðŸ’­ --------------------------------------------------------------\n\n// * UTILITY FUNCTIONS\nexport const arePositionsEqual = (\n  positionOne: IPosition,\n  positionTwo: IPosition\n): boolean => {\n  return (\n    areArraysEqual(positionOne.bow, positionTwo.bow) &&\n    areArraysEqual(positionOne.stern, positionTwo.stern)\n  );\n};\n\n// ðŸ’­ --------------------------------------------------------------\n\n// * TYPE GUARDS\nexport function isAngleOfRotation(\n  value: unknown\n): value is AnglesOfRotation {\n  return Object.values(AnglesOfRotation).includes(value as ShipType);\n};\nexport const isCoordinates = (value: unknown): value is Coordinates => {\n  if (!Array.isArray(value) || value.length !== 2) return false;\n\n  return value.every((coordinate) => typeof coordinate === 'number');\n};\nexport const isOccupiedCoordinatesSet = (value: unknown): value is OccupiedCoordinatesSet => {\n  if (value === null) return true;\n  if (!(value instanceof Set)) return false;\n\n  for (const member of value) {\n    if (!isOccupiedCoordinatesSetMemberKey(member)) {\n      return false;\n    }\n  }\n\n  return true;\n};\nexport const isFleetCoordinates = (\n  value: unknown\n): value is FleetCoordinates => {\n  if (typeof value !== 'object' || value === null) return false;\n\n  for (const key in value) {\n    if (!Object.values(ShipType).includes(key as ShipType)) {\n      return false\n    }\n\n    const OccupiedCoordinatesSetOrNull = (value as FleetCoordinates)[\n      key as ShipType\n    ];\n\n    if (OccupiedCoordinatesSetOrNull !== null && !isOccupiedCoordinatesSet(OccupiedCoordinatesSetOrNull)) {\n      return false;\n    }\n  }\n  return true;\n};\nexport const isPlainObject = (value: unknown): value is object => {\n  if (typeof value !== 'object' || value === null) return false;\n\n  const proto = Object.getPrototypeOf(value);\n  return proto === Object.prototype || proto === null;\n  // ? Why `proto === null`: Object.create(null) is a valid plain object.\n}\nexport const isOrientation = (value: unknown): value is Orientation => {\n  if (typeof value !== 'string') return false;\n  return ['horizontal', 'vertical'].includes(value);\n}\nexport const isOutOfBounds = (value: unknown): value is OutOfBounds => {\n  return (value) === 'outOfBounds';\n};\nexport const isPlacePieceParams = (\n  value: unknown\n): value is IPlacePieceParams => {\n  if (typeof value !== 'object' || value === null) return false;\n\n  if (!isCoordinates((value as IPlacePieceParams).coordinates)) return false;\n\n  return true;\n};\nexport const isPosition = (value: unknown): value is IPosition => {\n  if (!isPlainObject(value)) return false;\n\n  const { bow, stern } = value as IPosition;\n\n  return isCoordinates(bow) && isCoordinates(stern);\n};\nexport const isPositionsArray = (value: unknown): value is PositionArray => {\n  if (!Array.isArray(value)) return false;\n\n  return value.every(position => isPosition(position));\n};\nexport const isOccupiedCoordinatesSetMemberKey = (value: unknown): value is OccupiedCoordinatesSetMemberKey => {\n  if (typeof value !== 'string') return false;\n\n  const match = value.match(/^\\[\\d{1}, \\d{1}\\]$/);\n  return match !== null;\n};\nexport const isRotatedCoordinatesValue = (\n  value: unknown\n): value is RotatedCoordinatesValue => {\n  return isCoordinates(value) || isOutOfBounds(value);\n};\nexport const isShipLength = (value: unknown): value is ShipLength => {\n  return typeof value === 'number' && [2, 3, 4, 5].includes(value);\n}\nexport const isShipType = (\n  value: unknown\n): value is ShipType => {\n  return Object.values(ShipType).includes(value as ShipType);\n};\n\n// ðŸ’­ --------------------------------------------------------------\n\nexport const isNotNull = <T>(value: T | null | undefined): value is T => {\n  return value !== null && value !== undefined;\n}","import {\n  AnglesOfRotation,\n  AxisArrayKey,\n  Coordinates,\n  CoordinatesArray,\n  Gameboard,\n  IPlacementConfigurations,\n  IPlacePieceCallbackParams,\n  IPosition,\n  IShipPlacementConfigurations,\n  IValidPositionsResult,\n  Orientation,\n  ShipLength,\n  ShipSymbolValue,\n  ShipType,\n} from '../../../../types/logic-types';\nimport { arePositionsEqual, createPositionObject, isCoordinateInBounds } from '../../../../utilities/logic-utilities';\nimport { BattleshipBuilder } from '../../../bs-ship-builder/bs-ship-builder';\n\nexport function placeShip({\n  ship,\n  coordinates,\n  orientation,\n  battleshipBoardController,\n  battleshipBoardBuilder,\n  battleshipBoardRepository\n}: IPlacePieceCallbackParams): void {  \n  const shipLength: ShipLength = ship.length;\n  const [bowX, bowY]: Coordinates = coordinates;\n  const isHorizontal: boolean = orientation === 'horizontal';\n  const axisStart: number = isHorizontal ? bowX : bowY;\n  const axisEnd = axisStart + shipLength - 1;\n\n  if (!isCoordinateInBounds(axisEnd, battleshipBoardBuilder.boardSize)) {\n    const errorMessage: string = `Invalid Command: The ship placement attempt with the following configurations is out of bounds - Coordinates: ${coordinates}, Length: ${ship.length}, Orientation: ${orientation}.`;\n    throw new Error(errorMessage);\n  };\n\n  if (ship.isPlaced()) {\n    console.warn(`Invalid Command: The ${ship.type} has already been placed.`);\n    return;\n  };\n\n  const isPositionValid = (\n    position: IPosition,\n    shipConfigurations: IShipPlacementConfigurations,\n    axisArrayKey: AxisArrayKey\n  ): boolean => {\n    const validPositions: IValidPositionsResult =\n      battleshipBoardController.getValidPositions(shipConfigurations);\n\n    return validPositions[axisArrayKey].some((validPosition: IPosition) =>\n      arePositionsEqual(position, validPosition)\n    );\n  };\n\n  const position: IPosition = createPositionObject(\n    coordinates,\n    orientation,\n    shipLength,\n  );\n\n  const shipConfigurations: IShipPlacementConfigurations = {\n    shipLength,\n    orientation\n  };\n  const axisArrayKey: AxisArrayKey = isHorizontal\n    ? `row-${bowY}`\n    : `column-${bowX}`; \n    \n  if (isPositionValid(position, shipConfigurations, axisArrayKey)) {\n    const getPlacementCoordinates = (\n      validPosition: IPosition,\n      isHorizontal: Boolean\n    ): CoordinatesArray => {\n      const placementCoordinates: CoordinatesArray = [];\n\n      const [bowX, bowY]: Coordinates = validPosition.bow;\n      const [sternX, sternY]: Coordinates = validPosition.stern;\n\n      const primary: number = isHorizontal\n        ? bowY\n        : bowX;\n      const axisStart: number = isHorizontal\n        ? bowX\n        : bowY;\n      const axisEnd: number = isHorizontal\n        ? sternX\n        : sternY;\n\n      for (let i = axisStart; i <= axisEnd; i++) {\n        placementCoordinates.push(isHorizontal ? [i, primary] : [primary, i]);\n      }\n\n      return placementCoordinates;\n    };\n    const placeOnBoard = (\n      ship: BattleshipBuilder,\n      shipPlacementCoordinates: CoordinatesArray\n    ): void => {\n      const gameboard: Gameboard = battleshipBoardBuilder.board;\n      const shipSymbol: ShipSymbolValue = ship.symbol;\n\n      shipPlacementCoordinates.forEach((coordinates) => {\n        const [x, y]: Coordinates = coordinates;\n        gameboard[y][x] = shipSymbol;\n      });\n    };\n    const setShipConfigurations = (\n      ship: BattleshipBuilder,\n      coordinatesArray: CoordinatesArray,\n      orientation: Orientation\n    ): void => {\n      const placementConfigurations: IPlacementConfigurations = { coordinatesArray, orientation };\n      \n      ship.currentplacementConfigurations = placementConfigurations;\n\n      if (Object.values(ship.rotationalPivotConfigurations).every(value => value === null)) {\n        ship.rotationalPivotConfigurations = {\n          ...placementConfigurations,\n          currentAngleOfRotation: AnglesOfRotation.Degrees0,\n        }\n      }      \n    };\n    const updateOccupiedCoordinatesSet = (\n      shipType: ShipType,\n      placementCoordinates: CoordinatesArray\n    ): void => {\n      battleshipBoardRepository.addShipToFleetCoordinates(\n        shipType,\n        placementCoordinates\n      );\n    };\n\n    const placementCoordinates: CoordinatesArray = getPlacementCoordinates(\n      position,\n      isHorizontal\n    );\n\n    placeOnBoard(ship, placementCoordinates);\n    setShipConfigurations(\n      ship,\n      placementCoordinates,\n      orientation\n    );\n    updateOccupiedCoordinatesSet(ship.type, placementCoordinates);\n  } else {\n    const errorMessage: string = `Invalid Command: \"${JSON.stringify(\n      position\n    )}\" is unavailable for ship with Size: ${shipLength} and Orientation: ${orientation}.`;\n\n    throw new Error(errorMessage);\n  }\n}\n","import { BattleshipBuilder } from \"../bs-ship-builder/bs-ship-builder\";\nimport {\n  Coordinates,\n  CoordinatesArray,\n  OccupiedCoordinatesSetMemberKey,\n  FleetCoordinates,\n  FleetValidRotationalParams,\n  ShipType,\n  ValidRotationalPositionMap\n} from \"../../types/logic-types\";\nimport { isOccupiedCoordinatesSet, isFleetCoordinates, isShipType } from \"../../utilities/logic-utilities\";\n\nexport class BattleshipBoardRepository {\n  private readonly _fleetCoordinates: FleetCoordinates = {};\n  private readonly _fleetValidRotationalParams: FleetValidRotationalParams = {};\n\n  // ðŸ’­ --------------------------------------------------------------\n\n  public get fleetCoordinates(): FleetCoordinates {\n    return this._fleetCoordinates;\n  }\n  public get fleetValidRotationalParams(): FleetValidRotationalParams {\n    return this._fleetValidRotationalParams;\n  }\n\n  public addShipToFleetCoordinates(\n    shipType: ShipType,\n    placementCoordinates: CoordinatesArray\n  ): void {\n    if (!this.fleetCoordinates[shipType]) {\n      this.fleetCoordinates[shipType] = new Set();\n    }\n\n    placementCoordinates.forEach((coordinates: Coordinates) => {\n      const [x, y]: Coordinates = coordinates;\n      const setMemberTemplate: OccupiedCoordinatesSetMemberKey = `[${x}, ${y}]`;\n      this.fleetCoordinates[shipType]!.add(setMemberTemplate);\n    });\n  }\n\n  public getShipDataAt(coordinates: Coordinates) {\n    if (!isFleetCoordinates(this.fleetCoordinates)) {\n      throw new Error(\n        `Invalid Type: \"${this.fleetCoordinates}\" doesn't conform to \"FleetCoordinates\".`\n      );\n    }\n\n    const validateTypes = (shipType: unknown, OccupiedCoordinatesSet: unknown): void => {\n      if (!isShipType(shipType))\n        throw new Error(\n          `Invalid Type: \"${shipType}\" doesn't conform to \"ShipType\".`\n        );\n      if (!isOccupiedCoordinatesSet(OccupiedCoordinatesSet))\n        throw new Error(\n          `Invalid Type: \"${OccupiedCoordinatesSet}\" doesn't conform to \"OccupiedCoordinatesSet\".`\n        );\n    };\n\n    const [x, y]: Coordinates = coordinates;\n    const coordinateSetMemberKey: OccupiedCoordinatesSetMemberKey = `[${x}, ${y}]`;\n\n    for (const [shipType, occupiedCoordinatesSet] of Object.entries(this.fleetCoordinates)) {\n      if (!isShipType(shipType)) throw new Error('');\n      if (!isOccupiedCoordinatesSet(occupiedCoordinatesSet)) throw new Error();\n\n      validateTypes(shipType, occupiedCoordinatesSet);\n\n      if (occupiedCoordinatesSet?.has(coordinateSetMemberKey)) {\n        return {\n          shipType,\n          occupiedCoordinatesSet\n        }\n      }\n    }\n  }\n  \n  public isShipPlaced(shipType: ShipType): boolean {\n    return this.fleetCoordinates[shipType] !== null;\n  }\n  public nullifyShipCoordinatesValue(shipType: ShipType): void {\n    this.fleetCoordinates[shipType] = null;\n  }\n  public nullifyShipValidRotationalParams(shipType: ShipType): void {\n    this.fleetValidRotationalParams[shipType] = null;\n  }\n  public setShipValidRotationalParams(\n    ship: BattleshipBuilder,\n    validRotatedPlacePieceParams: ValidRotationalPositionMap\n  ): void {\n    if (!this._fleetValidRotationalParams[ship.type])\n      this._fleetValidRotationalParams[ship.type] =\n        validRotatedPlacePieceParams;\n  }\n}","import {\n  IPlacementConfigurations,\n  IRotationalPivotConfigurations,\n  IShipOptions,\n  ShipLength,\n  ShipSymbols,\n  ShipSymbolValue,\n  ShipType,\n  SizeLookupKey,\n  Version\n} from '../../types/logic-types';\n\nexport const SHIP_SYMBOLS: ShipSymbols = {\n  [ShipType.Carrier]: Symbol('CA'),\n  [ShipType.Battleship]: Symbol('BS'),\n  [ShipType.Cruiser]: Symbol('CR'),\n  [ShipType.Submarine]: Symbol('SB'),\n  [ShipType.Destroyer]: Symbol('DD'),\n  [ShipType.PatrolBoat]: Symbol('PB')\n} as const;\n\nconst sizeLookup: Record<SizeLookupKey, ShipLength | undefined> = {\n  'battleship-1990': 4,\n  'battleship-2002': 4,\n  'carrier-1990': 5,\n  'carrier-2002': 5,\n  'cruiser-1990': 3,\n  'cruiser-2002': undefined, // Explicitly mark missing values\n  'destroyer-1990': 2,\n  'destroyer-2002': 3,\n  'patrolBoat-1990': undefined,\n  'patrolBoat-2002': 2,\n  'submarine-1990': 3,\n  'submarine-2002': 3,\n};\n\nexport class BattleshipBuilder implements IShipOptions {\n  public readonly length: ShipLength;\n  public readonly seaworthy: boolean = true;\n  public readonly symbol: ShipSymbolValue;\n  public rotationalPivotConfigurations: IRotationalPivotConfigurations = {\n    currentAngleOfRotation: null,\n    coordinatesArray: null,\n    orientation: null\n  };\n  public currentplacementConfigurations: IPlacementConfigurations = {\n    coordinatesArray: null,\n    orientation: null\n  };\n  public isPlaced = (): boolean => this.currentplacementConfigurations.coordinatesArray !== null;\n  private _hitCounter: number = 0;\n\n  constructor(public readonly type: ShipType, public readonly version: Version = 2002) {\n    this.symbol = SHIP_SYMBOLS[type];\n\n    const key: SizeLookupKey = `${type}-${version}`;\n    const length: ShipLength | undefined = sizeLookup[key]; // Access using the typed key\n    if (length === undefined) {\n      throw new Error(`Invalid Command: ship type/version combination: ${key}.`);\n    }\n\n    this.length = length;\n  }\n\n  public hit = (): string => {\n    if (!this.isSeaworthy()) return 'This ship has already perished.';\n    \n    this._hitCounter++;\n    return `Hit registered. Hit count: ${this.hitCounter}.`; // Return the updated hit counter\n  };\n\n  isSeaworthy = (): boolean => this.hitCounter < this.length;\n\n  public resetConfigurations = (shouldResetShipRotationalData: boolean) => {\n    const placementConfigurations = { coordinatesArray: null, orientation: null };\n\n    this.currentplacementConfigurations = placementConfigurations;\n\n    if (shouldResetShipRotationalData === true) {\n      this.rotationalPivotConfigurations = {\n        ...placementConfigurations,\n        currentAngleOfRotation: null\n      };\n    }\n  };\n\n  public get hitCounter(): number {\n    return this._hitCounter;\n  }\n}","import {\n  Fleet,\n  FleetConfigs,\n  ShipType,\n  Version,\n} from '../../types/logic-types';\nimport {\n  BattleshipBuilder,\n} from '../bs-ship-builder/bs-ship-builder';\nimport { isShipType } from '../../utilities/logic-utilities';\n\nexport class BattleshipFleetBuilder {\n  private constructor(public readonly fleet: Fleet, public readonly version: Version) {}\n\n  private static createFleet(fleetConfigs: FleetConfigs): Fleet {\n    const fleet: Fleet = {};\n\n    for (const [shipType, config] of Object.entries(fleetConfigs)) {\n      if (config && isShipType(shipType)) {\n        fleet[shipType] = new BattleshipBuilder(config.type, config.version);\n      }\n    }\n\n    return fleet;\n  }\n\n  public static createHasbroFleet(): BattleshipFleetBuilder {\n    // 2002\n    return new BattleshipFleetBuilder(\n      BattleshipFleetBuilder.createFleet({\n        carrier: { type: ShipType.Carrier, version: 2002 },\n        battleship: { type: ShipType.Battleship, version: 2002 },\n        destroyer: { type: ShipType.Destroyer, version: 2002 },\n        submarine: { type: ShipType.Submarine, version: 2002 },\n        patrolBoat: { type: ShipType.PatrolBoat, version: 2002 },\n      }),\n      2002\n    );\n  }\n\n  public static createMBFleet(): BattleshipFleetBuilder {\n    // 1990\n    return new BattleshipFleetBuilder(\n      BattleshipFleetBuilder.createFleet({\n        carrier: { type: ShipType.Carrier, version: 1990 },\n        battleship: { type: ShipType.Battleship, version: 1990 },\n        cruiser: { type: ShipType.Cruiser, version: 1990 },\n        submarine: { type: ShipType.Submarine, version: 1990 },\n        destroyer: { type: ShipType.Destroyer, version: 1990 },\n      }),\n      1990\n    );\n  }\n\n  getShip(shipType: ShipType): BattleshipBuilder {\n    const ship = this.fleet[shipType];\n\n    if (!ship) {\n      throw new Error(\n        `Invalid Command: Ship of type ${shipType} not found in fleet.`\n      );\n    }\n\n    return ship;\n  }\n}","import {\n  Coordinates,\n  Fleet,\n  IPlacePieceWrapperParams,\n  IShipPlacementConfigurations,\n  Orientation,\n  IPosition,\n  PositionArray,\n  AxisArrayKey,\n} from '../types/logic-types';\nimport {\n  areArraysEqual,\n  getRandomInt,\n} from '../utilities/random-utilities';\nimport { BattleshipBuilder } from '../logic/bs-ship-builder/bs-ship-builder';\nimport { BattleshipBoardController } from '../logic/bs-gameboard-controller/bs-gameboard-controller';\nimport { isShipType } from '../utilities/logic-utilities';\n\nexport function randomizeBSGameboard(\n  gameboardController: BattleshipBoardController, fleet: Fleet\n) {\n  if (!gameboardController)\n    throw new Error('Invalid Command: `gameboardController` is required to randomize the gameboard.');\n  if (!fleet)\n    throw new Error('Invalid Command: `fleet` is required to randomize the gameboard.');\n\n  const generateRandomCoordinates = (\n    shipLength: number,\n    boardSize: number\n  ): Coordinates => {\n    const max: number = boardSize - shipLength;\n    const xRandom: number = getRandomInt(0, max);\n    const yRandom: number = getRandomInt(0, max);\n\n    return [xRandom, yRandom];\n  };\n  const generateRandomOrientation = (): Orientation => {\n    return Math.random() < 0.5 ? 'horizontal' : 'vertical';\n  };\n  const areCoordinatesValid = (\n    coordinates: Coordinates,\n    ship: BattleshipBuilder,\n    orientation: Orientation\n  ): boolean => {\n    const validPositionsParams: IShipPlacementConfigurations = {\n      shipLength: ship.length,\n      orientation,\n    };\n\n    const validPositions =\n      gameboardController.getValidPositions(validPositionsParams);\n    const [bowX, bowY]: Coordinates = coordinates;\n    const isHorizontal: boolean = orientation === 'horizontal';\n    const axisIndex: number = isHorizontal ? bowY : bowX;\n\n    const axisArrayKey: AxisArrayKey = isHorizontal\n      ? `row-${axisIndex}`\n      : `column-${axisIndex}`;\n    const axisArray: PositionArray = validPositions[axisArrayKey];\n\n    return axisArray.some((position: IPosition) =>\n      areArraysEqual(position.bow, coordinates)\n    );\n  }; \n  const getValidCoordinatesRecursively = (\n    ship: BattleshipBuilder,\n    orientation: Orientation,\n    boardSize: number,\n    attempts: number = 0\n  ): Coordinates => {\n    if (attempts > 100)\n      throw new Error(`Max recursion depth exceeded when placing the ${ship.type}.`);\n\n    const coordinates: Coordinates = generateRandomCoordinates(\n      ship.length,\n      boardSize\n    );\n\n    return areCoordinatesValid(coordinates, ship, orientation)\n      ? coordinates\n      : getValidCoordinatesRecursively(\n          ship,\n          orientation,\n          boardSize,\n          attempts + 1\n        )\n  };\n\n  const boardSize: number = 10;\n\n  for (const shipType in fleet) {\n    if (!isShipType(shipType)) throw new Error(`Invalid Type: \"${shipType}\" doesn't conform to \"ShipType\".`);\n\n    const ship: BattleshipBuilder = fleet[shipType]!;\n    const randomOrientation: Orientation = generateRandomOrientation();\n\n    const coordinates: Coordinates = getValidCoordinatesRecursively(\n      ship,\n      randomOrientation,\n      boardSize\n    );\n\n    const placePieceParams: IPlacePieceWrapperParams = {\n      ship,\n      coordinates,\n      orientation: randomOrientation,\n    };\n    \n    gameboardController.placePiece(placePieceParams);\n  }\n}\n","import { PlayerState } from \"../types/state-types\";\nimport {\n  createBattleshipBoardBuilderSet,\n  createBattleshipBoardRepositorySet,\n  createBattleshipControllerSet,\n  createBattleshipFleetBuilderSet,\n} from \"../utilities/logic-utilities\";\n\nconst { playerOneBoardBuilder, playerTwoBoardBuilder } =\n  createBattleshipBoardBuilderSet();\n\nconst { playerOneBoardRepository, playerTwoBoardRepository } =\n  createBattleshipBoardRepositorySet();\n\nconst { playerOneFleetBuilder, playerTwoFleetBuilder } =\n    createBattleshipFleetBuilderSet();\n\nconst { playerOneBoardController, playerTwoBoardController } =\n  createBattleshipControllerSet(\n    { playerOneBoardBuilder, playerTwoBoardBuilder },\n    { playerOneBoardRepository, playerTwoBoardRepository }\n  );\n\nconst playerOne: PlayerState = {\n  gameboardBuilder: playerOneBoardBuilder,\n  gameboardController: playerOneBoardController,\n  gameboardRepository: playerOneBoardRepository,\n  fleetBuilder: playerOneFleetBuilder\n};\n\nconst playerTwo: PlayerState = {\n  gameboardBuilder: playerTwoBoardBuilder,\n  gameboardController: playerTwoBoardController,\n  gameboardRepository: playerTwoBoardRepository,\n  fleetBuilder: playerTwoFleetBuilder\n};\n\nexport const players = {\n  playerOne,\n  playerTwo\n};","// ðŸ’­ Pub-sub/Mediator Pattern\n\ntype Listener<T = any> = (data: T) => void;\n\nclass EventBus {\n  private events: Record<string, Array<Listener>> = {};\n\n  /**\n   * Register a listener for a specific event.\n   * @param eventName - The name of the event.\n   * @param fn - The callback function to register.\n   */\n  on<T>(eventName: string, fn: Listener<T>): void {\n    this.events[eventName] = this.events[eventName] || [];\n    this.events[eventName].push(fn);\n  }\n\n  /**\n   * Unregister a listener for a specific event.\n   * @param eventName - The name of the event.\n   * @param fn - The callback function to remove.\n   */\n  off<T>(eventName: string, fn: Listener<T>): void {\n    if (this.events[eventName]) {\n      this.events[eventName] = this.events[eventName].filter(\n        (listener) => listener !== fn\n      );\n    }\n  }\n\n  /**\n   * Emit an event, calling all listeners registered for it.\n   * @param eventName - The name of the event.\n   * @param data - The data to pass to the listeners (optional).\n   */\n  emit<T>(eventName: string, data?: T): void {\n    if (this.events[eventName]) {\n      this.events[eventName].forEach((fn) => fn(data));\n    }\n  }\n}\n\nconst GlobalEventBus = new EventBus();\n\nexport default GlobalEventBus;","import { BattleshipBuilder } from './typescript/logic/bs-ship-builder/bs-ship-builder';\nimport { BattleshipBoardController } from './typescript/logic/bs-gameboard-controller/bs-gameboard-controller';\nimport { randomizeBSGameboard } from './typescript/setup/randomize-bs-gameboard';\nimport { players } from './typescript/state/player-state';\nimport { GameboardComponent } from './typescript/components/gameboard-component/gameboard-component';\nimport './styles/sass/main.scss'\nimport { ShipShufflerButtonComponent } from './typescript/components/ship-shuffler-component';\n\nfunction init() {\n  const randomizeBSGameboards = () => {\n    randomizeBSGameboard(\n      players.playerOne.gameboardController,\n      players.playerOne.fleetBuilder.fleet\n    );\n    randomizeBSGameboard(\n      players.playerTwo.gameboardController,\n      players.playerTwo.fleetBuilder.fleet\n    );\n  };\n\n  // benchmark board set randomization\n  console.time('randomizeBSGameboards');\n  randomizeBSGameboards();\n  console.timeEnd('randomizeBSGameboards'); \n\n  // create and render gameboard component to '#content`\n  const gameboardComponent = new GameboardComponent('playerTwo', players.playerTwo);\n  gameboardComponent.render('#content');\n\n  const shipShuffler = new ShipShufflerButtonComponent(\n    players.playerTwo.gameboardController,\n    players.playerTwo.fleetBuilder.fleet,\n    '#content',\n    'player-one-randomizer-button',\n  );\n\n  shipShuffler.render('#content');\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ ----------------- TESTING GAMEBOARD METHODS ------------------\n\n  const computerBoardController: BattleshipBoardController = players.playerTwo.gameboardController;\n  const computerBoardRepository = players.playerTwo.gameboardRepository;\n  const computerCarrier: BattleshipBuilder = players.playerTwo.fleetBuilder.fleet.carrier!;\n\n  // // * Should log warning because ship is already placed\n  // // console.log('Intentional invalid ship placement:')\n  // // computerBoardController.placePiece({ ship: computerCarrier, coordinates: [0, 0], orientation: 'horizontal' });\n  \n  // console.log('Initial fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n\n  // // * initial board print\n  // console.log('Initial randomized board');\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship once\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship again\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship another time\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship penultimately\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship once more\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * move da ship\n  // console.log(`Move ${computerCarrier.type}:`);\n  // computerBoardController.movePiece(computerCarrier, [9, 0]);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship in new position\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship penultimately, again\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  // console.log('Fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n  \n  // // * rotate ship once more, again\n  // console.log(`Rotate ${computerCarrier.type}:`);\n  // computerBoardController.rotatePiece(computerCarrier);\n  // computerBoardController.prettyPrint();\n  \n  // // * check all coordinates the ship occupies\n  // console.log('Final fleet coordinates:');\n  // console.log(computerBoardRepository.fleetCoordinates);\n}\n\n// time all the above stuff\nconsole.time('init');\ninit();\nconsole.timeEnd('init');","import { BattleshipFleetBuilder } from '../../logic/bs-fleet-builder/bs-fleet-builder';\nimport {\n  Coordinates,\n  CoordinatesArray,\n  Fleet,\n  Gameboard,\n  Orientation,\n  ShipLength,\n  ShipSymbolValue,\n  ShipSymbolValueArray,\n  ShipType,\n} from '../../types/logic-types';\nimport {\n  areArraysEqual,\n  createElement,\n  createPlayerIdentifier,\n  getConvertedTypeFromAttr,\n} from '../../utilities/random-utilities';\nimport { GridPlacementValue } from '../../types/css-types';\nimport { PlayerState } from '../../types/state-types';\nimport GlobalEventBus from '../../utilities/event-bus';\nimport { isOrientation, isShipLength, isShipType } from '../../utilities/logic-utilities';\nimport { DragState } from '../component-types';\nimport { BattleshipBoardController } from '../../logic/bs-gameboard-controller/bs-gameboard-controller';\n\nexport class GameboardComponent {\n  private boardContainer: HTMLDivElement;\n  private fleetElements: Set<HTMLDivElement> = new Set();\n\n  constructor(\n    private readonly id: string,\n    public readonly playerState: PlayerState\n  ) {\n    this.boardContainer = this.generateBoardContainer(\n      this.playerState.gameboardBuilder.boardSize\n    );\n\n    GlobalEventBus.on('updateGameboard', () => {\n      this.updateGameboard();\n    });\n  }\n\n  public render(targetSelector: string): void {\n    const target: HTMLElement | null = document.querySelector(targetSelector);\n\n    if (!target) {\n      throw new Error(\n        `Target element not found with ID - ${this.id} and selector - \"${targetSelector}\".`\n      );\n    }\n\n    const gameboard: DocumentFragment = this.generateBoardFragment(\n      this.playerState.gameboardBuilder.boardSize\n    );\n\n    this.boardContainer.appendChild(gameboard);\n\n    this.handleFleetPlacement(\n      this.playerState.fleetBuilder,\n      this.fleetElements\n    );\n\n    target.appendChild(this.boardContainer);\n  }\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ Helpers\n\n  private appendFleetClonesToGameboard(fleetElements: Set<HTMLDivElement>) {\n    const gameboard: HTMLDivElement | null =\n      this.boardContainer.querySelector('.gameboard');\n\n    if (!gameboard) throw new Error('Gameboard not found');\n\n    fleetElements.forEach((shipElement) => {\n      const shipCloneElement: HTMLDivElement = createElement(\n        'div',\n        ['ship-container-clone'],\n        {\n          id: `${shipElement.getAttribute('id')}-clone`,\n        }\n      );\n\n      gameboard.appendChild(shipCloneElement);\n    });\n  }\n\n  private clearBoardContainer(boardContainer: HTMLDivElement): void {\n    while (boardContainer.firstChild) {\n      boardContainer.removeChild(boardContainer.firstChild);\n    }\n  }\n\n  private createBackgroundCellsFragment(\n    gameboard: Gameboard\n  ): DocumentFragment {\n    const cellFragment: DocumentFragment = new DocumentFragment();\n\n    gameboard.forEach((row: ShipSymbolValueArray, rowIndex) => {\n      row.forEach((symbol: ShipSymbolValue, colIndex) => {\n        const symbolDescription: string = symbol.description!.toLowerCase();\n\n        const gridCell: HTMLDivElement = createElement(\n          'div',\n          [\n            `${createPlayerIdentifier(this.id, symbolDescription)}-cell`,\n            'grid-cell',\n          ],\n          {\n            'data-x': colIndex.toString(),\n            'data-y': rowIndex.toString(),\n            'aria-label': `Row ${rowIndex + 1}, Column ${colIndex + 1}`,\n            role: 'gridCell',\n          }\n        );\n\n        const gridCellContainer: HTMLDivElement = createElement('div', [\n          createPlayerIdentifier(\n            this.id,\n            `${symbolDescription}-cell-container`\n          ),\n          'grid-cell-container',\n        ]);\n\n        gridCellContainer.appendChild(gridCell);\n        cellFragment.appendChild(gridCellContainer);\n      });\n    });\n\n    return cellFragment;\n  }\n\n  private createShipElement(\n    shipType: ShipType,\n    shipLength: ShipLength,\n    gridPlacementValue: string,\n    gridCrossAxis: number,\n    orientation: Orientation\n  ): HTMLDivElement {\n    const shipUnitFragment: DocumentFragment = this.generateShipUnitFragment(\n      shipLength,\n      shipType,\n      this.id\n    );\n\n    const shipContainerElement: HTMLDivElement = createElement(\n      'div',\n      ['ship-container'],\n      {\n        id: createPlayerIdentifier(this.id, `${shipType}-container`),\n        'data-shipType': shipType,\n        'data-length': shipLength.toString(),\n        'data-orientation': orientation,\n        draggable: 'true',\n      }\n    );\n    shipContainerElement.style.display = 'grid';\n    shipContainerElement.appendChild(shipUnitFragment);\n\n    const isHorizontal: boolean = orientation === 'horizontal';\n    if (isHorizontal) {\n      shipContainerElement.style.gridColumn = gridPlacementValue;\n      shipContainerElement.style.gridRow = gridCrossAxis.toString();\n      shipContainerElement.style.gridTemplateColumns = `repeat(${shipLength}, 1fr)`;\n    } else {\n      shipContainerElement.style.gridRow = gridPlacementValue;\n      shipContainerElement.style.gridColumn = gridCrossAxis.toString();\n      shipContainerElement.style.gridTemplateRows = `repeat(${shipLength}, 1fr)`;\n    }\n\n    return shipContainerElement;\n  }\n\n  private generateBoardContainer(boardSize: number): HTMLDivElement {\n    const gameboardContainer: HTMLDivElement = createElement(\n      'div',\n      ['gameboard-container'],\n      {\n        id: createPlayerIdentifier(this.id, 'gameboard-container'),\n      }\n    );\n\n    gameboardContainer.style.setProperty('--grid-size', boardSize.toString());\n\n    this.handleDragListeners(gameboardContainer);\n\n    return gameboardContainer;\n  }\n\n  private generateBoardFragment(boardSize: number): DocumentFragment {\n    const gameboardBackground: HTMLDivElement = createElement(\n      'div',\n      ['gameboard-background'],\n      {\n        id: createPlayerIdentifier(this.id, 'gameboard-background'),\n      }\n    );\n    gameboardBackground.appendChild(\n      this.createBackgroundCellsFragment(\n        this.playerState.gameboardBuilder.board\n      )\n    );\n\n    const gameboard = createElement('div', ['gameboard'], {\n      id: createPlayerIdentifier(this.id, 'gameboard'),\n    });\n    gameboard.style.setProperty('--grid-size', boardSize.toString());\n\n    const boardFragment: DocumentFragment = new DocumentFragment();\n    boardFragment.append(gameboardBackground, gameboard);\n\n    return boardFragment;\n  }\n\n  private generateShipUnitFragment(\n    shipLength: ShipLength,\n    shipType: ShipType,\n    id: string\n  ): DocumentFragment {\n    const shipUnitFragment: DocumentFragment = new DocumentFragment();\n\n    for (let i = 0; i < shipLength; i++) {\n      const isBow: boolean = i === 0;\n      const shipUnit: HTMLDivElement = createElement('div', [\n        'ship-unit',\n        createPlayerIdentifier(id, shipType),\n      ]);\n\n      if (isBow) {\n        shipUnit.classList.add('ship-bow');\n        shipUnit.setAttribute(\n          'id',\n          createPlayerIdentifier(id, `${shipType}-bow`)\n        );\n      }\n\n      shipUnitFragment.appendChild(shipUnit);\n    }\n\n    return shipUnitFragment;\n  }\n\n  private getGridPlacementValue(\n    coordinates: Coordinates,\n    orientation: Orientation,\n    shipLength: ShipLength\n  ): [GridPlacementValue, number] {\n    const isHorizontal = orientation === 'horizontal';\n\n    const [x, y] = coordinates;\n    const gridStartMain = isHorizontal ? x + 1 : y + 1;\n    const gridCrossAxis = isHorizontal ? y + 1 : x + 1;\n\n    return [`${gridStartMain} / span ${shipLength}`, gridCrossAxis];\n  }\n\n  private handleFleetPlacement(\n    fleetBuilder: BattleshipFleetBuilder,\n    fleetElements: Set<HTMLDivElement>\n  ) {\n    this.updateFleetElements(fleetBuilder);\n    this.placeFleetOnGameboard(fleetElements);\n    this.appendFleetClonesToGameboard(fleetElements);\n  }\n\n  private placeFleetOnGameboard(fleetElements: Set<HTMLDivElement>): void {\n    const gameboard =\n      this.boardContainer.querySelector<HTMLDivElement>('.gameboard');\n\n    if (!gameboard) {\n      throw new Error('Gameboard container not found.');\n    }\n\n    fleetElements.forEach((shipElement) => gameboard.appendChild(shipElement));\n  }\n\n  private updateFleetElements = (fleetBuilder: BattleshipFleetBuilder) => {\n    if (this.fleetElements.size) this.fleetElements.clear();\n\n    for (const ship of Object.values(fleetBuilder.fleet)) {\n      const shipType: ShipType = ship.type;\n      const shipLength: ShipLength = ship.length;\n\n      const orientation: Orientation | null =\n        ship.currentplacementConfigurations.orientation;\n\n      if (!orientation) throw new Error('Orientation not set.');\n\n      const coordinatesArray: CoordinatesArray | null =\n        ship.currentplacementConfigurations.coordinatesArray;\n\n      if (!coordinatesArray || coordinatesArray.length === 0) {\n        console.log(`The ${shipType} has not been placed. Continuing...`);\n        continue;\n      }\n\n      const [x, y]: Coordinates = coordinatesArray[0];\n      const [gridPlacementValue, gridCrossAxis]: [GridPlacementValue, number] =\n        this.getGridPlacementValue([x, y], orientation, shipLength);\n\n      const shipElement: HTMLDivElement = this.createShipElement(\n        shipType,\n        shipLength,\n        gridPlacementValue,\n        gridCrossAxis,\n        orientation\n      );\n\n      this.fleetElements.add(shipElement);\n    }\n  };\n\n  private updateGameboard() {\n    this.clearBoardContainer(this.boardContainer);\n\n    const gameboard: DocumentFragment = this.generateBoardFragment(\n      this.playerState.gameboardBuilder.boardSize\n    );\n\n    this.boardContainer.appendChild(gameboard);\n\n    this.handleFleetPlacement(\n      this.playerState.fleetBuilder,\n      this.fleetElements\n    );\n  }\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ HTML Drag and Drop API\n\n  private handleDragListeners(gameboardContainer: HTMLDivElement) {\n    const dragState: DragState = {\n      currentShipInstance: null,\n      initialPlacementConfigurations: null,\n      isValidDropTarget: false,\n      currentDragOverCell: null,\n    };\n\n    gameboardContainer.addEventListener('dragstart', (e: DragEvent) =>\n      this.handleShipDragStart(e, dragState)\n    );\n    gameboardContainer.addEventListener('dragenter', (e: DragEvent) =>\n      this.handleShipDragEnter(e)\n    );\n    gameboardContainer.addEventListener('dragleave', (e: DragEvent) =>\n      this.handleShipDragLeave(e)\n    );\n    gameboardContainer.addEventListener('dragleave', (e: DragEvent) =>\n      this.handleShipDragLeave(e)\n    );\n    gameboardContainer.addEventListener('dragover', (e: DragEvent) =>\n      this.handleShipDragOver(e, dragState)\n    );\n    gameboardContainer.addEventListener('drop', (e: DragEvent) =>\n      this.handleShipDrop(e, dragState)\n    );\n    gameboardContainer.addEventListener('dragend', (e: DragEvent) =>\n      this.handleShipDragEnd(e, dragState)\n    );\n  }\n\n  private handleShipDragStart(e: DragEvent, dragState: DragState) {\n    if (!(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n\n    // Ensure it's a valid ship container\n    if (!e.target.classList.contains('ship-container')) return;\n\n    const snapToClone = (\n      e: DragEvent,\n      boardContainer: HTMLDivElement\n    ): void => {\n      if (!e.target || !(e.target instanceof HTMLDivElement))\n        throw new Error('Target element not found or is not an HTMLElement.');\n\n      const shipContainerElement: HTMLDivElement = e.target;\n      const shipContainerId: string | null =\n        shipContainerElement.getAttribute('id');\n\n      const shipContainerClone: HTMLDivElement | null =\n        boardContainer.querySelector(`#${shipContainerId}-clone`);\n\n      if (!shipContainerClone) throw new Error('Ship clone not found.');\n      if (!shipContainerId)\n        throw new Error(\"Ship container doesn't have an ID.\");\n\n      const shipBoundingRect = shipContainerElement.getBoundingClientRect();\n\n      shipContainerClone.style.height = `${shipBoundingRect.height}px`;\n      shipContainerClone.style.width = `${shipBoundingRect.width}px`;\n\n      const shipBow = shipContainerElement.querySelector(`.ship-bow`);\n      if (!shipBow) throw new Error('Ship bow not found.');\n\n      const shipBowBoundingRect = shipBow?.getBoundingClientRect();\n\n      e.dataTransfer?.setDragImage(\n        shipContainerClone,\n        shipBowBoundingRect.width / 2,\n        shipBowBoundingRect.height / 2\n      );\n\n      // reveal ship container clone\n      shipContainerClone.style.visibility = 'visible'; // Ensure the clone is visible\n      shipContainerClone.style.pointerEvents = 'auto'; // Ensure pointer events work on the clone\n\n      // TODO: Make this less hacky ðŸ« \n      // enable drag events for grid cells under ships\n      setTimeout(() => {\n        shipContainerElement.style.pointerEvents = 'none';\n      }, 0);\n    };\n\n    const classifyValidCellCoordinates = (\n      boardContainer: HTMLDivElement,\n      shipContainerElement: HTMLDivElement,\n      orientation: Orientation,\n      gameboardController: BattleshipBoardController\n    ): void => {\n      const shipLengthAttr: number | null = Number(\n        shipContainerElement.getAttribute('data-length')\n      );\n      if (!shipLengthAttr || !isShipLength(shipLengthAttr)) {\n        throw new Error('Invalid or missing ship type attribute.');\n      }\n\n      const classifyValidBowCells = (\n        gridCells: NodeListOf<HTMLDivElement>,\n        shipLength: ShipLength,\n        orientation: Orientation\n      ) => {\n        const allValidBowCoordinates: Set<Coordinates> =\n          gameboardController.getAllValidBowCoordinates(\n            orientation,\n            shipLength\n          );\n\n        gridCells.forEach((gridCell: HTMLDivElement) => {\n          const gridCellCoordinates: Coordinates = [\n            Number(gridCell.getAttribute('data-x')),\n            Number(gridCell.getAttribute('data-y')),\n          ];\n\n          for (const validBowCoordinates of allValidBowCoordinates) {\n            if (!areArraysEqual(validBowCoordinates, gridCellCoordinates))\n              continue;\n            gridCell.classList.add('valid-bow-coordinates');\n          }\n        });\n      };\n\n      const shipLength: ShipLength = shipLengthAttr;\n\n      const gridCells: NodeListOf<HTMLDivElement> =\n        boardContainer.querySelectorAll('.grid-cell');\n\n      classifyValidBowCells(gridCells, shipLength, orientation);\n    };\n\n    // Update drag state\n    const setUpShipForDrag = (\n      dragState: DragState,\n      fleet: Fleet,\n      shipType: ShipType\n    ) => {\n      // Ensure the ship type exists in the fleet\n\n      if (!fleet[shipType])\n        throw new Error(`The ${shipType} is not present in the fleet.`);\n\n      // Set the current ship instance and its initial configurations\n      dragState.currentShipInstance = fleet[shipType];\n      dragState.initialPlacementConfigurations =\n        dragState.currentShipInstance.currentplacementConfigurations;\n    };\n\n    const shipContainer: HTMLDivElement = e.target;\n\n    // Get ship type and orientation, ensuring valid attributes and types\n    const shipType: ShipType = getConvertedTypeFromAttr(\n      e.target,\n      'data-shiptype',\n      isShipType\n    );\n\n    const orientation: Orientation = getConvertedTypeFromAttr(\n      e.target,\n      'data-orientation',\n      isOrientation\n    );\n\n    const fleet: Fleet = this.playerState.fleetBuilder.fleet;\n\n    setUpShipForDrag(dragState, fleet, shipType);\n\n    if (!dragState.currentShipInstance)\n      throw new Error(\n        `Drag state hasn't been updated with the current ship instance on drag start. Drag State: ${JSON.stringify(\n          dragState\n        )}`\n      );\n\n    // Remove the piece from the gameboard (non-null ensured by `setUpShipForDrag`)\n    this.playerState.gameboardController.removePiece(\n      dragState.currentShipInstance\n    );\n\n    // Handle snapping and classifying valid cells\n    snapToClone(e, this.boardContainer);\n    classifyValidCellCoordinates(\n      this.boardContainer,\n      shipContainer,\n      orientation,\n      this.playerState.gameboardController\n    );\n  }\n\n  private handleShipDragEnter(e: DragEvent) {\n    if (!(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n\n    // Ensure it's a grid cell\n    if (!e.target.classList.contains('grid-cell')) return;\n\n    const gridCell: HTMLDivElement = e.target;\n\n    // Check if current grid cell is valid for placement\n    const areValidBowCoordinates = gridCell.classList.contains(\n      'valid-bow-coordinates'\n    );\n\n    // Add appropriate visual feedback class to grid cell\n    areValidBowCoordinates\n      ? gridCell.classList.add('placement-is-valid')\n      : gridCell.classList.add('placement-is-invalid');\n  }\n\n  private handleShipDragLeave(e: DragEvent) {\n    if (!(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n\n    if (!e.target.classList.contains('grid-cell')) return;\n\n    const gridCell: HTMLDivElement = e.target;\n\n    // Remove assigned visual feedback class from grid cell\n    if (gridCell.classList.contains('placement-is-valid')) {\n      gridCell.classList.remove('placement-is-valid');\n    } else if (gridCell.classList.contains('placement-is-invalid')) {\n      gridCell.classList.remove('placement-is-invalid');\n    }\n  }\n\n  private handleShipDragOver(e: DragEvent, dragState: DragState) {\n    // Enables the drop event to fire\n    e.preventDefault();\n\n    if (!(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n    if (!e.target.classList.contains('grid-cell')) return;\n\n    const gridCell: HTMLDivElement = e.target;\n\n    // Update drag state for cleanup\n    dragState.currentDragOverCell = gridCell;\n\n    // Prevent further operations for invalid cells\n    if (!gridCell.classList.contains('valid-bow-coordinates')) return;\n  }\n\n  private handleShipDrop(e: DragEvent, dragState: DragState) {\n    e.preventDefault();\n\n    if (!e.target || !(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n\n    if (!e.target.classList.contains('valid-bow-coordinates')) return;\n\n    // Validate and modify state\n    const { coordinatesArray, orientation: initialOrientation } =\n      dragState.initialPlacementConfigurations || {};\n    if (!coordinatesArray || !initialOrientation) {\n      throw new Error('Initial placement configurations are incomplete.');\n    }\n\n    dragState.isValidDropTarget = true;\n\n    const validGridCell: HTMLDivElement = e.target;\n\n    // Retrieve new coordinates from the valid grid cell\n    const xAttr = validGridCell.getAttribute('data-x');\n    const yAttr = validGridCell.getAttribute('data-y');\n    if (!xAttr || !yAttr) {\n      throw new Error('Missing or invalid grid cell coordinates.');\n    }\n    const newCoordinates: Coordinates = [Number(xAttr), Number(yAttr)];\n\n    this.playerState.gameboardController.placePiece({\n      ship: dragState.currentShipInstance!,\n      coordinates: newCoordinates,\n      orientation: initialOrientation,\n    });\n\n    // Re-renders board with new ship placement\n    this.updateGameboard();\n\n    // Reset valid drop target state\n    dragState.isValidDropTarget = false;\n  }\n\n  private handleShipDragEnd(e: DragEvent, dragState: DragState) {\n    if (!(e.target instanceof HTMLDivElement))\n      throw new Error('Target element not found or is not an HTMLElement.');\n\n    if (!e.target.classList.contains('ship-container')) return;\n    const resetDragStyles = (shipContainerElement: HTMLDivElement): void => {\n      // Extract and validate ship container ID\n      const shipContainerId: string | null =\n        shipContainerElement.getAttribute('id');\n\n      // Retrieve and validate ship clone element\n      const shipContainerClone: HTMLDivElement | null =\n        this.boardContainer.querySelector(`#${shipContainerId}-clone`);\n\n      if (!shipContainerId || !shipContainerClone) {\n        throw new Error(\n          `Invalid ship container state. ID: ${shipContainerId}, Clone: ${shipContainerClone}`\n        );\n      }\n\n      // Re-hide drag clone\n      shipContainerClone.style.visibility = 'hidden'; // Ensure the clone is visible\n      shipContainerClone.style.pointerEvents = 'none'; // Ensure pointer events are revoked from clone\n\n      // Remove drag events for grid cells under ships\n      shipContainerElement.style.pointerEvents = 'auto';\n    };\n    const resetShipPosition = (): void => {\n      const { coordinatesArray, orientation: initialOrientation } =\n        dragState.initialPlacementConfigurations || {};\n      if (!coordinatesArray || !initialOrientation) {\n        throw new Error('Initial placement configurations are incomplete.');\n      }\n\n      // Get bow coordinates\n      const initialBowCoordinates: Coordinates = coordinatesArray[0];\n\n      // Re-place ship on logic gameboard\n      this.playerState.gameboardController.placePiece({\n        ship: dragState.currentShipInstance!,\n        coordinates: initialBowCoordinates,\n        orientation: initialOrientation,\n      });\n    };\n    const removeVisualFeedback = (\n      currentDragOverCell: HTMLDivElement,\n      isValidDropTarget: boolean\n    ): void => {\n      const feedbackClass: string = isValidDropTarget\n        ? 'placement-is-valid'\n        : 'placement-is-invalid';\n      currentDragOverCell.classList.remove(feedbackClass);\n    };\n\n    const shipContainerElement: HTMLDivElement = e.target;\n\n    try {\n      resetDragStyles(shipContainerElement);\n\n      const { currentDragOverCell, isValidDropTarget } = dragState;\n      if (!currentDragOverCell)\n        throw new Error(\n          `Current drag over cell is missing. Drag state: ${JSON.stringify(\n            dragState\n          )}`\n        );\n      removeVisualFeedback(currentDragOverCell, isValidDropTarget);\n\n      if (!isValidDropTarget) {\n        resetShipPosition();\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  }\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ Utilities\n\n  // TODO: Do I need this\n  public getId(): string {\n    return this.id;\n  }\n}\n","import { BattleshipBoardController } from \"../logic/bs-gameboard-controller/bs-gameboard-controller\";\nimport { createElement } from \"../utilities/random-utilities\";\nimport { Fleet } from \"../types/logic-types\";\nimport { randomizeBSGameboard } from \"../setup/randomize-bs-gameboard\";\nimport GlobalEventBus from \"../utilities/event-bus\";\n\nexport class ShipShufflerButtonComponent {\n  private readonly ShipShufflerButton: HTMLButtonElement;\n  private readonly ShipShufflerButtonContainer: HTMLDivElement;\n  private readonly ShipShufflerButtonTextContent: string = 'Shuffle Ships';\n\n  constructor(\n    private gameboardController: BattleshipBoardController,\n    private fleet: Fleet,\n    private gameboardTargetSelector: string,\n    private id: string = 'randomizer-button',\n    private classes: string[] = ['randomizer-button']\n  ) {\n    this.validateGameboardTarget(this.gameboardTargetSelector);\n\n    this.ShipShufflerButton = this.createShipShufflerButton(\n      this.id,\n      this.classes\n    );\n    this.ShipShufflerButton.classList.add(...this.classes);\n    this.ShipShufflerButton.textContent = this.ShipShufflerButtonTextContent;\n    this.addEventListener(this.ShipShufflerButton);\n\n    this.ShipShufflerButtonContainer = this.createShipShufflerButtonContainer();\n    this.ShipShufflerButtonContainer.appendChild(this.ShipShufflerButton);\n  }\n\n  public render(targetSelector: string) {\n    const target: HTMLElement | null = document.querySelector(targetSelector);\n\n    if (!target) {\n      throw new Error(`Target element not found: \"${targetSelector}.\"`);\n    }\n\n    target.appendChild(this.ShipShufflerButtonContainer);\n  }\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ Helpers\n\n  private addEventListener(ShipShufflerButton: HTMLButtonElement) {\n    ShipShufflerButton.addEventListener('click', () => {\n      this.randomizeGameboard();\n      this.updateGameboard(this.gameboardTargetSelector);\n    });\n  }\n\n  private createShipShufflerButton(\n    id: string,\n    classes: string[]\n  ): HTMLButtonElement {\n    const button: HTMLButtonElement = createElement('button', [...classes], {\n      id,\n    });\n    return button;\n  }\n\n  private createShipShufflerButtonContainer(): HTMLDivElement {\n    const container: HTMLDivElement = createElement('div', [\n      'randomizer-button-container',\n    ]);\n    return container;\n  }\n\n  private randomizeGameboard() {\n    this.gameboardController.removeAllPieces(this.fleet);\n    randomizeBSGameboard(this.gameboardController, this.fleet);\n  }\n\n  private updateGameboard(targetSelector: string) {\n    GlobalEventBus.emit('updateGameboard', targetSelector);\n  }\n\n  private validateGameboardTarget(gameboardTargetSelector: string) {\n    if (!document.querySelector(gameboardTargetSelector)) {\n      throw new Error(\n        `Invalid gameboard target selector: \"${gameboardTargetSelector}\"`\n      );\n    }\n  }\n\n  // ðŸ’­ --------------------------------------------------------------\n  // ðŸ’­ Utilities\n\n  public getId() {\n    return this.id;\n  }\n}"],"names":["areArraysEqual","arrayOne","arrayTwo","length","every","value","index","getConvertedTypeFromAttr","element","attribute","typeGuard","attrValue","getAttribute","Error","getRandomInt","min","max","Math","floor","random","createElement","tag","classes","attributes","document","forEach","cls","classList","add","Object","entries","key","setAttribute","createPlayerIdentifier","playerId","identifier","split","toLowerCase","AnglesOfRotation","ShipType","BattleshipBoardBuilder","static","Symbol","_boardSize","_fillValue","vacant","constructor","this","_board","Array","from","fill","board","boardSize","fillValue","BattleshipBoardController","playerState","getValidPositions","orientation","shipLength","battleshipBoardBuilder","battleshipBoardController","extractAxisArray","axisIndex","gameboard","map","row","findValidPositionsInAxis","axisArray","isHorizontal","streak","validAxisPositions","i","bowPosition","sternPosition","push","bow","stern","validPositionsPerAxis","validPositions","getValidShipPositions","gameboardBuilder","getAllValidBowCoordinates","allValidBowCoordinates","Set","positionsInAxis","values","isPositionsArray","position","movePiece","ship","newBowCoordinates","isPlaced","console","warn","type","currentOrientation","currentplacementConfigurations","newPosition","createPositionObject","isPositionInBounds","x","y","axisArrayKey","createAxisArrayKey","some","arePositionsEqual","placementParameters","coordinates","shouldResetShipRotationalData","relocateShip","placePiece","battleshipBoardRepository","bowX","bowY","isCoordinateInBounds","errorMessage","isPositionValid","shipConfigurations","validPosition","JSON","stringify","getPlacementCoordinates","placementCoordinates","sternX","sternY","primary","axisEnd","placeOnBoard","shipPlacementCoordinates","shipSymbol","symbol","setShipConfigurations","coordinatesArray","placementConfigurations","rotationalPivotConfigurations","currentAngleOfRotation","Degrees0","updateOccupiedCoordinatesSet","shipType","addShipToFleetCoordinates","placeShip","gameboardRepository","prettyPrint","table","description","removePiece","isShipValidForRemoval","shipCoordinates","removeShipFromBoard","nullifyShipCoordinatesValue","nullifyShipCoordinateSetValue","resetShipConfigurations","nullifyShipValidRotationalParams","resetConfigurations","removeAllPieces","fleet","keys","error","rotatePiece","validRotatedPlacePieceParams","getValidRotatedPlacePieceParams","setShipValidRotationalParams","setValidRotatedPlacePieceParams","validRotationalPositionMap","fleetValidRotationalParams","size","canShipBeRotated","getNextGreatestAngleOfRotation","filter","angleOfRotation","shipCurrentAngleOfRotation","nextValidPiecePlacementParams","greatestValidAngleOfRotation","_","getGreatestValidAngleOfRotation","originalBowCoordinates","originalOrientation","nextValidAngleOfRotation","nextValidRotatedPlacePieceParams","get","getNextValidPiecePlacementParams","areCoordinatesVacant","getShipAt","getShipDataAt","applyOffsetToCoordinate","coordinate","determineRotatedOrientation","Degrees180","getRotatedBowCoordinates","Degrees90","Degrees270","rotationalPivotBowCoordinates","rotatedBowCoordinates","areCoordinatesInBounds","validatePosition","axisIndexEnd","rotationalPivotOrientation","rotatedPiecePlacementParams","createRotatedPiecePlacementParams","Map","angleOfRotationString","angleOfRotationToNum","includes","rotatedPlacePieceParamsValue","isPlacePieceParams","isOutOfBounds","bowCoordinates","placePieceParams","set","generateValidRotatedPlacePieceParams","isShipPlaced","BattleshipBoardRepository","_fleetCoordinates","_fleetValidRotationalParams","fleetCoordinates","setMemberTemplate","isFleetCoordinates","validateTypes","OccupiedCoordinatesSet","isShipType","isOccupiedCoordinatesSet","coordinateSetMemberKey","occupiedCoordinatesSet","has","SHIP_SYMBOLS","Carrier","Battleship","Cruiser","Submarine","Destroyer","PatrolBoat","sizeLookup","undefined","BattleshipBuilder","seaworthy","_hitCounter","version","hit","isSeaworthy","hitCounter","BattleshipFleetBuilder","createFleet","fleetConfigs","config","createHasbroFleet","carrier","battleship","destroyer","submarine","patrolBoat","createMBFleet","cruiser","getShip","createBattleshipBoardController","positionOne","positionTwo","isCoordinates","isArray","member","isOccupiedCoordinatesSetMemberKey","OccupiedCoordinatesSetOrNull","isOrientation","proto","getPrototypeOf","prototype","isPlainObject","isPosition","match","randomizeBSGameboard","gameboardController","getValidCoordinatesRecursively","attempts","generateRandomCoordinates","areCoordinatesValid","validPositionsParams","randomOrientation","playerOneBoardBuilder","playerTwoBoardBuilder","playerOneBoardRepository","playerTwoBoardRepository","playerOneFleetBuilder","playerTwoFleetBuilder","createBattleshipFleetBuilder","createBattleshipFleetBuilderSet","playerOneBoardController","playerTwoBoardController","createBattleshipControllerSet","players","playerOne","fleetBuilder","playerTwo","events","on","eventName","fn","off","listener","emit","data","time","timeEnd","fleetElements","id","boardContainer","generateBoardContainer","GlobalEventBus","updateGameboard","render","targetSelector","target","querySelector","generateBoardFragment","appendChild","handleFleetPlacement","appendFleetClonesToGameboard","shipElement","shipCloneElement","clearBoardContainer","firstChild","removeChild","createBackgroundCellsFragment","cellFragment","DocumentFragment","rowIndex","colIndex","symbolDescription","gridCell","toString","role","gridCellContainer","createShipElement","gridPlacementValue","gridCrossAxis","shipUnitFragment","generateShipUnitFragment","shipContainerElement","draggable","style","display","gridColumn","gridRow","gridTemplateColumns","gridTemplateRows","gameboardContainer","setProperty","handleDragListeners","gameboardBackground","boardFragment","append","isBow","shipUnit","getGridPlacementValue","updateFleetElements","placeFleetOnGameboard","clear","log","dragState","currentShipInstance","initialPlacementConfigurations","isValidDropTarget","currentDragOverCell","addEventListener","e","handleShipDragStart","handleShipDragEnter","handleShipDragLeave","handleShipDragOver","handleShipDrop","handleShipDragEnd","HTMLDivElement","contains","shipContainer","setUpShipForDrag","snapToClone","shipContainerId","shipContainerClone","shipBoundingRect","getBoundingClientRect","height","width","shipBow","shipBowBoundingRect","dataTransfer","setDragImage","visibility","pointerEvents","setTimeout","classifyValidCellCoordinates","shipLengthAttr","Number","classifyValidBowCells","gridCells","gridCellCoordinates","validBowCoordinates","querySelectorAll","remove","preventDefault","initialOrientation","validGridCell","xAttr","yAttr","newCoordinates","resetDragStyles","resetShipPosition","initialBowCoordinates","removeVisualFeedback","feedbackClass","getId","ShipShufflerButtonTextContent","gameboardTargetSelector","validateGameboardTarget","ShipShufflerButton","createShipShufflerButton","textContent","ShipShufflerButtonContainer","createShipShufflerButtonContainer","randomizeGameboard"],"sourceRoot":""}